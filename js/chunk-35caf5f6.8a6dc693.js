(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35caf5f6"],{"07d6":function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},"083a":function(e,t,s){"use strict";var o=s("0d51"),a=TypeError;e.exports=function(e,t){if(!delete e[t])throw a("Cannot delete property "+o(t)+" of "+o(e))}},1212:function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this,s=c();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=s(" "),t.s1=s(" "),t.s2=s(" "),t.s0-=s(e),t.s0<0&&(t.s0+=1),t.s1-=s(e),t.s1<0&&(t.s1+=1),t.s2-=s(e),t.s2<0&&(t.s2+=1),s=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var s=new r(e),o=t&&t.state,a=s.next;return a.int32=function(){return 4294967296*s.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,s),a.state=function(){return i(s,{})}),a}function c(){var e=4022871197,t=function(t){t=String(t);for(var s=0;s<t.length;s++){e+=t.charCodeAt(s);var o=.02519603282416938*e;e=o>>>0,o-=e,o*=e,e=o>>>0,o-=e,e+=4294967296*o}return 2.3283064365386963e-10*(e>>>0)};return t}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.alea=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},"19aa":function(e,t,s){var o=s("3a9b"),a=TypeError;e.exports=function(e,t){if(o(t,e))return e;throw a("Incorrect invocation")}},"1b1b":function(e,t,s){"use strict";s("cca9")},"1f64":function(e,t,s){"use strict";(function(e){function o(e,t){const s=Object.create(null),o=e.split(",");for(let a=0;a<o.length;a++)s[o[a]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}s.d(t,"a",(function(){return tx}));const a=()=>{},n=Object.assign,r=Object.prototype.hasOwnProperty,i=(e,t)=>r.call(e,t),l=Array.isArray,c=e=>"[object Map]"===f(e),d=e=>"function"===typeof e,u=e=>"string"===typeof e,m=e=>"symbol"===typeof e,h=e=>null!==e&&"object"===typeof e,p=Object.prototype.toString,f=e=>p.call(e),g=e=>f(e).slice(8,-1),v=e=>u(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,_=(e,t)=>!Object.is(e,t),b=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})};let y;class x{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&y&&(this.parent=y,this.index=(y.scopes||(y.scopes=[])).push(this)-1)}run(e){if(this.active){const t=y;try{return y=this,e()}finally{y=t}}}on(){y=this}off(){y=this.parent}stop(e){if(this.active){let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function w(e,t=y){t&&t.active&&t.effects.push(e)}const k=e=>{const t=new Set(e);return t.w=0,t.n=0,t},M=e=>(e.w&I)>0,S=e=>(e.n&I)>0,R=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=I},A=e=>{const{deps:t}=e;if(t.length){let s=0;for(let o=0;o<t.length;o++){const a=t[o];M(a)&&!S(a)?a.delete(e):t[s++]=a,a.w&=~I,a.n&=~I}t.length=s}},E=new WeakMap;let T=0,I=1;const O=30;let B;const C=Symbol(""),j=Symbol("");class L{constructor(e,t=null,s){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,w(this,s)}run(){if(!this.active)return this.fn();let e=B,t=N;while(e){if(e===this)return;e=e.parent}try{return this.parent=B,B=this,N=!0,I=1<<++T,T<=O?R(this):P(this),this.fn()}finally{T<=O&&A(this),I=1<<--T,B=this.parent,N=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){B===this?this.deferStop=!0:this.active&&(P(this),this.onStop&&this.onStop(),this.active=!1)}}function P(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let N=!0;const H=[];function D(){H.push(N),N=!1}function U(){const e=H.pop();N=void 0===e||e}function F(e,t,s){if(N&&B){let t=E.get(e);t||E.set(e,t=new Map);let o=t.get(s);o||t.set(s,o=k()),$(o)}}function $(e,t){let s=!1;T<=O?S(e)||(e.n|=I,s=!M(e)):s=!e.has(B),s&&(e.add(B),B.deps.push(e))}function q(e,t,s,o,a,n){const r=E.get(e);if(!r)return;let i=[];if("clear"===t)i=[...r.values()];else if("length"===s&&l(e))r.forEach((e,t)=>{("length"===t||t>=o)&&i.push(e)});else switch(void 0!==s&&i.push(r.get(s)),t){case"add":l(e)?v(s)&&i.push(r.get("length")):(i.push(r.get(C)),c(e)&&i.push(r.get(j)));break;case"delete":l(e)||(i.push(r.get(C)),c(e)&&i.push(r.get(j)));break;case"set":c(e)&&i.push(r.get(C));break}if(1===i.length)i[0]&&V(i[0]);else{const e=[];for(const t of i)t&&e.push(...t);V(k(e))}}function V(e,t){const s=l(e)?e:[...e];for(const o of s)o.computed&&z(o);for(const o of s)o.computed||z(o)}function z(e,t){(e!==B||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Y=o("__proto__,__v_isRef,__isVue"),X=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>"arguments"!==e&&"caller"!==e).map(e=>Symbol[e]).filter(m)),K=J(),G=J(!1,!0),Z=J(!0),W=Q();function Q(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...e){const s=Ve(this);for(let t=0,a=this.length;t<a;t++)F(s,"get",t+"");const o=s[t](...e);return-1===o||!1===o?s[t](...e.map(Ve)):o}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...e){D();const s=Ve(this)[t].apply(this,e);return U(),s}}),e}function J(e=!1,t=!1){return function(s,o,a){if("__v_isReactive"===o)return!e;if("__v_isReadonly"===o)return e;if("__v_isShallow"===o)return t;if("__v_raw"===o&&a===(e?t?Ce:Be:t?Oe:Ie).get(s))return s;const n=l(s);if(!e&&n&&i(W,o))return Reflect.get(W,o,a);const r=Reflect.get(s,o,a);return(m(o)?X.has(o):Y(o))?r:(e||F(s,"get",o),t?r:Ze(r)?n&&v(o)?r:r.value:h(r)?e?He(r):Pe(r):r)}}const ee=se(),te=se(!0);function se(e=!1){return function(t,s,o,a){let n=t[s];if(Fe(n)&&Ze(n)&&!Ze(o))return!1;if(!e&&!Fe(o)&&($e(o)||(o=Ve(o),n=Ve(n)),!l(t)&&Ze(n)&&!Ze(o)))return n.value=o,!0;const r=l(t)&&v(s)?Number(s)<t.length:i(t,s),c=Reflect.set(t,s,o,a);return t===Ve(a)&&(r?_(o,n)&&q(t,"set",s,o):q(t,"add",s,o)),c}}function oe(e,t){const s=i(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&s&&q(e,"delete",t,void 0),o}function ae(e,t){const s=Reflect.has(e,t);return m(t)&&X.has(t)||F(e,"has",t),s}function ne(e){return F(e,"iterate",l(e)?"length":C),Reflect.ownKeys(e)}const re={get:K,set:ee,deleteProperty:oe,has:ae,ownKeys:ne},ie={get:Z,set(e,t){return!0},deleteProperty(e,t){return!0}},le=n({},re,{get:G,set:te}),ce=e=>e,de=e=>Reflect.getPrototypeOf(e);function ue(e,t,s=!1,o=!1){e=e["__v_raw"];const a=Ve(e),n=Ve(t);s||(t!==n&&F(a,"get",t),F(a,"get",n));const{has:r}=de(a),i=o?ce:s?Xe:Ye;return r.call(a,t)?i(e.get(t)):r.call(a,n)?i(e.get(n)):void(e!==a&&e.get(t))}function me(e,t=!1){const s=this["__v_raw"],o=Ve(s),a=Ve(e);return t||(e!==a&&F(o,"has",e),F(o,"has",a)),e===a?s.has(e):s.has(e)||s.has(a)}function he(e,t=!1){return e=e["__v_raw"],!t&&F(Ve(e),"iterate",C),Reflect.get(e,"size",e)}function pe(e){e=Ve(e);const t=Ve(this),s=de(t),o=s.has.call(t,e);return o||(t.add(e),q(t,"add",e,e)),this}function fe(e,t){t=Ve(t);const s=Ve(this),{has:o,get:a}=de(s);let n=o.call(s,e);n||(e=Ve(e),n=o.call(s,e));const r=a.call(s,e);return s.set(e,t),n?_(t,r)&&q(s,"set",e,t):q(s,"add",e,t),this}function ge(e){const t=Ve(this),{has:s,get:o}=de(t);let a=s.call(t,e);a||(e=Ve(e),a=s.call(t,e)),o&&o.call(t,e);const n=t.delete(e);return a&&q(t,"delete",e,void 0),n}function ve(){const e=Ve(this),t=0!==e.size,s=e.clear();return t&&q(e,"clear",void 0,void 0),s}function _e(e,t){return function(s,o){const a=this,n=a["__v_raw"],r=Ve(n),i=t?ce:e?Xe:Ye;return!e&&F(r,"iterate",C),n.forEach((e,t)=>s.call(o,i(e),i(t),a))}}function be(e,t,s){return function(...o){const a=this["__v_raw"],n=Ve(a),r=c(n),i="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,d=a[e](...o),u=s?ce:t?Xe:Ye;return!t&&F(n,"iterate",l?j:C),{next(){const{value:e,done:t}=d.next();return t?{value:e,done:t}:{value:i?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function ye(e){return function(...t){return"delete"!==e&&this}}function xe(){const e={get(e){return ue(this,e)},get size(){return he(this)},has:me,add:pe,set:fe,delete:ge,clear:ve,forEach:_e(!1,!1)},t={get(e){return ue(this,e,!1,!0)},get size(){return he(this)},has:me,add:pe,set:fe,delete:ge,clear:ve,forEach:_e(!1,!0)},s={get(e){return ue(this,e,!0)},get size(){return he(this,!0)},has(e){return me.call(this,e,!0)},add:ye("add"),set:ye("set"),delete:ye("delete"),clear:ye("clear"),forEach:_e(!0,!1)},o={get(e){return ue(this,e,!0,!0)},get size(){return he(this,!0)},has(e){return me.call(this,e,!0)},add:ye("add"),set:ye("set"),delete:ye("delete"),clear:ye("clear"),forEach:_e(!0,!0)},a=["keys","values","entries",Symbol.iterator];return a.forEach(a=>{e[a]=be(a,!1,!1),s[a]=be(a,!0,!1),t[a]=be(a,!1,!0),o[a]=be(a,!0,!0)}),[e,s,t,o]}const[we,ke,Me,Se]=xe();function Re(e,t){const s=t?e?Se:Me:e?ke:we;return(t,o,a)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get(i(s,o)&&o in t?s:t,o,a)}const Ae={get:Re(!1,!1)},Ee={get:Re(!1,!0)},Te={get:Re(!0,!1)},Ie=new WeakMap,Oe=new WeakMap,Be=new WeakMap,Ce=new WeakMap;function je(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Le(e){return e["__v_skip"]||!Object.isExtensible(e)?0:je(g(e))}function Pe(e){return Fe(e)?e:De(e,!1,re,Ae,Ie)}function Ne(e){return De(e,!1,le,Ee,Oe)}function He(e){return De(e,!0,ie,Te,Be)}function De(e,t,s,o,a){if(!h(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const n=a.get(e);if(n)return n;const r=Le(e);if(0===r)return e;const i=new Proxy(e,2===r?o:s);return a.set(e,i),i}function Ue(e){return Fe(e)?Ue(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function Fe(e){return!(!e||!e["__v_isReadonly"])}function $e(e){return!(!e||!e["__v_isShallow"])}function qe(e){return Ue(e)||Fe(e)}function Ve(e){const t=e&&e["__v_raw"];return t?Ve(t):e}function ze(e){return b(e,"__v_skip",!0),e}const Ye=e=>h(e)?Pe(e):e,Xe=e=>h(e)?He(e):e;function Ke(e){N&&B&&(e=Ve(e),$(e.dep||(e.dep=k())))}function Ge(e,t){e=Ve(e),e.dep&&V(e.dep)}function Ze(e){return!(!e||!0!==e.__v_isRef)}function We(e){return Ze(e)?e.value:e}const Qe={get:(e,t,s)=>We(Reflect.get(e,t,s)),set:(e,t,s,o)=>{const a=e[t];return Ze(a)&&!Ze(s)?(a.value=s,!0):Reflect.set(e,t,s,o)}};function Je(e){return Ue(e)?e:new Proxy(e,Qe)}class et{constructor(e,t,s,o){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new L(e,()=>{this._dirty||(this._dirty=!0,Ge(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this["__v_isReadonly"]=s}get value(){const e=Ve(this);return Ke(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function tt(e,t,s=!1){let o,n;const r=d(e);r?(o=e,n=a):(o=e.get,n=e.set);const i=new et(o,n,r||!n,s);return i}function st(e,t){const s=Object.create(null),o=e.split(",");for(let a=0;a<o.length;a++)s[o[a]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}function ot(e){if(wt(e)){const t={};for(let s=0;s<e.length;s++){const o=e[s],a=Rt(o)?rt(o):ot(o);if(a)for(const e in a)t[e]=a[e]}return t}return Rt(e)||At(e)?e:void 0}const at=/;(?![^(]*\))/g,nt=/:(.+)/;function rt(e){const t={};return e.split(at).forEach(e=>{if(e){const s=e.split(nt);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function it(e){let t="";if(Rt(e))t=e;else if(wt(e))for(let s=0;s<e.length;s++){const o=it(e[s]);o&&(t+=o+" ")}else if(At(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function lt(e){if(!e)return null;let{class:t,style:s}=e;return t&&!Rt(t)&&(e.class=it(t)),s&&(e.style=ot(s)),e}const ct=e=>Rt(e)?e:null==e?"":wt(e)||At(e)&&(e.toString===Tt||!St(e.toString))?JSON.stringify(e,dt,2):String(e),dt=(e,t)=>t&&t.__v_isRef?dt(e,t.value):kt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,s])=>(e[t+" =>"]=s,e),{})}:Mt(t)?{[`Set(${t.size})`]:[...t.values()]}:!At(t)||wt(t)||Ot(t)?t:String(t),ut={},mt=[],ht=()=>{},pt=()=>!1,ft=/^on[^a-z]/,gt=e=>ft.test(e),vt=e=>e.startsWith("onUpdate:"),_t=Object.assign,bt=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},yt=Object.prototype.hasOwnProperty,xt=(e,t)=>yt.call(e,t),wt=Array.isArray,kt=e=>"[object Map]"===It(e),Mt=e=>"[object Set]"===It(e),St=e=>"function"===typeof e,Rt=e=>"string"===typeof e,At=e=>null!==e&&"object"===typeof e,Et=e=>At(e)&&St(e.then)&&St(e.catch),Tt=Object.prototype.toString,It=e=>Tt.call(e),Ot=e=>"[object Object]"===It(e),Bt=st(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ct=e=>{const t=Object.create(null);return s=>{const o=t[s];return o||(t[s]=e(s))}},jt=/-(\w)/g,Lt=Ct(e=>e.replace(jt,(e,t)=>t?t.toUpperCase():"")),Pt=/\B([A-Z])/g,Nt=Ct(e=>e.replace(Pt,"-$1").toLowerCase()),Ht=Ct(e=>e.charAt(0).toUpperCase()+e.slice(1)),Dt=Ct(e=>e?"on"+Ht(e):""),Ut=(e,t)=>!Object.is(e,t),Ft=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},$t=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},qt=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Vt;const zt=()=>Vt||(Vt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:{});function Yt(e,t,s,o){let a;try{a=o?e(...o):e()}catch(n){Kt(n,t,s)}return a}function Xt(e,t,s,o){if(St(e)){const a=Yt(e,t,s,o);return a&&Et(a)&&a.catch(e=>{Kt(e,t,s)}),a}const a=[];for(let n=0;n<e.length;n++)a.push(Xt(e[n],t,s,o));return a}function Kt(e,t,s,o=!0){const a=t?t.vnode:null;if(t){let o=t.parent;const a=t.proxy,n=s;while(o){const t=o.ec;if(t)for(let s=0;s<t.length;s++)if(!1===t[s](e,a,n))return;o=o.parent}const r=t.appContext.config.errorHandler;if(r)return void Yt(r,null,10,[e,a,n])}Gt(e,s,a,o)}function Gt(e,t,s,o=!0){console.error(e)}let Zt=!1,Wt=!1;const Qt=[];let Jt=0;const es=[];let ts=null,ss=0;const os=[];let as=null,ns=0;const rs=Promise.resolve();let is=null,ls=null;function cs(e){const t=is||rs;return e?t.then(this?e.bind(this):e):t}function ds(e){let t=Jt+1,s=Qt.length;while(t<s){const o=t+s>>>1,a=bs(Qt[o]);a<e?t=o+1:s=o}return t}function us(e){Qt.length&&Qt.includes(e,Zt&&e.allowRecurse?Jt+1:Jt)||e===ls||(null==e.id?Qt.push(e):Qt.splice(ds(e.id),0,e),ms())}function ms(){Zt||Wt||(Wt=!0,is=rs.then(ys))}function hs(e){const t=Qt.indexOf(e);t>Jt&&Qt.splice(t,1)}function ps(e,t,s,o){wt(e)?s.push(...e):t&&t.includes(e,e.allowRecurse?o+1:o)||s.push(e),ms()}function fs(e){ps(e,ts,es,ss)}function gs(e){ps(e,as,os,ns)}function vs(e,t=null){if(es.length){for(ls=t,ts=[...new Set(es)],es.length=0,ss=0;ss<ts.length;ss++)ts[ss]();ts=null,ss=0,ls=null,vs(e,t)}}function _s(e){if(vs(),os.length){const e=[...new Set(os)];if(os.length=0,as)return void as.push(...e);for(as=e,as.sort((e,t)=>bs(e)-bs(t)),ns=0;ns<as.length;ns++)as[ns]();as=null,ns=0}}const bs=e=>null==e.id?1/0:e.id;function ys(e){Wt=!1,Zt=!0,vs(e),Qt.sort((e,t)=>bs(e)-bs(t));try{for(Jt=0;Jt<Qt.length;Jt++){const e=Qt[Jt];e&&!1!==e.active&&Yt(e,null,14)}}finally{Jt=0,Qt.length=0,_s(),Zt=!1,is=null,(Qt.length||es.length||os.length)&&ys(e)}}function xs(e,t,...s){if(e.isUnmounted)return;const o=e.vnode.props||ut;let a=s;const n=t.startsWith("update:"),r=n&&t.slice(7);if(r&&r in o){const e=("modelValue"===r?"model":r)+"Modifiers",{number:t,trim:n}=o[e]||ut;n&&(a=s.map(e=>e.trim())),t&&(a=s.map(qt))}let i,l=o[i=Dt(t)]||o[i=Dt(Lt(t))];!l&&n&&(l=o[i=Dt(Nt(t))]),l&&Xt(l,e,6,a);const c=o[i+"Once"];if(c){if(e.emitted){if(e.emitted[i])return}else e.emitted={};e.emitted[i]=!0,Xt(c,e,6,a)}}function ws(e,t,s=!1){const o=t.emitsCache,a=o.get(e);if(void 0!==a)return a;const n=e.emits;let r={},i=!1;if(!St(e)){const o=e=>{const s=ws(e,t,!0);s&&(i=!0,_t(r,s))};!s&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return n||i?(wt(n)?n.forEach(e=>r[e]=null):_t(r,n),o.set(e,r),r):(o.set(e,null),null)}function ks(e,t){return!(!e||!gt(t))&&(t=t.slice(2).replace(/Once$/,""),xt(e,t[0].toLowerCase()+t.slice(1))||xt(e,Nt(t))||xt(e,t))}let Ms=null,Ss=null;function Rs(e){const t=Ms;return Ms=e,Ss=e&&e.type.__scopeId||null,t}function As(e,t=Ms,s){if(!t)return e;if(e._n)return e;const o=(...s)=>{o._d&&Ca(-1);const a=Rs(t),n=e(...s);return Rs(a),o._d&&Ca(1),n};return o._n=!0,o._c=!0,o._d=!0,o}function Es(e){const{type:t,vnode:s,proxy:o,withProxy:a,props:n,propsOptions:[r],slots:i,attrs:l,emit:c,render:d,renderCache:u,data:m,setupState:h,ctx:p,inheritAttrs:f}=e;let g,v;const _=Rs(e);try{if(4&s.shapeFlag){const e=a||o;g=Ga(d.call(e,e,u,n,h,m,p)),v=l}else{const e=t;0,g=Ga(e.length>1?e(n,{attrs:l,slots:i,emit:c}):e(n,null)),v=t.props?l:Ts(l)}}catch(y){Ea.length=0,Kt(y,e,1),g=qa(Ra)}let b=g;if(v&&!1!==f){const e=Object.keys(v),{shapeFlag:t}=b;e.length&&7&t&&(r&&e.some(vt)&&(v=Is(v,r)),b=Ya(b,v))}return s.dirs&&(b=Ya(b),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&(b.transition=s.transition),g=b,Rs(_),g}const Ts=e=>{let t;for(const s in e)("class"===s||"style"===s||gt(s))&&((t||(t={}))[s]=e[s]);return t},Is=(e,t)=>{const s={};for(const o in e)vt(o)&&o.slice(9)in t||(s[o]=e[o]);return s};function Os(e,t,s){const{props:o,children:a,component:n}=e,{props:r,children:i,patchFlag:l}=t,c=n.emitsOptions;if(t.dirs||t.transition)return!0;if(!(s&&l>=0))return!(!a&&!i||i&&i.$stable)||o!==r&&(o?!r||Bs(o,r,c):!!r);if(1024&l)return!0;if(16&l)return o?Bs(o,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t];if(r[s]!==o[s]&&!ks(c,s))return!0}}return!1}function Bs(e,t,s){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let a=0;a<o.length;a++){const n=o[a];if(t[n]!==e[n]&&!ks(s,n))return!0}return!1}function Cs({vnode:e,parent:t},s){while(t&&t.subTree===e)(e=t.vnode).el=s,t=t.parent}const js=e=>e.__isSuspense;function Ls(e,t){t&&t.pendingBranch?wt(e)?t.effects.push(...e):t.effects.push(e):gs(e)}function Ps(e,t){if(on){let s=on.provides;const o=on.parent&&on.parent.provides;o===s&&(s=on.provides=Object.create(o)),s[e]=t}else;}function Ns(e,t,s=!1){const o=on||Ms;if(o){const a=null==o.parent?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return s&&St(t)?t.call(o.proxy):t}}const Hs={};function Ds(e,t,s){return Us(e,t,s)}function Us(e,t,{immediate:s,deep:o,flush:a,onTrack:n,onTrigger:r}=ut){const i=on;let l,c,d=!1,u=!1;if(Ze(e)?(l=()=>e.value,d=$e(e)):Ue(e)?(l=()=>e,o=!0):wt(e)?(u=!0,d=e.some(e=>Ue(e)||$e(e)),l=()=>e.map(e=>Ze(e)?e.value:Ue(e)?qs(e):St(e)?Yt(e,i,2):void 0)):l=St(e)?t?()=>Yt(e,i,2):()=>{if(!i||!i.isUnmounted)return c&&c(),Xt(e,i,3,[m])}:ht,t&&o){const e=l;l=()=>qs(e())}let m=e=>{c=g.onStop=()=>{Yt(e,i,4)}};if(dn)return m=ht,t?s&&Xt(t,i,3,[l(),u?[]:void 0,m]):l(),ht;let h=u?[]:Hs;const p=()=>{if(g.active)if(t){const e=g.run();(o||d||(u?e.some((e,t)=>Ut(e,h[t])):Ut(e,h)))&&(c&&c(),Xt(t,i,3,[e,h===Hs?void 0:h,m]),h=e)}else g.run()};let f;p.allowRecurse=!!t,f="sync"===a?p:"post"===a?()=>va(p,i&&i.suspense):()=>fs(p);const g=new L(l,f);return t?s?p():h=g.run():"post"===a?va(g.run.bind(g),i&&i.suspense):g.run(),()=>{g.stop(),i&&i.scope&&bt(i.scope.effects,g)}}function Fs(e,t,s){const o=this.proxy,a=Rt(e)?e.includes(".")?$s(o,e):()=>o[e]:e.bind(o,o);let n;St(t)?n=t:(n=t.handler,s=t);const r=on;nn(this);const i=Us(a,n.bind(o),s);return r?nn(r):rn(),i}function $s(e,t){const s=t.split(".");return()=>{let t=e;for(let e=0;e<s.length&&t;e++)t=t[s[e]];return t}}function qs(e,t){if(!At(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),Ze(e))qs(e.value,t);else if(wt(e))for(let s=0;s<e.length;s++)qs(e[s],t);else if(Mt(e)||kt(e))e.forEach(e=>{qs(e,t)});else if(Ot(e))for(const s in e)qs(e[s],t);return e}function Vs(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return uo(()=>{e.isMounted=!0}),po(()=>{e.isUnmounting=!0}),e}const zs=[Function,Array],Ys={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:zs,onEnter:zs,onAfterEnter:zs,onEnterCancelled:zs,onBeforeLeave:zs,onLeave:zs,onAfterLeave:zs,onLeaveCancelled:zs,onBeforeAppear:zs,onAppear:zs,onAfterAppear:zs,onAppearCancelled:zs},setup(e,{slots:t}){const s=an(),o=Vs();let a;return()=>{const n=t.default&&Js(t.default(),!0);if(!n||!n.length)return;let r=n[0];if(n.length>1)for(const e of n)if(e.type!==Ra){r=e;break}const i=Ve(e),{mode:l}=i;if(o.isLeaving)return Zs(r);const c=Ws(r);if(!c)return Zs(r);const d=Gs(c,i,o,s);Qs(c,d);const u=s.subTree,m=u&&Ws(u);let h=!1;const{getTransitionKey:p}=c.type;if(p){const e=p();void 0===a?a=e:e!==a&&(a=e,h=!0)}if(m&&m.type!==Ra&&(!Ha(c,m)||h)){const e=Gs(m,i,o,s);if(Qs(m,e),"out-in"===l)return o.isLeaving=!0,e.afterLeave=()=>{o.isLeaving=!1,s.update()},Zs(r);"in-out"===l&&c.type!==Ra&&(e.delayLeave=(e,t,s)=>{const a=Ks(o,m);a[String(m.key)]=m,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=s})}return r}}},Xs=Ys;function Ks(e,t){const{leavingVNodes:s}=e;let o=s.get(t.type);return o||(o=Object.create(null),s.set(t.type,o)),o}function Gs(e,t,s,o){const{appear:a,mode:n,persisted:r=!1,onBeforeEnter:i,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:m,onAfterLeave:h,onLeaveCancelled:p,onBeforeAppear:f,onAppear:g,onAfterAppear:v,onAppearCancelled:_}=t,b=String(e.key),y=Ks(s,e),x=(e,t)=>{e&&Xt(e,o,9,t)},w=(e,t)=>{const s=t[1];x(e,t),wt(e)?e.every(e=>e.length<=1)&&s():e.length<=1&&s()},k={mode:n,persisted:r,beforeEnter(t){let o=i;if(!s.isMounted){if(!a)return;o=f||i}t._leaveCb&&t._leaveCb(!0);const n=y[b];n&&Ha(e,n)&&n.el._leaveCb&&n.el._leaveCb(),x(o,[t])},enter(e){let t=l,o=c,n=d;if(!s.isMounted){if(!a)return;t=g||l,o=v||c,n=_||d}let r=!1;const i=e._enterCb=t=>{r||(r=!0,x(t?n:o,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,i]):i()},leave(t,o){const a=String(e.key);if(t._enterCb&&t._enterCb(!0),s.isUnmounting)return o();x(u,[t]);let n=!1;const r=t._leaveCb=s=>{n||(n=!0,o(),x(s?p:h,[t]),t._leaveCb=void 0,y[a]===e&&delete y[a])};y[a]=e,m?w(m,[t,r]):r()},clone(e){return Gs(e,t,s,o)}};return k}function Zs(e){if(so(e))return e=Ya(e),e.children=null,e}function Ws(e){return so(e)?e.children?e.children[0]:void 0:e}function Qs(e,t){6&e.shapeFlag&&e.component?Qs(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Js(e,t=!1,s){let o=[],a=0;for(let n=0;n<e.length;n++){let r=e[n];const i=null==s?r.key:String(s)+String(null!=r.key?r.key:n);r.type===Ma?(128&r.patchFlag&&a++,o=o.concat(Js(r.children,t,i))):(t||r.type!==Ra)&&o.push(null!=i?Ya(r,{key:i}):r)}if(a>1)for(let n=0;n<o.length;n++)o[n].patchFlag=-2;return o}function eo(e){return St(e)?{setup:e,name:e.name}:e}const to=e=>!!e.type.__asyncLoader,so=e=>e.type.__isKeepAlive;function oo(e,t){no(e,"a",t)}function ao(e,t){no(e,"da",t)}function no(e,t,s=on){const o=e.__wdc||(e.__wdc=()=>{let t=s;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(io(t,o,s),s){let e=s.parent;while(e&&e.parent)so(e.parent.vnode)&&ro(o,t,s,e),e=e.parent}}function ro(e,t,s,o){const a=io(t,e,o,!0);fo(()=>{bt(o[t],a)},s)}function io(e,t,s=on,o=!1){if(s){const a=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...o)=>{if(s.isUnmounted)return;D(),nn(s);const a=Xt(t,s,e,o);return rn(),U(),a});return o?a.unshift(n):a.push(n),n}}const lo=e=>(t,s=on)=>(!dn||"sp"===e)&&io(e,t,s),co=lo("bm"),uo=lo("m"),mo=lo("bu"),ho=lo("u"),po=lo("bum"),fo=lo("um"),go=lo("sp"),vo=lo("rtg"),_o=lo("rtc");function bo(e,t=on){io("ec",e,t)}function yo(e,t){const s=Ms;if(null===s)return e;const o=vn(s)||s.proxy,a=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[e,s,r,i=ut]=t[n];St(e)&&(e={mounted:e,updated:e}),e.deep&&qs(s),a.push({dir:e,instance:o,value:s,oldValue:void 0,arg:r,modifiers:i})}return e}function xo(e,t,s,o){const a=e.dirs,n=t&&t.dirs;for(let r=0;r<a.length;r++){const i=a[r];n&&(i.oldValue=n[r].value);let l=i.dir[o];l&&(D(),Xt(l,s,8,[e.el,i,e,t]),U())}}const wo="components",ko="directives";function Mo(e,t){return Eo(wo,e,!0,t)||e}const So=Symbol();function Ro(e){return Rt(e)?Eo(wo,e,!1)||e:e||So}function Ao(e){return Eo(ko,e)}function Eo(e,t,s=!0,o=!1){const a=Ms||on;if(a){const s=a.type;if(e===wo){const e=_n(s,!1);if(e&&(e===t||e===Lt(t)||e===Ht(Lt(t))))return s}const n=To(a[e]||s[e],t)||To(a.appContext[e],t);return!n&&o?s:n}}function To(e,t){return e&&(e[t]||e[Lt(t)]||e[Ht(Lt(t))])}function Io(e,t,s,o){let a;const n=s&&s[o];if(wt(e)||Rt(e)){a=new Array(e.length);for(let s=0,o=e.length;s<o;s++)a[s]=t(e[s],s,void 0,n&&n[s])}else if("number"===typeof e){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,n&&n[s])}else if(At(e))if(e[Symbol.iterator])a=Array.from(e,(e,s)=>t(e,s,void 0,n&&n[s]));else{const s=Object.keys(e);a=new Array(s.length);for(let o=0,r=s.length;o<r;o++){const r=s[o];a[o]=t(e[r],r,o,n&&n[o])}}else a=[];return s&&(s[o]=a),a}function Oo(e,t){for(let s=0;s<t.length;s++){const o=t[s];if(wt(o))for(let t=0;t<o.length;t++)e[o[t].name]=o[t].fn;else o&&(e[o.name]=o.fn)}return e}function Bo(e,t,s={},o,a){if(Ms.isCE||Ms.parent&&to(Ms.parent)&&Ms.parent.isCE)return qa("slot","default"===t?null:{name:t},o&&o());let n=e[t];n&&n._c&&(n._d=!1),Ia();const r=n&&Co(n(s)),i=Pa(Ma,{key:s.key||"_"+t},r||(o?o():[]),r&&1===e._?64:-2);return!a&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),n&&n._c&&(n._d=!0),i}function Co(e){return e.some(e=>!Na(e)||e.type!==Ra&&!(e.type===Ma&&!Co(e.children)))?e:null}const jo=e=>e?ln(e)?vn(e)||e.proxy:jo(e.parent):null,Lo=_t(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jo(e.parent),$root:e=>jo(e.root),$emit:e=>e.emit,$options:e=>$o(e),$forceUpdate:e=>e.f||(e.f=()=>us(e.update)),$nextTick:e=>e.n||(e.n=cs.bind(e.proxy)),$watch:e=>Fs.bind(e)}),Po={get({_:e},t){const{ctx:s,setupState:o,data:a,props:n,accessCache:r,type:i,appContext:l}=e;let c;if("$"!==t[0]){const i=r[t];if(void 0!==i)switch(i){case 1:return o[t];case 2:return a[t];case 4:return s[t];case 3:return n[t]}else{if(o!==ut&&xt(o,t))return r[t]=1,o[t];if(a!==ut&&xt(a,t))return r[t]=2,a[t];if((c=e.propsOptions[0])&&xt(c,t))return r[t]=3,n[t];if(s!==ut&&xt(s,t))return r[t]=4,s[t];No&&(r[t]=0)}}const d=Lo[t];let u,m;return d?("$attrs"===t&&F(e,"get",t),d(e)):(u=i.__cssModules)&&(u=u[t])?u:s!==ut&&xt(s,t)?(r[t]=4,s[t]):(m=l.config.globalProperties,xt(m,t)?m[t]:void 0)},set({_:e},t,s){const{data:o,setupState:a,ctx:n}=e;return a!==ut&&xt(a,t)?(a[t]=s,!0):o!==ut&&xt(o,t)?(o[t]=s,!0):!xt(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(n[t]=s,!0))},has({_:{data:e,setupState:t,accessCache:s,ctx:o,appContext:a,propsOptions:n}},r){let i;return!!s[r]||e!==ut&&xt(e,r)||t!==ut&&xt(t,r)||(i=n[0])&&xt(i,r)||xt(o,r)||xt(Lo,r)||xt(a.config.globalProperties,r)},defineProperty(e,t,s){return null!=s.get?e._.accessCache[t]=0:xt(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let No=!0;function Ho(e){const t=$o(e),s=e.proxy,o=e.ctx;No=!1,t.beforeCreate&&Uo(t.beforeCreate,e,"bc");const{data:a,computed:n,methods:r,watch:i,provide:l,inject:c,created:d,beforeMount:u,mounted:m,beforeUpdate:h,updated:p,activated:f,deactivated:g,beforeDestroy:v,beforeUnmount:_,destroyed:b,unmounted:y,render:x,renderTracked:w,renderTriggered:k,errorCaptured:M,serverPrefetch:S,expose:R,inheritAttrs:A,components:E,directives:T,filters:I}=t,O=null;if(c&&Do(c,o,O,e.appContext.config.unwrapInjectedRef),r)for(const C in r){const e=r[C];St(e)&&(o[C]=e.bind(s))}if(a){const t=a.call(s,s);At(t)&&(e.data=Pe(t))}if(No=!0,n)for(const C in n){const e=n[C],t=St(e)?e.bind(s,s):St(e.get)?e.get.bind(s,s):ht,a=!St(e)&&St(e.set)?e.set.bind(s):ht,r=yn({get:t,set:a});Object.defineProperty(o,C,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(i)for(const C in i)Fo(i[C],o,s,C);if(l){const e=St(l)?l.call(s):l;Reflect.ownKeys(e).forEach(t=>{Ps(t,e[t])})}function B(e,t){wt(t)?t.forEach(t=>e(t.bind(s))):t&&e(t.bind(s))}if(d&&Uo(d,e,"c"),B(co,u),B(uo,m),B(mo,h),B(ho,p),B(oo,f),B(ao,g),B(bo,M),B(_o,w),B(vo,k),B(po,_),B(fo,y),B(go,S),wt(R))if(R.length){const t=e.exposed||(e.exposed={});R.forEach(e=>{Object.defineProperty(t,e,{get:()=>s[e],set:t=>s[e]=t})})}else e.exposed||(e.exposed={});x&&e.render===ht&&(e.render=x),null!=A&&(e.inheritAttrs=A),E&&(e.components=E),T&&(e.directives=T)}function Do(e,t,s=ht,o=!1){wt(e)&&(e=Xo(e));for(const a in e){const s=e[a];let n;n=At(s)?"default"in s?Ns(s.from||a,s.default,!0):Ns(s.from||a):Ns(s),Ze(n)&&o?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>n.value,set:e=>n.value=e}):t[a]=n}}function Uo(e,t,s){Xt(wt(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,s)}function Fo(e,t,s,o){const a=o.includes(".")?$s(s,o):()=>s[o];if(Rt(e)){const s=t[e];St(s)&&Ds(a,s)}else if(St(e))Ds(a,e.bind(s));else if(At(e))if(wt(e))e.forEach(e=>Fo(e,t,s,o));else{const o=St(e.handler)?e.handler.bind(s):t[e.handler];St(o)&&Ds(a,o,e)}}function $o(e){const t=e.type,{mixins:s,extends:o}=t,{mixins:a,optionsCache:n,config:{optionMergeStrategies:r}}=e.appContext,i=n.get(t);let l;return i?l=i:a.length||s||o?(l={},a.length&&a.forEach(e=>qo(l,e,r,!0)),qo(l,t,r)):l=t,n.set(t,l),l}function qo(e,t,s,o=!1){const{mixins:a,extends:n}=t;n&&qo(e,n,s,!0),a&&a.forEach(t=>qo(e,t,s,!0));for(const r in t)if(o&&"expose"===r);else{const o=Vo[r]||s&&s[r];e[r]=o?o(e[r],t[r]):t[r]}return e}const Vo={data:zo,props:Go,emits:Go,methods:Go,computed:Go,beforeCreate:Ko,created:Ko,beforeMount:Ko,mounted:Ko,beforeUpdate:Ko,updated:Ko,beforeDestroy:Ko,beforeUnmount:Ko,destroyed:Ko,unmounted:Ko,activated:Ko,deactivated:Ko,errorCaptured:Ko,serverPrefetch:Ko,components:Go,directives:Go,watch:Zo,provide:zo,inject:Yo};function zo(e,t){return t?e?function(){return _t(St(e)?e.call(this,this):e,St(t)?t.call(this,this):t)}:t:e}function Yo(e,t){return Go(Xo(e),Xo(t))}function Xo(e){if(wt(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Ko(e,t){return e?[...new Set([].concat(e,t))]:t}function Go(e,t){return e?_t(_t(Object.create(null),e),t):t}function Zo(e,t){if(!e)return t;if(!t)return e;const s=_t(Object.create(null),e);for(const o in t)s[o]=Ko(e[o],t[o]);return s}function Wo(e,t,s,o=!1){const a={},n={};$t(n,Da,1),e.propsDefaults=Object.create(null),Jo(e,t,a,n);for(const r in e.propsOptions[0])r in a||(a[r]=void 0);s?e.props=o?a:Ne(a):e.type.props?e.props=a:e.props=n,e.attrs=n}function Qo(e,t,s,o){const{props:a,attrs:n,vnode:{patchFlag:r}}=e,i=Ve(a),[l]=e.propsOptions;let c=!1;if(!(o||r>0)||16&r){let o;Jo(e,t,a,n)&&(c=!0);for(const n in i)t&&(xt(t,n)||(o=Nt(n))!==n&&xt(t,o))||(l?!s||void 0===s[n]&&void 0===s[o]||(a[n]=ea(l,i,n,void 0,e,!0)):delete a[n]);if(n!==i)for(const e in n)t&&xt(t,e)||(delete n[e],c=!0)}else if(8&r){const s=e.vnode.dynamicProps;for(let o=0;o<s.length;o++){let r=s[o];if(ks(e.emitsOptions,r))continue;const d=t[r];if(l)if(xt(n,r))d!==n[r]&&(n[r]=d,c=!0);else{const t=Lt(r);a[t]=ea(l,i,t,d,e,!1)}else d!==n[r]&&(n[r]=d,c=!0)}}c&&q(e,"set","$attrs")}function Jo(e,t,s,o){const[a,n]=e.propsOptions;let r,i=!1;if(t)for(let l in t){if(Bt(l))continue;const c=t[l];let d;a&&xt(a,d=Lt(l))?n&&n.includes(d)?(r||(r={}))[d]=c:s[d]=c:ks(e.emitsOptions,l)||l in o&&c===o[l]||(o[l]=c,i=!0)}if(n){const t=Ve(s),o=r||ut;for(let r=0;r<n.length;r++){const i=n[r];s[i]=ea(a,t,i,o[i],e,!xt(o,i))}}return i}function ea(e,t,s,o,a,n){const r=e[s];if(null!=r){const e=xt(r,"default");if(e&&void 0===o){const e=r.default;if(r.type!==Function&&St(e)){const{propsDefaults:n}=a;s in n?o=n[s]:(nn(a),o=n[s]=e.call(null,t),rn())}else o=e}r[0]&&(n&&!e?o=!1:!r[1]||""!==o&&o!==Nt(s)||(o=!0))}return o}function ta(e,t,s=!1){const o=t.propsCache,a=o.get(e);if(a)return a;const n=e.props,r={},i=[];let l=!1;if(!St(e)){const o=e=>{l=!0;const[s,o]=ta(e,t,!0);_t(r,s),o&&i.push(...o)};!s&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}if(!n&&!l)return o.set(e,mt),mt;if(wt(n))for(let d=0;d<n.length;d++){const e=Lt(n[d]);sa(e)&&(r[e]=ut)}else if(n)for(const d in n){const e=Lt(d);if(sa(e)){const t=n[d],s=r[e]=wt(t)||St(t)?{type:t}:t;if(s){const t=na(Boolean,s.type),o=na(String,s.type);s[0]=t>-1,s[1]=o<0||t<o,(t>-1||xt(s,"default"))&&i.push(e)}}}const c=[r,i];return o.set(e,c),c}function sa(e){return"$"!==e[0]}function oa(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function aa(e,t){return oa(e)===oa(t)}function na(e,t){return wt(t)?t.findIndex(t=>aa(t,e)):St(t)&&aa(t,e)?0:-1}const ra=e=>"_"===e[0]||"$stable"===e,ia=e=>wt(e)?e.map(Ga):[Ga(e)],la=(e,t,s)=>{if(t._n)return t;const o=As((...e)=>ia(t(...e)),s);return o._c=!1,o},ca=(e,t,s)=>{const o=e._ctx;for(const a in e){if(ra(a))continue;const s=e[a];if(St(s))t[a]=la(a,s,o);else if(null!=s){const e=ia(s);t[a]=()=>e}}},da=(e,t)=>{const s=ia(t);e.slots.default=()=>s},ua=(e,t)=>{if(32&e.vnode.shapeFlag){const s=t._;s?(e.slots=Ve(t),$t(t,"_",s)):ca(t,e.slots={})}else e.slots={},t&&da(e,t);$t(e.slots,Da,1)},ma=(e,t,s)=>{const{vnode:o,slots:a}=e;let n=!0,r=ut;if(32&o.shapeFlag){const e=t._;e?s&&1===e?n=!1:(_t(a,t),s||1!==e||delete a._):(n=!t.$stable,ca(t,a)),r=t}else t&&(da(e,t),r={default:1});if(n)for(const i in a)ra(i)||i in r||delete a[i]};function ha(){return{app:null,config:{isNativeTag:pt,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let pa=0;function fa(e,t){return function(s,o=null){St(s)||(s=Object.assign({},s)),null==o||At(o)||(o=null);const a=ha(),n=new Set;let r=!1;const i=a.app={_uid:pa++,_component:s,_props:o,_container:null,_context:a,_instance:null,version:wn,get config(){return a.config},set config(e){},use(e,...t){return n.has(e)||(e&&St(e.install)?(n.add(e),e.install(i,...t)):St(e)&&(n.add(e),e(i,...t))),i},mixin(e){return a.mixins.includes(e)||a.mixins.push(e),i},component(e,t){return t?(a.components[e]=t,i):a.components[e]},directive(e,t){return t?(a.directives[e]=t,i):a.directives[e]},mount(n,l,c){if(!r){const d=qa(s,o);return d.appContext=a,l&&t?t(d,n):e(d,n,c),r=!0,i._container=n,n.__vue_app__=i,vn(d.component)||d.component.proxy}},unmount(){r&&(e(null,i._container),delete i._container.__vue_app__)},provide(e,t){return a.provides[e]=t,i}};return i}}function ga(e,t,s,o,a=!1){if(wt(e))return void e.forEach((e,n)=>ga(e,t&&(wt(t)?t[n]:t),s,o,a));if(to(o)&&!a)return;const n=4&o.shapeFlag?vn(o.component)||o.component.proxy:o.el,r=a?null:n,{i:i,r:l}=e,c=t&&t.r,d=i.refs===ut?i.refs={}:i.refs,u=i.setupState;if(null!=c&&c!==l&&(Rt(c)?(d[c]=null,xt(u,c)&&(u[c]=null)):Ze(c)&&(c.value=null)),St(l))Yt(l,i,12,[r,d]);else{const t=Rt(l),o=Ze(l);if(t||o){const i=()=>{if(e.f){const s=t?d[l]:l.value;a?wt(s)&&bt(s,n):wt(s)?s.includes(n)||s.push(n):t?(d[l]=[n],xt(u,l)&&(u[l]=d[l])):(l.value=[n],e.k&&(d[e.k]=l.value))}else t?(d[l]=r,xt(u,l)&&(u[l]=r)):o&&(l.value=r,e.k&&(d[e.k]=r))};r?(i.id=-1,va(i,s)):i()}}}const va=Ls;function _a(e){return ba(e)}function ba(e,t){const s=zt();s.__VUE__=!0;const{insert:o,remove:a,patchProp:n,createElement:r,createText:i,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:m,setScopeId:h=ht,cloneNode:p,insertStaticContent:f}=e,g=(e,t,s,o=null,a=null,n=null,r=!1,i=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Ha(e,t)&&(o=X(e),$(e,a,n,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:d,shapeFlag:u}=t;switch(c){case Sa:v(e,t,s,o);break;case Ra:_(e,t,s,o);break;case Aa:null==e&&b(t,s,o,r);break;case Ma:T(e,t,s,o,a,n,r,i,l);break;default:1&u?w(e,t,s,o,a,n,r,i,l):6&u?I(e,t,s,o,a,n,r,i,l):(64&u||128&u)&&c.process(e,t,s,o,a,n,r,i,l,G)}null!=d&&a&&ga(d,e&&e.ref,n,t||e,!t)},v=(e,t,s,a)=>{if(null==e)o(t.el=i(t.children),s,a);else{const s=t.el=e.el;t.children!==e.children&&c(s,t.children)}},_=(e,t,s,a)=>{null==e?o(t.el=l(t.children||""),s,a):t.el=e.el},b=(e,t,s,o)=>{[e.el,e.anchor]=f(e.children,t,s,o,e.el,e.anchor)},y=({el:e,anchor:t},s,a)=>{let n;while(e&&e!==t)n=m(e),o(e,s,a),e=n;o(t,s,a)},x=({el:e,anchor:t})=>{let s;while(e&&e!==t)s=m(e),a(e),e=s;a(t)},w=(e,t,s,o,a,n,r,i,l)=>{r=r||"svg"===t.type,null==e?k(t,s,o,a,n,r,i,l):R(e,t,a,n,r,i,l)},k=(e,t,s,a,i,l,c,u)=>{let m,h;const{type:f,props:g,shapeFlag:v,transition:_,patchFlag:b,dirs:y}=e;if(e.el&&void 0!==p&&-1===b)m=e.el=p(e.el);else{if(m=e.el=r(e.type,l,g&&g.is,g),8&v?d(m,e.children):16&v&&S(e.children,m,null,a,i,l&&"foreignObject"!==f,c,u),y&&xo(e,null,a,"created"),g){for(const t in g)"value"===t||Bt(t)||n(m,t,null,g[t],l,e.children,a,i,Y);"value"in g&&n(m,"value",null,g.value),(h=g.onVnodeBeforeMount)&&Ja(h,a,e)}M(m,e,e.scopeId,c,a)}y&&xo(e,null,a,"beforeMount");const x=(!i||i&&!i.pendingBranch)&&_&&!_.persisted;x&&_.beforeEnter(m),o(m,t,s),((h=g&&g.onVnodeMounted)||x||y)&&va(()=>{h&&Ja(h,a,e),x&&_.enter(m),y&&xo(e,null,a,"mounted")},i)},M=(e,t,s,o,a)=>{if(s&&h(e,s),o)for(let n=0;n<o.length;n++)h(e,o[n]);if(a){let s=a.subTree;if(t===s){const t=a.vnode;M(e,t,t.scopeId,t.slotScopeIds,a.parent)}}},S=(e,t,s,o,a,n,r,i,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=i?Za(e[c]):Ga(e[c]);g(null,l,t,s,o,a,n,r,i)}},R=(e,t,s,o,a,r,i)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:u,dirs:m}=t;c|=16&e.patchFlag;const h=e.props||ut,p=t.props||ut;let f;s&&ya(s,!1),(f=p.onVnodeBeforeUpdate)&&Ja(f,s,t,e),m&&xo(t,e,s,"beforeUpdate"),s&&ya(s,!0);const g=a&&"foreignObject"!==t.type;if(u?A(e.dynamicChildren,u,l,s,o,g,r):i||P(e,t,l,null,s,o,g,r,!1),c>0){if(16&c)E(l,t,h,p,s,o,a);else if(2&c&&h.class!==p.class&&n(l,"class",null,p.class,a),4&c&&n(l,"style",h.style,p.style,a),8&c){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const i=r[t],c=h[i],d=p[i];d===c&&"value"!==i||n(l,i,c,d,a,e.children,s,o,Y)}}1&c&&e.children!==t.children&&d(l,t.children)}else i||null!=u||E(l,t,h,p,s,o,a);((f=p.onVnodeUpdated)||m)&&va(()=>{f&&Ja(f,s,t,e),m&&xo(t,e,s,"updated")},o)},A=(e,t,s,o,a,n,r)=>{for(let i=0;i<t.length;i++){const l=e[i],c=t[i],d=l.el&&(l.type===Ma||!Ha(l,c)||70&l.shapeFlag)?u(l.el):s;g(l,c,d,null,o,a,n,r,!0)}},E=(e,t,s,o,a,r,i)=>{if(s!==o){for(const l in o){if(Bt(l))continue;const c=o[l],d=s[l];c!==d&&"value"!==l&&n(e,l,d,c,i,t.children,a,r,Y)}if(s!==ut)for(const l in s)Bt(l)||l in o||n(e,l,s[l],null,i,t.children,a,r,Y);"value"in o&&n(e,"value",s.value,o.value)}},T=(e,t,s,a,n,r,l,c,d)=>{const u=t.el=e?e.el:i(""),m=t.anchor=e?e.anchor:i("");let{patchFlag:h,dynamicChildren:p,slotScopeIds:f}=t;f&&(c=c?c.concat(f):f),null==e?(o(u,s,a),o(m,s,a),S(t.children,s,m,n,r,l,c,d)):h>0&&64&h&&p&&e.dynamicChildren?(A(e.dynamicChildren,p,s,n,r,l,c),(null!=t.key||n&&t===n.subTree)&&xa(e,t,!0)):P(e,t,s,m,n,r,l,c,d)},I=(e,t,s,o,a,n,r,i,l)=>{t.slotScopeIds=i,null==e?512&t.shapeFlag?a.ctx.activate(t,s,o,r,l):O(t,s,o,a,n,r,l):B(e,t,l)},O=(e,t,s,o,a,n,r)=>{const i=e.component=sn(e,o,a);if(so(e)&&(i.ctx.renderer=G),un(i),i.asyncDep){if(a&&a.registerDep(i,C),!e.el){const e=i.subTree=qa(Ra);_(null,e,t,s)}}else C(i,e,t,s,a,n,r)},B=(e,t,s)=>{const o=t.component=e.component;if(Os(e,t,s)){if(o.asyncDep&&!o.asyncResolved)return void j(o,t,s);o.next=t,hs(o.update),o.update()}else t.el=e.el,o.vnode=t},C=(e,t,s,o,a,n,r)=>{const i=()=>{if(e.isMounted){let t,{next:s,bu:o,u:i,parent:l,vnode:c}=e,d=s;ya(e,!1),s?(s.el=c.el,j(e,s,r)):s=c,o&&Ft(o),(t=s.props&&s.props.onVnodeBeforeUpdate)&&Ja(t,l,s,c),ya(e,!0);const m=Es(e),h=e.subTree;e.subTree=m,g(h,m,u(h.el),X(h),e,a,n),s.el=m.el,null===d&&Cs(e,m.el),i&&va(i,a),(t=s.props&&s.props.onVnodeUpdated)&&va(()=>Ja(t,l,s,c),a)}else{let r;const{el:i,props:l}=t,{bm:c,m:d,parent:u}=e,m=to(t);if(ya(e,!1),c&&Ft(c),!m&&(r=l&&l.onVnodeBeforeMount)&&Ja(r,u,t),ya(e,!0),i&&W){const s=()=>{e.subTree=Es(e),W(i,e.subTree,e,a,null)};m?t.type.__asyncLoader().then(()=>!e.isUnmounted&&s()):s()}else{const r=e.subTree=Es(e);g(null,r,s,o,e,a,n),t.el=r.el}if(d&&va(d,a),!m&&(r=l&&l.onVnodeMounted)){const e=t;va(()=>Ja(r,u,e),a)}(256&t.shapeFlag||u&&to(u.vnode)&&256&u.vnode.shapeFlag)&&e.a&&va(e.a,a),e.isMounted=!0,t=s=o=null}},l=e.effect=new L(i,()=>us(c),e.scope),c=e.update=()=>l.run();c.id=e.uid,ya(e,!0),c()},j=(e,t,s)=>{t.component=e;const o=e.vnode.props;e.vnode=t,e.next=null,Qo(e,t.props,o,s),ma(e,t.children,s),D(),vs(void 0,e.update),U()},P=(e,t,s,o,a,n,r,i,l=!1)=>{const c=e&&e.children,u=e?e.shapeFlag:0,m=t.children,{patchFlag:h,shapeFlag:p}=t;if(h>0){if(128&h)return void H(c,m,s,o,a,n,r,i,l);if(256&h)return void N(c,m,s,o,a,n,r,i,l)}8&p?(16&u&&Y(c,a,n),m!==c&&d(s,m)):16&u?16&p?H(c,m,s,o,a,n,r,i,l):Y(c,a,n,!0):(8&u&&d(s,""),16&p&&S(m,s,o,a,n,r,i,l))},N=(e,t,s,o,a,n,r,i,l)=>{e=e||mt,t=t||mt;const c=e.length,d=t.length,u=Math.min(c,d);let m;for(m=0;m<u;m++){const o=t[m]=l?Za(t[m]):Ga(t[m]);g(e[m],o,s,null,a,n,r,i,l)}c>d?Y(e,a,n,!0,!1,u):S(t,s,o,a,n,r,i,l,u)},H=(e,t,s,o,a,n,r,i,l)=>{let c=0;const d=t.length;let u=e.length-1,m=d-1;while(c<=u&&c<=m){const o=e[c],d=t[c]=l?Za(t[c]):Ga(t[c]);if(!Ha(o,d))break;g(o,d,s,null,a,n,r,i,l),c++}while(c<=u&&c<=m){const o=e[u],c=t[m]=l?Za(t[m]):Ga(t[m]);if(!Ha(o,c))break;g(o,c,s,null,a,n,r,i,l),u--,m--}if(c>u){if(c<=m){const e=m+1,u=e<d?t[e].el:o;while(c<=m)g(null,t[c]=l?Za(t[c]):Ga(t[c]),s,u,a,n,r,i,l),c++}}else if(c>m)while(c<=u)$(e[c],a,n,!0),c++;else{const h=c,p=c,f=new Map;for(c=p;c<=m;c++){const e=t[c]=l?Za(t[c]):Ga(t[c]);null!=e.key&&f.set(e.key,c)}let v,_=0;const b=m-p+1;let y=!1,x=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=h;c<=u;c++){const o=e[c];if(_>=b){$(o,a,n,!0);continue}let d;if(null!=o.key)d=f.get(o.key);else for(v=p;v<=m;v++)if(0===w[v-p]&&Ha(o,t[v])){d=v;break}void 0===d?$(o,a,n,!0):(w[d-p]=c+1,d>=x?x=d:y=!0,g(o,t[d],s,null,a,n,r,i,l),_++)}const k=y?wa(w):mt;for(v=k.length-1,c=b-1;c>=0;c--){const e=p+c,u=t[e],m=e+1<d?t[e+1].el:o;0===w[c]?g(null,u,s,m,a,n,r,i,l):y&&(v<0||c!==k[v]?F(u,s,m,2):v--)}}},F=(e,t,s,a,n=null)=>{const{el:r,type:i,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void F(e.component.subTree,t,s,a);if(128&d)return void e.suspense.move(t,s,a);if(64&d)return void i.move(e,t,s,G);if(i===Ma){o(r,t,s);for(let e=0;e<c.length;e++)F(c[e],t,s,a);return void o(e.anchor,t,s)}if(i===Aa)return void y(e,t,s);const u=2!==a&&1&d&&l;if(u)if(0===a)l.beforeEnter(r),o(r,t,s),va(()=>l.enter(r),n);else{const{leave:e,delayLeave:a,afterLeave:n}=l,i=()=>o(r,t,s),c=()=>{e(r,()=>{i(),n&&n()})};a?a(r,i,c):c()}else o(r,t,s)},$=(e,t,s,o=!1,a=!1)=>{const{type:n,props:r,ref:i,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:u,dirs:m}=e;if(null!=i&&ga(i,null,s,e,!0),256&d)return void t.ctx.deactivate(e);const h=1&d&&m,p=!to(e);let f;if(p&&(f=r&&r.onVnodeBeforeUnmount)&&Ja(f,t,e),6&d)z(e.component,s,o);else{if(128&d)return void e.suspense.unmount(s,o);h&&xo(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,s,a,G,o):c&&(n!==Ma||u>0&&64&u)?Y(c,t,s,!1,!0):(n===Ma&&384&u||!a&&16&d)&&Y(l,t,s),o&&q(e)}(p&&(f=r&&r.onVnodeUnmounted)||h)&&va(()=>{f&&Ja(f,t,e),h&&xo(e,null,t,"unmounted")},s)},q=e=>{const{type:t,el:s,anchor:o,transition:n}=e;if(t===Ma)return void V(s,o);if(t===Aa)return void x(e);const r=()=>{a(s),n&&!n.persisted&&n.afterLeave&&n.afterLeave()};if(1&e.shapeFlag&&n&&!n.persisted){const{leave:t,delayLeave:o}=n,a=()=>t(s,r);o?o(e.el,r,a):a()}else r()},V=(e,t)=>{let s;while(e!==t)s=m(e),a(e),e=s;a(t)},z=(e,t,s)=>{const{bum:o,scope:a,update:n,subTree:r,um:i}=e;o&&Ft(o),a.stop(),n&&(n.active=!1,$(r,e,t,s)),i&&va(i,t),va(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},Y=(e,t,s,o=!1,a=!1,n=0)=>{for(let r=n;r<e.length;r++)$(e[r],t,s,o,a)},X=e=>6&e.shapeFlag?X(e.component.subTree):128&e.shapeFlag?e.suspense.next():m(e.anchor||e.el),K=(e,t,s)=>{null==e?t._vnode&&$(t._vnode,null,null,!0):g(t._vnode||null,e,t,null,null,null,s),_s(),t._vnode=e},G={p:g,um:$,m:F,r:q,mt:O,mc:S,pc:P,pbc:A,n:X,o:e};let Z,W;return t&&([Z,W]=t(G)),{render:K,hydrate:Z,createApp:fa(K,Z)}}function ya({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function xa(e,t,s=!1){const o=e.children,a=t.children;if(wt(o)&&wt(a))for(let n=0;n<o.length;n++){const e=o[n];let t=a[n];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=a[n]=Za(a[n]),t.el=e.el),s||xa(e,t))}}function wa(e){const t=e.slice(),s=[0];let o,a,n,r,i;const l=e.length;for(o=0;o<l;o++){const l=e[o];if(0!==l){if(a=s[s.length-1],e[a]<l){t[o]=a,s.push(o);continue}n=0,r=s.length-1;while(n<r)i=n+r>>1,e[s[i]]<l?n=i+1:r=i;l<e[s[n]]&&(n>0&&(t[o]=s[n-1]),s[n]=o)}}n=s.length,r=s[n-1];while(n-- >0)s[n]=r,r=t[r];return s}const ka=e=>e.__isTeleport,Ma=Symbol(void 0),Sa=Symbol(void 0),Ra=Symbol(void 0),Aa=Symbol(void 0),Ea=[];let Ta=null;function Ia(e=!1){Ea.push(Ta=e?null:[])}function Oa(){Ea.pop(),Ta=Ea[Ea.length-1]||null}let Ba=1;function Ca(e){Ba+=e}function ja(e){return e.dynamicChildren=Ba>0?Ta||mt:null,Oa(),Ba>0&&Ta&&Ta.push(e),e}function La(e,t,s,o,a,n){return ja($a(e,t,s,o,a,n,!0))}function Pa(e,t,s,o,a){return ja(qa(e,t,s,o,a,!0))}function Na(e){return!!e&&!0===e.__v_isVNode}function Ha(e,t){return e.type===t.type&&e.key===t.key}const Da="__vInternal",Ua=({key:e})=>null!=e?e:null,Fa=({ref:e,ref_key:t,ref_for:s})=>null!=e?Rt(e)||Ze(e)||St(e)?{i:Ms,r:e,k:t,f:!!s}:e:null;function $a(e,t=null,s=null,o=0,a=null,n=(e===Ma?0:1),r=!1,i=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ua(t),ref:t&&Fa(t),scopeId:Ss,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:o,dynamicProps:a,dynamicChildren:null,appContext:null};return i?(Wa(l,s),128&n&&e.normalize(l)):s&&(l.shapeFlag|=Rt(s)?8:16),Ba>0&&!r&&Ta&&(l.patchFlag>0||6&n)&&32!==l.patchFlag&&Ta.push(l),l}const qa=Va;function Va(e,t=null,s=null,o=0,a=null,n=!1){if(e&&e!==So||(e=Ra),Na(e)){const o=Ya(e,t,!0);return s&&Wa(o,s),Ba>0&&!n&&Ta&&(6&o.shapeFlag?Ta[Ta.indexOf(e)]=o:Ta.push(o)),o.patchFlag|=-2,o}if(bn(e)&&(e=e.__vccOpts),t){t=za(t);let{class:e,style:s}=t;e&&!Rt(e)&&(t.class=it(e)),At(s)&&(qe(s)&&!wt(s)&&(s=_t({},s)),t.style=ot(s))}const r=Rt(e)?1:js(e)?128:ka(e)?64:At(e)?4:St(e)?2:0;return $a(e,t,s,o,a,r,n,!0)}function za(e){return e?qe(e)||Da in e?_t({},e):e:null}function Ya(e,t,s=!1){const{props:o,ref:a,patchFlag:n,children:r}=e,i=t?Qa(o||{},t):o,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:i,key:i&&Ua(i),ref:t&&t.ref?s&&a?wt(a)?a.concat(Fa(t)):[a,Fa(t)]:Fa(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ma?-1===n?16:16|n:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ya(e.ssContent),ssFallback:e.ssFallback&&Ya(e.ssFallback),el:e.el,anchor:e.anchor};return l}function Xa(e=" ",t=0){return qa(Sa,null,e,t)}function Ka(e="",t=!1){return t?(Ia(),Pa(Ra,null,e)):qa(Ra,null,e)}function Ga(e){return null==e||"boolean"===typeof e?qa(Ra):wt(e)?qa(Ma,null,e.slice()):"object"===typeof e?Za(e):qa(Sa,null,String(e))}function Za(e){return null===e.el||e.memo?e:Ya(e)}function Wa(e,t){let s=0;const{shapeFlag:o}=e;if(null==t)t=null;else if(wt(t))s=16;else if("object"===typeof t){if(65&o){const s=t.default;return void(s&&(s._c&&(s._d=!1),Wa(e,s()),s._c&&(s._d=!0)))}{s=32;const o=t._;o||Da in t?3===o&&Ms&&(1===Ms.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Ms}}else St(t)?(t={default:t,_ctx:Ms},s=32):(t=String(t),64&o?(s=16,t=[Xa(t)]):s=8);e.children=t,e.shapeFlag|=s}function Qa(...e){const t={};for(let s=0;s<e.length;s++){const o=e[s];for(const e in o)if("class"===e)t.class!==o.class&&(t.class=it([t.class,o.class]));else if("style"===e)t.style=ot([t.style,o.style]);else if(gt(e)){const s=t[e],a=o[e];!a||s===a||wt(s)&&s.includes(a)||(t[e]=s?[].concat(s,a):a)}else""!==e&&(t[e]=o[e])}return t}function Ja(e,t,s,o=null){Xt(e,t,7,[s,o])}const en=ha();let tn=0;function sn(e,t,s){const o=e.type,a=(t?t.appContext:e.appContext)||en,n={uid:tn++,vnode:e,type:o,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new x(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ta(o,a),emitsOptions:ws(o,a),emit:null,emitted:null,propsDefaults:ut,inheritAttrs:o.inheritAttrs,ctx:ut,data:ut,props:ut,attrs:ut,slots:ut,refs:ut,setupState:ut,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=xs.bind(null,n),e.ce&&e.ce(n),n}let on=null;const an=()=>on||Ms,nn=e=>{on=e,e.scope.on()},rn=()=>{on&&on.scope.off(),on=null};function ln(e){return 4&e.vnode.shapeFlag}let cn,dn=!1;function un(e,t=!1){dn=t;const{props:s,children:o}=e.vnode,a=ln(e);Wo(e,s,a,t),ua(e,o);const n=a?mn(e,t):void 0;return dn=!1,n}function mn(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=ze(new Proxy(e.ctx,Po));const{setup:o}=s;if(o){const s=e.setupContext=o.length>1?gn(e):null;nn(e),D();const a=Yt(o,e,0,[e.props,s]);if(U(),rn(),Et(a)){if(a.then(rn,rn),t)return a.then(s=>{hn(e,s,t)}).catch(t=>{Kt(t,e,0)});e.asyncDep=a}else hn(e,a,t)}else pn(e,t)}function hn(e,t,s){St(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:At(t)&&(e.setupState=Je(t)),pn(e,s)}function pn(e,t,s){const o=e.type;if(!e.render){if(!t&&cn&&!o.render){const t=o.template;if(t){const{isCustomElement:s,compilerOptions:a}=e.appContext.config,{delimiters:n,compilerOptions:r}=o,i=_t(_t({isCustomElement:s,delimiters:n},a),r);o.render=cn(t,i)}}e.render=o.render||ht}nn(e),D(),Ho(e),U(),rn()}function fn(e){return new Proxy(e.attrs,{get(t,s){return F(e,"get","$attrs"),t[s]}})}function gn(e){const t=t=>{e.exposed=t||{}};let s;return{get attrs(){return s||(s=fn(e))},slots:e.slots,emit:e.emit,expose:t}}function vn(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Je(ze(e.exposed)),{get(t,s){return s in t?t[s]:s in Lo?Lo[s](e):void 0}}))}function _n(e,t=!0){return St(e)?e.displayName||e.name:e.name||t&&e.__name}function bn(e){return St(e)&&"__vccOpts"in e}const yn=(e,t)=>tt(e,t,dn);function xn(e,t,s){const o=arguments.length;return 2===o?At(t)&&!wt(t)?Na(t)?qa(e,null,[t]):qa(e,t):qa(e,null,t):(o>3?s=Array.prototype.slice.call(arguments,2):3===o&&Na(s)&&(s=[s]),qa(e,t,s))}const wn="3.2.37";function kn(e,t){const s=Object.create(null),o=e.split(",");for(let a=0;a<o.length;a++)s[o[a]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}const Mn="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Sn=kn(Mn);function Rn(e){return!!e||""===e}const An=/^on[^a-z]/,En=e=>An.test(e),Tn=e=>e.startsWith("onUpdate:"),In=Object.assign,On=Array.isArray,Bn=e=>"function"===typeof e,Cn=e=>"string"===typeof e,jn=e=>null!==e&&"object"===typeof e,Ln=e=>{const t=Object.create(null);return s=>{const o=t[s];return o||(t[s]=e(s))}},Pn=/-(\w)/g,Nn=Ln(e=>e.replace(Pn,(e,t)=>t?t.toUpperCase():"")),Hn=/\B([A-Z])/g,Dn=Ln(e=>e.replace(Hn,"-$1").toLowerCase()),Un=Ln(e=>e.charAt(0).toUpperCase()+e.slice(1)),Fn=e=>{const t=parseFloat(e);return isNaN(t)?e:t},$n="http://www.w3.org/2000/svg",qn="undefined"!==typeof document?document:null,Vn=qn&&qn.createElement("template"),zn={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,o)=>{const a=t?qn.createElementNS($n,e):qn.createElement(e,s?{is:s}:void 0);return"select"===e&&o&&null!=o.multiple&&a.setAttribute("multiple",o.multiple),a},createText:e=>qn.createTextNode(e),createComment:e=>qn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>qn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,s,o,a,n){const r=s?s.previousSibling:t.lastChild;if(a&&(a===n||a.nextSibling)){while(1)if(t.insertBefore(a.cloneNode(!0),s),a===n||!(a=a.nextSibling))break}else{Vn.innerHTML=o?`<svg>${e}</svg>`:e;const a=Vn.content;if(o){const e=a.firstChild;while(e.firstChild)a.appendChild(e.firstChild);a.removeChild(e)}t.insertBefore(a,s)}return[r?r.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function Yn(e,t,s){const o=e._vtc;o&&(t=(t?[t,...o]:[...o]).join(" ")),null==t?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function Xn(e,t,s){const o=e.style,a=Cn(s);if(s&&!a){for(const e in s)Gn(o,e,s[e]);if(t&&!Cn(t))for(const e in t)null==s[e]&&Gn(o,e,"")}else{const n=o.display;a?t!==s&&(o.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(o.display=n)}}const Kn=/\s*!important$/;function Gn(e,t,s){if(On(s))s.forEach(s=>Gn(e,t,s));else if(null==s&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const o=Qn(e,t);Kn.test(s)?e.setProperty(Dn(o),s.replace(Kn,""),"important"):e[o]=s}}const Zn=["Webkit","Moz","ms"],Wn={};function Qn(e,t){const s=Wn[t];if(s)return s;let o=Lt(t);if("filter"!==o&&o in e)return Wn[t]=o;o=Un(o);for(let a=0;a<Zn.length;a++){const s=Zn[a]+o;if(s in e)return Wn[t]=s}return t}const Jn="http://www.w3.org/1999/xlink";function er(e,t,s,o,a){if(o&&t.startsWith("xlink:"))null==s?e.removeAttributeNS(Jn,t.slice(6,t.length)):e.setAttributeNS(Jn,t,s);else{const o=Sn(t);null==s||o&&!Rn(s)?e.removeAttribute(t):e.setAttribute(t,o?"":s)}}function tr(e,t,s,o,a,n,r){if("innerHTML"===t||"textContent"===t)return o&&r(o,a,n),void(e[t]=null==s?"":s);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=s;const o=null==s?"":s;return e.value===o&&"OPTION"!==e.tagName||(e.value=o),void(null==s&&e.removeAttribute(t))}let i=!1;if(""===s||null==s){const o=typeof e[t];"boolean"===o?s=Rn(s):null==s&&"string"===o?(s="",i=!0):"number"===o&&(s=0,i=!0)}try{e[t]=s}catch(l){}i&&e.removeAttribute(t)}const[sr,or]=(()=>{let e=Date.now,t=!1;if("undefined"!==typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const s=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(s&&Number(s[1])<=53)}return[e,t]})();let ar=0;const nr=Promise.resolve(),rr=()=>{ar=0},ir=()=>ar||(nr.then(rr),ar=sr());function lr(e,t,s,o){e.addEventListener(t,s,o)}function cr(e,t,s,o){e.removeEventListener(t,s,o)}function dr(e,t,s,o,a=null){const n=e._vei||(e._vei={}),r=n[t];if(o&&r)r.value=o;else{const[s,i]=mr(t);if(o){const r=n[t]=hr(o,a);lr(e,s,r,i)}else r&&(cr(e,s,r,i),n[t]=void 0)}}const ur=/(?:Once|Passive|Capture)$/;function mr(e){let t;if(ur.test(e)){let s;t={};while(s=e.match(ur))e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[Dn(e.slice(2)),t]}function hr(e,t){const s=e=>{const o=e.timeStamp||sr();(or||o>=s.attached-1)&&Xt(pr(e,s.value),t,5,[e])};return s.value=e,s.attached=ir(),s}function pr(e,t){if(On(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}return t}const fr=/^on[a-z]/,gr=(e,t,s,o,a=!1,n,r,i,l)=>{"class"===t?Yn(e,o,a):"style"===t?Xn(e,s,o):En(t)?Tn(t)||dr(e,t,s,o,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):vr(e,t,o,a))?tr(e,t,o,n,r,i,l):("true-value"===t?e._trueValue=o:"false-value"===t&&(e._falseValue=o),er(e,t,o,a))};function vr(e,t,s,o){return o?"innerHTML"===t||"textContent"===t||!!(t in e&&fr.test(t)&&Bn(s)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!fr.test(t)||!Cn(s))&&t in e))))}function _r(e,t){const s=eo(e);class o extends yr{constructor(e){super(s,e,t)}}return o.def=s,o}const br="undefined"!==typeof HTMLElement?HTMLElement:class{};class yr extends br{constructor(e,t={},s){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,cs(()=>{this._connected||(ai(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);new MutationObserver(e=>{for(const t of e)this._setAttr(t.attributeName)}).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:s}=e,o=!On(t),a=t?o?Object.keys(t):t:[];let n;if(o)for(const r in this._props){const e=t[r];(e===Number||e&&e.type===Number)&&(this._props[r]=Fn(this._props[r]),(n||(n=Object.create(null)))[r]=!0)}this._numberProps=n;for(const r of Object.keys(this))"_"!==r[0]&&this._setProp(r,this[r],!0,!1);for(const r of a.map(Nn))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(e){this._setProp(r,e)}});this._applyStyles(s),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=Fn(t)),this._setProp(Nn(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,s=!0,o=!0){t!==this._props[e]&&(this._props[e]=t,o&&this._instance&&this._update(),s&&(!0===t?this.setAttribute(Dn(e),""):"string"===typeof t||"number"===typeof t?this.setAttribute(Dn(e),t+""):t||this.removeAttribute(Dn(e))))}_update(){ai(this._createVNode(),this.shadowRoot)}_createVNode(){const e=qa(this._def,In({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;while(t=t&&(t.parentNode||t.host))if(t instanceof yr){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach(e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)})}}const xr="transition",wr="animation",kr=(e,{slots:t})=>xn(Xs,Er(e),t);kr.displayName="Transition";const Mr={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Sr=kr.props=In({},Xs.props,Mr),Rr=(e,t=[])=>{On(e)?e.forEach(e=>e(...t)):e&&e(...t)},Ar=e=>!!e&&(On(e)?e.some(e=>e.length>1):e.length>1);function Er(e){const t={};for(const E in e)E in Mr||(t[E]=e[E]);if(!1===e.css)return t;const{name:s="v",type:o,duration:a,enterFromClass:n=s+"-enter-from",enterActiveClass:r=s+"-enter-active",enterToClass:i=s+"-enter-to",appearFromClass:l=n,appearActiveClass:c=r,appearToClass:d=i,leaveFromClass:u=s+"-leave-from",leaveActiveClass:m=s+"-leave-active",leaveToClass:h=s+"-leave-to"}=e,p=Tr(a),f=p&&p[0],g=p&&p[1],{onBeforeEnter:v,onEnter:_,onEnterCancelled:b,onLeave:y,onLeaveCancelled:x,onBeforeAppear:w=v,onAppear:k=_,onAppearCancelled:M=b}=t,S=(e,t,s)=>{Br(e,t?d:i),Br(e,t?c:r),s&&s()},R=(e,t)=>{e._isLeaving=!1,Br(e,u),Br(e,h),Br(e,m),t&&t()},A=e=>(t,s)=>{const a=e?k:_,r=()=>S(t,e,s);Rr(a,[t,r]),Cr(()=>{Br(t,e?l:n),Or(t,e?d:i),Ar(a)||Lr(t,o,f,r)})};return In(t,{onBeforeEnter(e){Rr(v,[e]),Or(e,n),Or(e,r)},onBeforeAppear(e){Rr(w,[e]),Or(e,l),Or(e,c)},onEnter:A(!1),onAppear:A(!0),onLeave(e,t){e._isLeaving=!0;const s=()=>R(e,t);Or(e,u),Dr(),Or(e,m),Cr(()=>{e._isLeaving&&(Br(e,u),Or(e,h),Ar(y)||Lr(e,o,g,s))}),Rr(y,[e,s])},onEnterCancelled(e){S(e,!1),Rr(b,[e])},onAppearCancelled(e){S(e,!0),Rr(M,[e])},onLeaveCancelled(e){R(e),Rr(x,[e])}})}function Tr(e){if(null==e)return null;if(jn(e))return[Ir(e.enter),Ir(e.leave)];{const t=Ir(e);return[t,t]}}function Ir(e){const t=Fn(e);return t}function Or(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e._vtc||(e._vtc=new Set)).add(t)}function Br(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const{_vtc:s}=e;s&&(s.delete(t),s.size||(e._vtc=void 0))}function Cr(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let jr=0;function Lr(e,t,s,o){const a=e._endId=++jr,n=()=>{a===e._endId&&o()};if(s)return setTimeout(n,s);const{type:r,timeout:i,propCount:l}=Pr(e,t);if(!r)return o();const c=r+"end";let d=0;const u=()=>{e.removeEventListener(c,m),n()},m=t=>{t.target===e&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},i+1),e.addEventListener(c,m)}function Pr(e,t){const s=window.getComputedStyle(e),o=e=>(s[e]||"").split(", "),a=o(xr+"Delay"),n=o(xr+"Duration"),r=Nr(a,n),i=o(wr+"Delay"),l=o(wr+"Duration"),c=Nr(i,l);let d=null,u=0,m=0;t===xr?r>0&&(d=xr,u=r,m=n.length):t===wr?c>0&&(d=wr,u=c,m=l.length):(u=Math.max(r,c),d=u>0?r>c?xr:wr:null,m=d?d===xr?n.length:l.length:0);const h=d===xr&&/\b(transform|all)(,|$)/.test(s[xr+"Property"]);return{type:d,timeout:u,propCount:m,hasTransform:h}}function Nr(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map((t,s)=>Hr(t)+Hr(e[s])))}function Hr(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Dr(){return document.body.offsetHeight}const Ur=new WeakMap,Fr=new WeakMap,$r={name:"TransitionGroup",props:In({},Sr,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=an(),o=Vs();let a,n;return ho(()=>{if(!a.length)return;const t=e.moveClass||(e.name||"v")+"-move";if(!Xr(a[0].el,s.vnode.el,t))return;a.forEach(Vr),a.forEach(zr);const o=a.filter(Yr);Dr(),o.forEach(e=>{const s=e.el,o=s.style;Or(s,t),o.transform=o.webkitTransform=o.transitionDuration="";const a=s._moveCb=e=>{e&&e.target!==s||e&&!/transform$/.test(e.propertyName)||(s.removeEventListener("transitionend",a),s._moveCb=null,Br(s,t))};s.addEventListener("transitionend",a)})}),()=>{const r=Ve(e),i=Er(r);let l=r.tag||Ma;a=n,n=t.default?Js(t.default()):[];for(let e=0;e<n.length;e++){const t=n[e];null!=t.key&&Qs(t,Gs(t,i,o,s))}if(a)for(let e=0;e<a.length;e++){const t=a[e];Qs(t,Gs(t,i,o,s)),Ur.set(t,t.el.getBoundingClientRect())}return qa(l,null,n)}}},qr=$r;function Vr(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function zr(e){Fr.set(e,e.el.getBoundingClientRect())}function Yr(e){const t=Ur.get(e),s=Fr.get(e),o=t.left-s.left,a=t.top-s.top;if(o||a){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${o}px,${a}px)`,t.transitionDuration="0s",e}}function Xr(e,t,s){const o=e.cloneNode();e._vtc&&e._vtc.forEach(e=>{e.split(/\s+/).forEach(e=>e&&o.classList.remove(e))}),s.split(/\s+/).forEach(e=>e&&o.classList.add(e)),o.style.display="none";const a=1===t.nodeType?t:t.parentNode;a.appendChild(o);const{hasTransform:n}=Pr(o);return a.removeChild(o),n}const Kr=["ctrl","shift","alt","meta"],Gr={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Kr.some(s=>e[s+"Key"]&&!t.includes(s))},Zr=(e,t)=>(s,...o)=>{for(let e=0;e<t.length;e++){const o=Gr[t[e]];if(o&&o(s,t))return}return e(s,...o)},Wr={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qr=(e,t)=>s=>{if(!("key"in s))return;const o=Dn(s.key);return t.some(e=>e===o||Wr[e]===o)?e(s):void 0},Jr={beforeMount(e,{value:t},{transition:s}){e._vod="none"===e.style.display?"":e.style.display,s&&t?s.beforeEnter(e):ei(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:o}){!t!==!s&&(o?t?(o.beforeEnter(e),ei(e,!0),o.enter(e)):o.leave(e,()=>{ei(e,!1)}):ei(e,t))},beforeUnmount(e,{value:t}){ei(e,t)}};function ei(e,t){e.style.display=t?e._vod:"none"}const ti=In({patchProp:gr},zn);let si;function oi(){return si||(si=_a(ti))}const ai=(...e)=>{oi().render(...e)};var ni=(e,t)=>{const s=e.__vccOpts||e;for(const[o,a]of t)s[o]=a;return s};const ri={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},ii=$a("div",{id:"vac-circle"},null,-1),li=$a("div",{id:"vac-circle"},null,-1),ci=$a("div",{id:"vac-circle"},null,-1),di=$a("div",{id:"vac-circle"},null,-1),ui=$a("div",{id:"vac-circle"},null,-1),mi=$a("div",{id:"vac-circle"},null,-1);function hi(e,t,s,o,a,n){return Ia(),Pa(kr,{name:"vac-fade-spinner",appear:""},{default:As(()=>[s.show?(Ia(),La("div",{key:0,class:it(["vac-loader-wrapper",{"vac-container-center":!s.infinite,"vac-container-top":s.infinite}])},["rooms"===s.type?Bo(e.$slots,"spinner-icon-rooms",{key:0},()=>[ii]):Ka("",!0),"infinite-rooms"===s.type?Bo(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[li]):Ka("",!0),"message-file"===s.type?Bo(e.$slots,"spinner-icon-message-file_"+s.messageId,{key:2},()=>[ci]):Ka("",!0),"room-file"===s.type?Bo(e.$slots,"spinner-icon-room-file",{key:3},()=>[di]):Ka("",!0),"messages"===s.type?Bo(e.$slots,"spinner-icon-messages",{key:4},()=>[ui]):Ka("",!0),"infinite-messages"===s.type?Bo(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[mi]):Ka("",!0)],2)):Ka("",!0)]),_:3})}var pi=ni(ri,[["render",hi]]);const fi={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},gi=["viewBox"],vi=["id","d"],_i=["id","d"];function bi(e,t,s,o,a,n){return Ia(),La("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${n.size} ${n.size}`},[$a("path",{id:n.svgId,d:a.svgItem[s.name].path},null,8,vi),a.svgItem[s.name].path2?(Ia(),La("path",{key:0,id:n.svgId,d:a.svgItem[s.name].path2},null,8,_i)):Ka("",!0)],8,gi)}var yi=ni(fi,[["render",bi]]);const xi={name:"RoomsSearch",components:{SvgIcon:yi},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},wi={key:0,class:"vac-icon-search"},ki=["placeholder"];function Mi(e,t,s,o,a,n){const r=Mo("svg-icon");return Ia(),La("div",{class:it({"vac-box-search":n.showSearchBar,"vac-box-empty":!n.showSearchBar})},[s.showSearch?(Ia(),La(Ma,{key:0},[!s.loadingRooms&&s.rooms.length?(Ia(),La("div",wi,[Bo(e.$slots,"search-icon",{},()=>[qa(r,{name:"search"})])])):Ka("",!0),!s.loadingRooms&&s.rooms.length?(Ia(),La("input",{key:1,type:"search",placeholder:s.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,ki)):Ka("",!0)],64)):Ka("",!0),s.showAddRoom?(Ia(),La("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[Bo(e.$slots,"add-icon",{},()=>[qa(r,{name:"add"})])])):Ka("",!0)],2)}var Si=ni(xi,[["render",Mi]]),Ri={},Ai={};function Ei(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=Object.create(e.prototype);for(var a in s)o[a]=s[a];return o.constructor=t,t.prototype=o,t}Ai.__esModule=!0,Ai.inherits=Ei;var Ti={__esModule:!0},Ii="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi={defaultProtocol:"http",events:null,format:ji,formatHref:ji,nl2br:!1,tagName:"a",target:Li,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};function Bi(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:Oi.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:Oi.events,this.format=e.hasOwnProperty("format")?e.format:Oi.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:Oi.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:Oi.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:Oi.tagName,this.target=e.hasOwnProperty("target")?e.target:Oi.target,this.validate=e.hasOwnProperty("validate")?e.validate:Oi.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||Oi.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||Oi.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:Oi.ignoreTags,s=0;s<t.length;s++)this.ignoreTags.push(t[s].toUpperCase())}function Ci(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return!0;return!1}function ji(e){return e}function Li(e,t){return"url"===t?"_blank":null}Ti.defaults=Oi,Ti.Options=Bi,Ti.contains=Ci,Bi.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,s){var o=void 0,a=this[e];if(!a)return a;switch("undefined"===typeof a?"undefined":Ii(a)){case"function":return a(t,s.type);case"object":return o=a.hasOwnProperty(s.type)?a[s.type]:Oi[e],"function"===typeof o?o(t,s.type):o}return a},getObject:function(e,t,s){var o=this[e];return"function"===typeof o?o(t,s.type):o}};var Pi={},Ni={__esModule:!0};Ni.stateify=Ni.TokenState=Ni.CharacterState=void 0;var Hi=Ai;function Di(){return function(e){this.j=[],this.T=e||null}}var Ui=Di();Ui.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var s=0;s<e.length;s++)this.j.push([e[s],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var s=this.j[t],o=s[0],a=s[1];if(this.test(e,o))return a}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var Fi=(0,Hi.inherits)(Ui,Di(),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),$i=(0,Hi.inherits)(Ui,Di(),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.next(new e(""));return s===this.defaultTransition?(s=new this.constructor(t),this.on(e,s)):t&&(s.T=t),s},test:function(e,t){return e instanceof t}});function qi(e,t,s,o){var a=0,n=e.length,r=t,i=[],l=void 0;while(a<n&&(l=r.next(e[a])))r=l,a++;if(a>=n)return[];while(a<n-1)l=new Fi(o),i.push(l),r.on(e[a],l),r=l,a++;return l=new Fi(s),i.push(l),r.on(e[n-1],l),i}Ni.CharacterState=Fi,Ni.TokenState=$i,Ni.stateify=qi;var Vi={},zi={};function Yi(){return function(e){e&&(this.v=e)}}zi.__esModule=!0,zi.createTokenClass=Yi,Vi.__esModule=!0,Vi.AMPERSAND=Vi.CLOSEPAREN=Vi.CLOSEANGLEBRACKET=Vi.CLOSEBRACKET=Vi.CLOSEBRACE=Vi.OPENPAREN=Vi.OPENANGLEBRACKET=Vi.OPENBRACKET=Vi.OPENBRACE=Vi.WS=Vi.TLD=Vi.SYM=Vi.UNDERSCORE=Vi.SLASH=Vi.MAILTO=Vi.PROTOCOL=Vi.QUERY=Vi.POUND=Vi.PLUS=Vi.NUM=Vi.NL=Vi.LOCALHOST=Vi.PUNCTUATION=Vi.DOT=Vi.COLON=Vi.AT=Vi.DOMAIN=Vi.Base=void 0;var Xi=zi,Ki=Ai,Gi=(0,Xi.createTokenClass)();function Zi(e){var t=e?{v:e}:{};return(0,Ki.inherits)(Gi,(0,Xi.createTokenClass)(),t)}Gi.prototype={toString:function(){return this.v+""}};var Wi=Zi(),Qi=Zi("@"),Ji=Zi(":"),el=Zi("."),tl=Zi(),sl=Zi(),ol=Zi("\n"),al=Zi(),nl=Zi("+"),rl=Zi("#"),il=Zi(),ll=Zi("mailto:"),cl=Zi("?"),dl=Zi("/"),ul=Zi("_"),ml=Zi(),hl=Zi(),pl=Zi(),fl=Zi("{"),gl=Zi("["),vl=Zi("<"),_l=Zi("("),bl=Zi("}"),yl=Zi("]"),xl=Zi(">"),wl=Zi(")"),kl=Zi("&");Vi.Base=Gi,Vi.DOMAIN=Wi,Vi.AT=Qi,Vi.COLON=Ji,Vi.DOT=el,Vi.PUNCTUATION=tl,Vi.LOCALHOST=sl,Vi.NL=ol,Vi.NUM=al,Vi.PLUS=nl,Vi.POUND=rl,Vi.QUERY=cl,Vi.PROTOCOL=il,Vi.MAILTO=ll,Vi.SLASH=dl,Vi.UNDERSCORE=ul,Vi.SYM=ml,Vi.TLD=hl,Vi.WS=pl,Vi.OPENBRACE=fl,Vi.OPENBRACKET=gl,Vi.OPENANGLEBRACKET=vl,Vi.OPENPAREN=_l,Vi.CLOSEBRACE=bl,Vi.CLOSEBRACKET=yl,Vi.CLOSEANGLEBRACKET=xl,Vi.CLOSEPAREN=wl,Vi.AMPERSAND=kl,Pi.__esModule=!0,Pi.start=Pi.run=Pi.TOKENS=Pi.State=void 0;var Ml=Ni,Sl=Vi,Rl=Al(Sl);function Al(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var El="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),Tl="0123456789".split(""),Il="0123456789abcdefghijklmnopqrstuvwxyz".split(""),Ol=[" ","\f","\r","\t","\v"," "," ","᠎"],Bl=[],Cl=function(e){return new Ml.CharacterState(e)},jl=Cl(),Ll=Cl(Sl.NUM),Pl=Cl(Sl.DOMAIN),Nl=Cl(),Hl=Cl(Sl.WS);jl.on("@",Cl(Sl.AT)).on(".",Cl(Sl.DOT)).on("+",Cl(Sl.PLUS)).on("#",Cl(Sl.POUND)).on("?",Cl(Sl.QUERY)).on("/",Cl(Sl.SLASH)).on("_",Cl(Sl.UNDERSCORE)).on(":",Cl(Sl.COLON)).on("{",Cl(Sl.OPENBRACE)).on("[",Cl(Sl.OPENBRACKET)).on("<",Cl(Sl.OPENANGLEBRACKET)).on("(",Cl(Sl.OPENPAREN)).on("}",Cl(Sl.CLOSEBRACE)).on("]",Cl(Sl.CLOSEBRACKET)).on(">",Cl(Sl.CLOSEANGLEBRACKET)).on(")",Cl(Sl.CLOSEPAREN)).on("&",Cl(Sl.AMPERSAND)).on([",",";","!",'"',"'"],Cl(Sl.PUNCTUATION)),jl.on("\n",Cl(Sl.NL)).on(Ol,Hl),Hl.on(Ol,Hl);for(var Dl=0;Dl<El.length;Dl++){var Ul=(0,Ml.stateify)(El[Dl],jl,Sl.TLD,Sl.DOMAIN);Bl.push.apply(Bl,Ul)}var Fl=(0,Ml.stateify)("file",jl,Sl.DOMAIN,Sl.DOMAIN),$l=(0,Ml.stateify)("ftp",jl,Sl.DOMAIN,Sl.DOMAIN),ql=(0,Ml.stateify)("http",jl,Sl.DOMAIN,Sl.DOMAIN),Vl=(0,Ml.stateify)("mailto",jl,Sl.DOMAIN,Sl.DOMAIN);Bl.push.apply(Bl,Fl),Bl.push.apply(Bl,$l),Bl.push.apply(Bl,ql),Bl.push.apply(Bl,Vl);var zl=Fl.pop(),Yl=$l.pop(),Xl=ql.pop(),Kl=Vl.pop(),Gl=Cl(Sl.DOMAIN),Zl=Cl(Sl.PROTOCOL),Wl=Cl(Sl.MAILTO);Yl.on("s",Gl).on(":",Zl),Xl.on("s",Gl).on(":",Zl),Bl.push(Gl),zl.on(":",Zl),Gl.on(":",Zl),Kl.on(":",Wl);var Ql=(0,Ml.stateify)("localhost",jl,Sl.LOCALHOST,Sl.DOMAIN);Bl.push.apply(Bl,Ql),jl.on(Tl,Ll),Ll.on("-",Nl).on(Tl,Ll).on(Il,Pl),Pl.on("-",Nl).on(Il,Pl);for(var Jl=0;Jl<Bl.length;Jl++)Bl[Jl].on("-",Nl).on(Il,Pl);Nl.on("-",Nl).on(Tl,Pl).on(Il,Pl),jl.defaultTransition=Cl(Sl.SYM);var ec=function(e){var t=e.replace(/[A-Z]/g,(function(e){return e.toLowerCase()})),s=e.length,o=[],a=0;while(a<s){var n=jl,r=null,i=0,l=null,c=-1;while(a<s&&(r=n.next(t[a])))n=r,n.accepts()?(c=0,l=n):c>=0&&c++,i++,a++;if(!(c<0)){a-=c,i-=c;var d=l.emit();o.push(new d(e.substr(a-i,i)))}}return o},tc=jl;Pi.State=Ml.CharacterState,Pi.TOKENS=Rl,Pi.run=ec,Pi.start=tc;var sc={},oc={__esModule:!0};oc.URL=oc.TEXT=oc.NL=oc.EMAIL=oc.MAILTOEMAIL=oc.Base=void 0;var ac=zi,nc=Ai,rc=Vi;function ic(e){return e instanceof rc.DOMAIN||e instanceof rc.TLD}var lc=(0,ac.createTokenClass)();lc.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var cc=(0,nc.inherits)(lc,(0,ac.createTokenClass)(),{type:"email",isLink:!0}),dc=(0,nc.inherits)(lc,(0,ac.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),uc=(0,nc.inherits)(lc,(0,ac.createTokenClass)(),{type:"text"}),mc=(0,nc.inherits)(lc,(0,ac.createTokenClass)(),{type:"nl"}),hc=(0,nc.inherits)(lc,(0,ac.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,s=!1,o=this.v,a=[],n=0;while(o[n]instanceof rc.PROTOCOL)t=!0,a.push(o[n].toString().toLowerCase()),n++;while(o[n]instanceof rc.SLASH)s=!0,a.push(o[n].toString()),n++;while(ic(o[n]))a.push(o[n].toString().toLowerCase()),n++;for(;n<o.length;n++)a.push(o[n].toString());return a=a.join(""),t||s||(a=e+"://"+a),a},hasProtocol:function(){return this.v[0]instanceof rc.PROTOCOL}});oc.Base=lc,oc.MAILTOEMAIL=cc,oc.EMAIL=dc,oc.NL=mc,oc.TEXT=uc,oc.URL=hc,sc.__esModule=!0,sc.start=sc.run=sc.TOKENS=sc.State=void 0;var pc=Ni,fc=oc,gc=_c(fc),vc=Vi;function _c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var bc=function(e){return new pc.TokenState(e)},yc=bc(),xc=bc(),wc=bc(),kc=bc(),Mc=bc(),Sc=bc(),Rc=bc(),Ac=bc(fc.URL),Ec=bc(),Tc=bc(fc.URL),Ic=bc(fc.URL),Oc=bc(),Bc=bc(),Cc=bc(),jc=bc(),Lc=bc(),Pc=bc(fc.URL),Nc=bc(fc.URL),Hc=bc(fc.URL),Dc=bc(fc.URL),Uc=bc(),Fc=bc(),$c=bc(),qc=bc(),Vc=bc(),zc=bc(),Yc=bc(fc.EMAIL),Xc=bc(),Kc=bc(fc.EMAIL),Gc=bc(fc.MAILTOEMAIL),Zc=bc(),Wc=bc(),Qc=bc(),Jc=bc(),ed=bc(fc.NL);yc.on(vc.NL,ed).on(vc.PROTOCOL,xc).on(vc.MAILTO,wc).on(vc.SLASH,kc),xc.on(vc.SLASH,kc),kc.on(vc.SLASH,Mc),yc.on(vc.TLD,Sc).on(vc.DOMAIN,Sc).on(vc.LOCALHOST,Ac).on(vc.NUM,Sc),Mc.on(vc.TLD,Ic).on(vc.DOMAIN,Ic).on(vc.NUM,Ic).on(vc.LOCALHOST,Ic),Sc.on(vc.DOT,Rc),Vc.on(vc.DOT,zc),Rc.on(vc.TLD,Ac).on(vc.DOMAIN,Sc).on(vc.NUM,Sc).on(vc.LOCALHOST,Sc),zc.on(vc.TLD,Yc).on(vc.DOMAIN,Vc).on(vc.NUM,Vc).on(vc.LOCALHOST,Vc),Ac.on(vc.DOT,Rc),Yc.on(vc.DOT,zc),Ac.on(vc.COLON,Ec).on(vc.SLASH,Ic),Ec.on(vc.NUM,Tc),Tc.on(vc.SLASH,Ic),Yc.on(vc.COLON,Xc),Xc.on(vc.NUM,Kc);var td=[vc.DOMAIN,vc.AT,vc.LOCALHOST,vc.NUM,vc.PLUS,vc.POUND,vc.PROTOCOL,vc.SLASH,vc.TLD,vc.UNDERSCORE,vc.SYM,vc.AMPERSAND],sd=[vc.COLON,vc.DOT,vc.QUERY,vc.PUNCTUATION,vc.CLOSEBRACE,vc.CLOSEBRACKET,vc.CLOSEANGLEBRACKET,vc.CLOSEPAREN,vc.OPENBRACE,vc.OPENBRACKET,vc.OPENANGLEBRACKET,vc.OPENPAREN];Ic.on(vc.OPENBRACE,Bc).on(vc.OPENBRACKET,Cc).on(vc.OPENANGLEBRACKET,jc).on(vc.OPENPAREN,Lc),Oc.on(vc.OPENBRACE,Bc).on(vc.OPENBRACKET,Cc).on(vc.OPENANGLEBRACKET,jc).on(vc.OPENPAREN,Lc),Bc.on(vc.CLOSEBRACE,Ic),Cc.on(vc.CLOSEBRACKET,Ic),jc.on(vc.CLOSEANGLEBRACKET,Ic),Lc.on(vc.CLOSEPAREN,Ic),Pc.on(vc.CLOSEBRACE,Ic),Nc.on(vc.CLOSEBRACKET,Ic),Hc.on(vc.CLOSEANGLEBRACKET,Ic),Dc.on(vc.CLOSEPAREN,Ic),Uc.on(vc.CLOSEBRACE,Ic),Fc.on(vc.CLOSEBRACKET,Ic),$c.on(vc.CLOSEANGLEBRACKET,Ic),qc.on(vc.CLOSEPAREN,Ic),Bc.on(td,Pc),Cc.on(td,Nc),jc.on(td,Hc),Lc.on(td,Dc),Bc.on(sd,Uc),Cc.on(sd,Fc),jc.on(sd,$c),Lc.on(sd,qc),Pc.on(td,Pc),Nc.on(td,Nc),Hc.on(td,Hc),Dc.on(td,Dc),Pc.on(sd,Pc),Nc.on(sd,Nc),Hc.on(sd,Hc),Dc.on(sd,Dc),Uc.on(td,Pc),Fc.on(td,Nc),$c.on(td,Hc),qc.on(td,Dc),Uc.on(sd,Uc),Fc.on(sd,Fc),$c.on(sd,$c),qc.on(sd,qc),Ic.on(td,Ic),Oc.on(td,Ic),Ic.on(sd,Oc),Oc.on(sd,Oc),wc.on(vc.TLD,Gc).on(vc.DOMAIN,Gc).on(vc.NUM,Gc).on(vc.LOCALHOST,Gc),Gc.on(td,Gc).on(sd,Zc),Zc.on(td,Gc).on(sd,Zc);var od=[vc.DOMAIN,vc.NUM,vc.PLUS,vc.POUND,vc.QUERY,vc.UNDERSCORE,vc.SYM,vc.AMPERSAND,vc.TLD];Sc.on(od,Wc).on(vc.AT,Qc),Ac.on(od,Wc).on(vc.AT,Qc),Rc.on(od,Wc),Wc.on(od,Wc).on(vc.AT,Qc).on(vc.DOT,Jc),Jc.on(od,Wc),Qc.on(vc.TLD,Vc).on(vc.DOMAIN,Vc).on(vc.LOCALHOST,Yc);var ad=function(e){var t=e.length,s=0,o=[],a=[];while(s<t){var n=yc,r=null,i=null,l=0,c=null,d=-1;while(s<t&&!(r=n.next(e[s])))a.push(e[s++]);while(s<t&&(i=r||n.next(e[s])))r=null,n=i,n.accepts()?(d=0,c=n):d>=0&&d++,s++,l++;if(d<0)for(var u=s-l;u<s;u++)a.push(e[u]);else{a.length>0&&(o.push(new fc.TEXT(a)),a=[]),s-=d,l-=d;var m=c.emit();o.push(new m(e.slice(s-l,s)))}}return a.length>0&&o.push(new fc.TEXT(a)),o};sc.State=pc.TokenState,sc.TOKENS=gc,sc.run=ad,sc.start=yc,Ri.__esModule=!0,Ri.tokenize=Ri.test=Ri.scanner=Ri.parser=Ri.options=Ri.inherits=Ri.find=void 0;var nd=Ai,rd=Ti,id=md(rd),ld=Pi,cd=md(ld),dd=sc,ud=md(dd);function md(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var hd=function(e){return ud.run(cd.run(e))},pd=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=hd(e),o=[],a=0;a<s.length;a++){var n=s[a];!n.isLink||t&&n.type!==t||o.push(n.toObject())}return o},fd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=hd(e);return 1===s.length&&s[0].isLink&&(!t||s[0].type===t)};Ri.find=pd,Ri.inherits=nd.inherits,Ri.options=id,Ri.parser=ud,Ri.scanner=cd,Ri.test=fd,Ri.tokenize=hd;var gd=Ri,vd=(e,t,s)=>{const o={bold:s.bold,italic:s.italic,strike:s.strike,underline:s.underline,multilineCode:s.multilineCode,inlineCode:s.inlineCode},a={[o.bold]:{end:"\\"+o.bold,allowed_chars:".",type:"bold"},[o.italic]:{end:o.italic,allowed_chars:".",type:"italic"},[o.strike]:{end:o.strike,allowed_chars:".",type:"strike"},[o.underline]:{end:o.underline,allowed_chars:".",type:"underline"},[o.multilineCode]:{end:o.multilineCode,allowed_chars:"(.|\n)",type:"multiline-code"},[o.inlineCode]:{end:o.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},n=_d(e,a),r=bd(n,a),i=[].concat.apply([],r);return t&&kd(i),i};function _d(e,t){let s=[],o=-1,a=null,n=gd.find(e),r=!1;if(n.length>0&&(o=e.indexOf(n[0].value),r=!0),Object.keys(t).forEach(t=>{const s=e.indexOf(t);s>=0&&(o<0||s<o)&&(o=s,a=t,r=!1)}),r&&-1!==a){let a=e.substr(0,o),r=e.substr(o,n[0].value.length),i=e.substr(o+n[0].value.length);return s.push(a),s.push(r),s=s.concat(_d(i,t)),s}if(a){let n=e.substr(0,o);const r=a;let i=e.substr(o+r.length);if(e.replace(/\s/g,"").length===2*r.length)return[e];const l=i.match(new RegExp("^("+(t[r].allowed_chars||".")+"*"+(t[r].end?"?":"")+")"+(t[r].end?"("+t[r].end+")":""),"m"));if(l&&l[1]){n&&s.push(n);const e={start:r,content:_d(l[1],t),end:l[2],type:t[r].type};s.push(e),i=i.substr(l[0].length)}else n+=r,s.push(n);return s=s.concat(_d(i,t)),s}return e?[e]:[]}function bd(e,t){const s=[];return e.forEach(e=>{"string"===typeof e?s.push({types:[],value:e}):t[e.start]&&s.push(yd(e))}),s}function yd(e){const t=[];return xd(e,t,[]),t}function xd(e,t,s){e.content.forEach(o=>{"string"===typeof o?t.push({types:wd(s.concat([e.type])),value:o}):xd(o,t,wd([o.type].concat([e.type]).concat(s)))})}function wd(e){return[...new Set(e)]}function kd(e){const t=[];return e.forEach(e=>{const s=gd.find(e.value);if(s.length){const o=e.value.replace(s[0].value,"");t.push({types:e.types,value:o}),e.types=["url"].concat(e.types),e.href=s[0].href,e.value=s[0].value}t.push(e)}),t}const Md=["png","jpg","jpeg","webp","svg","gif"],Sd=["mp4","video/ogg","webm","quicktime"],Rd=["mp3","audio/ogg","wav","mpeg"],Ad={name:"FormatMessage",components:{SvgIcon:yi},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=vd(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach(e=>{e.url=this.checkType(e,"url"),e.bold=this.checkType(e,"bold"),e.italic=this.checkType(e,"italic"),e.strike=this.checkType(e,"strike"),e.underline=this.checkType(e,"underline"),e.inline=this.checkType(e,"inline-code"),e.multiline=this.checkType(e,"multiline-code"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e),e.value=this.replaceEmojiByElement(e.value)}),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType(e,t){return e.types&&-1!==e.types.indexOf(t)},checkImageType(e){let t=e.value.lastIndexOf(".");const s=e.value.lastIndexOf("/");s>t&&(t=-1);const o=e.value.substring(t+1,e.value.length),a=t>0&&Md.some(e=>o.toLowerCase().includes(e));return a&&this.setImageSize(e),a},setImageSize(e){const t=new Image;function s(o){const a=o.path[0].width/150;e.height=Math.round(o.path[0].height/a)+"px",t.removeEventListener("load",s)}t.src=e.value,t.addEventListener("load",s)},formatTags(e){const t="<usertag>",s="</usertag>",o=[...e.matchAll(new RegExp(t,"gi"))].map(e=>e.index),a=e;return o.forEach(o=>{const n=a.substring(o+t.length,a.indexOf(s,o)),r=this.users.find(e=>e._id===n);e=e.replaceAll(n,"@"+((null==r?void 0:r.username)||"unknown"))}),e},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find(t=>-1!==e.value.indexOf(t.username));this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;if(this.singleLine)t=16;else{const e=this.containsOnlyEmojis();t=e?28:20}return e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,e=>`<span style="font-size: ${t}px">${e}</span>`)},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-ữf]","g"),""),t=this.content.replace(new RegExp("[\n\rs]+|( )+","g"),"");return e.length===t.length}}},Ed={class:"vac-image-link-container"},Td={class:"vac-image-link-message"},Id=["innerHTML"],Od=["innerHTML"];function Bd(e,t,s,o,a,n){const r=Mo("svg-icon");return Ia(),La("div",{class:it(["vac-format-message-wrapper",{"vac-text-ellipsis":s.singleLine}])},[s.textFormatting.disabled?(Ia(),La("div",{key:1,innerHTML:n.formattedContent},null,8,Od)):(Ia(),La("div",{key:0,class:it({"vac-text-ellipsis":s.singleLine})},[(Ia(!0),La(Ma,null,Io(n.linkifiedMessage,(t,o)=>(Ia(),La("div",{key:o,class:"vac-format-container"},[(Ia(),Pa(Ro(t.url?"a":"span"),{class:it({"vac-text-ellipsis":s.singleLine,"vac-text-bold":t.bold,"vac-text-italic":s.deleted||t.italic,"vac-text-strike":t.strike,"vac-text-underline":t.underline,"vac-text-inline-code":!s.singleLine&&t.inline,"vac-text-multiline-code":!s.singleLine&&t.multiline,"vac-text-tag":!s.singleLine&&!s.reply&&t.tag}),href:t.href,target:t.href?s.linkOptions.target:null,rel:t.href?s.linkOptions.rel:null,onClick:e=>n.openTag(t)},{default:As(()=>[s.deleted?(Ia(),La(Ma,{key:0},[Bo(e.$slots,s.roomList?"deleted-icon-room_"+s.roomId:"deleted-icon_"+s.messageId,{},()=>[qa(r,{name:"deleted",class:it(["vac-icon-deleted",{"vac-icon-deleted-room":s.roomList}])},null,8,["class"])]),Xa(" "+ct(s.textMessages.MESSAGE_DELETED),1)],64)):t.url&&t.image?(Ia(),La(Ma,{key:1},[$a("div",Ed,[$a("div",{class:"vac-image-link",style:ot({"background-image":`url('${t.value}')`,height:t.height})},null,4)]),$a("div",Td,[$a("span",null,ct(t.value),1)])],64)):(Ia(),La("span",{key:2,innerHTML:t.value},null,8,Id))]),_:2},1032,["class","href","target","rel","onClick"]))]))),128))],2))],2)}var Cd=ni(Ad,[["render",Bd]]);const jd="__v-click-outside",Ld="undefined"!==typeof window,Pd="undefined"!==typeof navigator,Nd=Ld&&("ontouchstart"in window||Pd&&navigator.msMaxTouchPoints>0),Hd=Nd?["touchstart"]:["click"],Dd=e=>{const t="function"===typeof e;if(!t&&"object"!==typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||Hd,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}},Ud=({event:e,handler:t,middleware:s})=>{s(e)&&t(e)},Fd=({el:e,event:t,handler:s,middleware:o})=>{setTimeout(()=>{const{activeElement:a}=document;a&&"IFRAME"===a.tagName&&!e.contains(a)&&Ud({event:t,handler:s,middleware:o})},0)},$d=({el:e,event:t,handler:s,middleware:o})=>{const a=t.path||t.composedPath&&t.composedPath(),n=a?a.indexOf(e)<0:!e.contains(t.target);n&&Ud({event:t,handler:s,middleware:o})},qd=(e,{value:t})=>{const{events:s,handler:o,middleware:a,isActive:n,detectIframe:r,capture:i}=Dd(t);if(n){if(e[jd]=s.map(t=>({event:t,srcTarget:document.documentElement,handler:t=>$d({el:e,event:t,handler:o,middleware:a}),capture:i})),r){const t={event:"blur",srcTarget:window,handler:t=>Fd({el:e,event:t,handler:o,middleware:a}),capture:i};e[jd]=[...e[jd],t]}e[jd].forEach(({event:t,srcTarget:s,handler:o})=>setTimeout(()=>{e[jd]&&s.addEventListener(t,o,i)},0))}},Vd=e=>{const t=e[jd]||[];t.forEach(({event:e,srcTarget:t,handler:s,capture:o})=>t.removeEventListener(e,s,o)),delete e[jd]},zd=(e,{value:t,oldValue:s})=>{JSON.stringify(t)!==JSON.stringify(s)&&(Vd(e),qd(e,{value:t}))},Yd={beforeMount:qd,updated:zd,unmounted:Vd};var Xd=Ld?Yd:{},Kd=(e,t,s)=>{if(e.typingUsers&&e.typingUsers.length){const o=e.users.filter(s=>{if(s._id!==t&&-1!==e.typingUsers.indexOf(s._id)&&(!s.status||"offline"!==s.status.state))return!0});if(!o.length)return;return 2===e.users.length?s.IS_TYPING:o.map(e=>e.username).join(", ")+" "+s.IS_TYPING}};function Gd(e,t){if(t&&t.type)return e.some(e=>t.type.toLowerCase().includes(e))}function Zd(e){return Gd(Md,e)}function Wd(e){return Gd(Sd,e)}function Qd(e){return Gd(Md,e)||Gd(Sd,e)}function Jd(e){return Gd(Rd,e)}const eu={name:"RoomsContent",components:{SvgIcon:yi,FormatMessage:Cd},directives:{clickOutside:Xd},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const s=this.room.users.find(e=>e._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:s&&s._id!==this.currentUserId?`${s.username} - ${t}`:t},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return Kd(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const s=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(s){if(!s.duration)return`${s.name}.${s.extension}`;let e=Math.floor(s.duration);return(e-(e%=60))/60+(e>9?":":":0")+e}return""},isAudio(){return!!this.room.lastMessage.files&&Jd(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},tu={class:"vac-room-container"},su={class:"vac-name-container vac-text-ellipsis"},ou={class:"vac-title-container"},au={class:"vac-room-name vac-text-ellipsis"},nu={key:1,class:"vac-text-date"},ru={key:0},iu={key:1,class:"vac-text-ellipsis"},lu={key:3,class:"vac-text-ellipsis"},cu={class:"vac-room-options-container"},du={key:0,class:"vac-badge-counter vac-room-badge"},uu={key:0,class:"vac-menu-options"},mu={class:"vac-menu-list"},hu=["onClick"];function pu(e,t,s,o,a,n){const r=Mo("svg-icon"),i=Mo("format-message"),l=Ao("click-outside");return Ia(),La("div",tu,[Bo(e.$slots,"room-list-item_"+s.room.roomId,{},()=>[Bo(e.$slots,"room-list-avatar_"+s.room.roomId,{},()=>[s.room.avatar?(Ia(),La("div",{key:0,class:"vac-avatar",style:ot({"background-image":`url('${s.room.avatar}')`})},null,4)):Ka("",!0)]),$a("div",su,[$a("div",ou,[n.userStatus?(Ia(),La("div",{key:0,class:it(["vac-state-circle",{"vac-state-online":"online"===n.userStatus}])},null,2)):Ka("",!0),$a("div",au,ct(s.room.roomName),1),s.room.lastMessage?(Ia(),La("div",nu,ct(s.room.lastMessage.timestamp),1)):Ka("",!0)]),$a("div",{class:it(["vac-text-last",{"vac-message-new":s.room.lastMessage&&s.room.lastMessage.new&&!n.typingUsers}])},[n.isMessageCheckmarkVisible?(Ia(),La("span",ru,[Bo(e.$slots,"checkmark-icon_"+s.room.roomId,{},()=>[qa(r,{name:s.room.lastMessage.distributed?"double-checkmark":"checkmark",param:s.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ka("",!0),s.room.lastMessage&&!s.room.lastMessage.deleted&&n.isAudio?(Ia(),La("div",iu,[Bo(e.$slots,"microphone-icon_"+s.room.roomId,{},()=>[qa(r,{name:"microphone",class:"vac-icon-microphone"})]),Xa(" "+ct(n.formattedDuration),1)])):s.room.lastMessage?(Ia(),Pa(i,{key:2,"message-id":s.room.lastMessage._id,"room-id":s.room.roomId,"room-list":!0,content:n.getLastMessage,deleted:!!s.room.lastMessage.deleted&&!n.typingUsers,users:s.room.users,"text-messages":s.textMessages,linkify:!1,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"single-line":!0},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Ka("",!0),!s.room.lastMessage&&n.typingUsers?(Ia(),La("div",lu,ct(n.typingUsers),1)):Ka("",!0),$a("div",cu,[s.room.unreadCount?(Ia(),La("div",du,ct(s.room.unreadCount),1)):Ka("",!0),Bo(e.$slots,"room-list-options_"+s.room.roomId,{},()=>[s.roomActions.length?(Ia(),La("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Zr(e=>a.roomMenuOpened=s.room.roomId,["stop"]))},[Bo(e.$slots,"room-list-options-icon_"+s.room.roomId,{},()=>[qa(r,{name:"dropdown",param:"room"})])])):Ka("",!0),s.roomActions.length?(Ia(),Pa(kr,{key:1,name:"vac-slide-left"},{default:As(()=>[a.roomMenuOpened===s.room.roomId?yo((Ia(),La("div",uu,[$a("div",mu,[(Ia(!0),La(Ma,null,Io(s.roomActions,e=>(Ia(),La("div",{key:e.name},[$a("div",{class:"vac-menu-item",onClick:Zr(t=>n.roomActionHandler(e),["stop"])},ct(e.title),9,hu)]))),128))])])),[[l,n.closeRoomMenu]]):Ka("",!0)]),_:1})):Ka("",!0)])])],2)])])])}var fu=ni(eu,[["render",pu]]),gu=(e,t,s,o=!1)=>s&&""!==s?e.filter(e=>o?vu(e[t]).startsWith(vu(s)):vu(e[t]).includes(vu(s))):e;function vu(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const _u={name:"RoomsList",components:{Loader:pi,RoomsSearch:Si,RoomContent:fu},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=gu(this.rooms,"roomName",e.target.value)},openRoom(e){(e.roomId!==this.room.roomId||this.isMobile)&&(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},bu={key:0,class:"vac-rooms-empty"},yu={key:1,id:"rooms-list",class:"vac-room-list"},xu=["id","onClick"],wu={key:0,id:"infinite-loader-rooms"};function ku(e,t,s,o,a,n){const r=Mo("rooms-search"),i=Mo("loader"),l=Mo("room-content");return yo((Ia(),La("div",{class:it(["vac-rooms-container",{"vac-rooms-container-full":s.isMobile,"vac-app-border-r":!s.isMobile}])},[Bo(e.$slots,"rooms-header"),Bo(e.$slots,"rooms-list-search",{},()=>[qa(r,{rooms:s.rooms,"loading-rooms":s.loadingRooms,"text-messages":s.textMessages,"show-search":s.showSearch,"show-add-room":s.showAddRoom,onSearchRoom:n.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),qa(i,{show:s.loadingRooms,type:"rooms"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["show"]),s.loadingRooms||s.rooms.length?Ka("",!0):(Ia(),La("div",bu,[Bo(e.$slots,"rooms-empty",{},()=>[Xa(ct(s.textMessages.ROOMS_EMPTY),1)])])),s.loadingRooms?Ka("",!0):(Ia(),La("div",yu,[(Ia(!0),La(Ma,null,Io(a.filteredRooms,o=>(Ia(),La("div",{id:o.roomId,key:o.roomId,class:it(["vac-room-item",{"vac-room-selected":a.selectedRoomId===o.roomId}]),onClick:e=>n.openRoom(o)},[qa(l,{"current-user-id":s.currentUserId,room:o,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"text-messages":s.textMessages,"room-actions":s.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,xu))),128)),qa(kr,{name:"vac-fade-message"},{default:As(()=>[s.rooms.length&&!s.loadingRooms?(Ia(),La("div",wu,[qa(i,{show:a.showLoader,infinite:!0,type:"infinite-rooms"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["show"])])):Ka("",!0)]),_:3})]))],2)),[[Jr,s.showRoomsList]])}var Mu=ni(_u,[["render",ku]]);const Su={name:"RoomHeader",components:{SvgIcon:yi},directives:{clickOutside:Xd},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return Kd(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);if(!(null==e?void 0:e.status))return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Ru={class:"vac-room-header vac-app-border-b"},Au={class:"vac-room-wrapper"},Eu={key:0,class:"vac-room-selection"},Tu=["id"],Iu=["onClick"],Ou={class:"vac-selection-button-count"},Bu={class:"vac-text-ellipsis"},Cu={class:"vac-room-name vac-text-ellipsis"},ju={key:0,class:"vac-room-info vac-text-ellipsis"},Lu={key:1,class:"vac-room-info vac-text-ellipsis"},Pu={key:0,class:"vac-menu-options"},Nu={class:"vac-menu-list"},Hu=["onClick"];function Du(e,t,s,o,a,n){const r=Mo("svg-icon"),i=Ao("click-outside");return Ia(),La("div",Ru,[Bo(e.$slots,"room-header",{},()=>[$a("div",Au,[qa(kr,{name:"vac-slide-up"},{default:As(()=>[s.messageSelectionEnabled?(Ia(),La("div",Eu,[(Ia(!0),La(Ma,null,Io(s.messageSelectionActions,e=>(Ia(),La("div",{id:e.name,key:e.name},[$a("div",{class:"vac-selection-button",onClick:t=>n.messageSelectionActionHandler(e)},[Xa(ct(e.title)+" ",1),$a("span",Ou,ct(s.selectedMessagesTotal),1)],8,Iu)],8,Tu))),128)),$a("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},ct(s.textMessages.CANCEL_SELECT_MESSAGE),1)])):Ka("",!0)]),_:1}),!s.messageSelectionEnabled&&a.messageSelectionAnimationEnded?(Ia(),La(Ma,{key:0},[s.singleRoom?Ka("",!0):(Ia(),La("div",{key:0,class:it(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!s.isMobile,"vac-rotate-icon":!s.showRoomsList&&!s.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[Bo(e.$slots,"toggle-icon",{},()=>[qa(r,{name:"toggle"})])],2)),$a("div",{class:it(["vac-info-wrapper",{"vac-item-clickable":s.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[Bo(e.$slots,"room-header-avatar",{},()=>[s.room.avatar?(Ia(),La("div",{key:0,class:"vac-avatar",style:ot({"background-image":`url('${s.room.avatar}')`})},null,4)):Ka("",!0)]),Bo(e.$slots,"room-header-info",{},()=>[$a("div",Bu,[$a("div",Cu,ct(s.room.roomName),1),n.typingUsers?(Ia(),La("div",ju,ct(n.typingUsers),1)):(Ia(),La("div",Lu,ct(n.userStatus),1))])])],2),s.room.roomId?Bo(e.$slots,"room-options",{key:1},()=>[s.menuActions.length?(Ia(),La("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>a.menuOpened=!a.menuOpened)},[Bo(e.$slots,"menu-icon",{},()=>[qa(r,{name:"menu"})])])):Ka("",!0),s.menuActions.length?(Ia(),Pa(kr,{key:1,name:"vac-slide-left"},{default:As(()=>[a.menuOpened?yo((Ia(),La("div",Pu,[$a("div",Nu,[(Ia(!0),La(Ma,null,Io(s.menuActions,e=>(Ia(),La("div",{key:e.name},[$a("div",{class:"vac-menu-item",onClick:t=>n.menuActionHandler(e)},ct(e.title),9,Hu)]))),128))])])),[[i,n.closeMenu]]):Ka("",!0)]),_:1})):Ka("",!0)]):Ka("",!0)],64)):Ka("",!0)])])])}var Uu=ni(Su,[["render",Du]]);function Fu(e){if("string"!==typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function $u(e){if("number"!==typeof e)throw new Error("expected a number, got: "+e)}const qu=1,Vu=1,zu="emoji",Yu="keyvalue",Xu="favorites",Ku="tokens",Gu="tokens",Zu="unicode",Wu="count",Qu="group",Ju="order",em="group-order",tm="eTag",sm="url",om="skinTone",am="readonly",nm="readwrite",rm="skinUnicodes",im="skinUnicodes",lm="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",cm="en";function dm(e,t){const s=new Set,o=[];for(const a of e){const e=t(a);s.has(e)||(s.add(e),o.push(a))}return o}function um(e){return dm(e,e=>e.unicode)}function mm(e){function t(t,s,o){const a=s?e.createObjectStore(t,{keyPath:s}):e.createObjectStore(t);if(o)for(const[e,[n,r]]of Object.entries(o))a.createIndex(e,n,{multiEntry:r});return a}t(Yu),t(zu,Zu,{[Gu]:[Ku,!0],[em]:[[Qu,Ju]],[rm]:[im,!0]}),t(Xu,void 0,{[Wu]:[""]})}const hm={},pm={},fm={};function gm(e,t,s){s.onerror=()=>t(s.error),s.onblocked=()=>t(new Error("IDB blocked")),s.onsuccess=()=>e(s.result)}async function vm(e){const t=await new Promise((t,s)=>{const o=indexedDB.open(e,qu);hm[e]=o,o.onupgradeneeded=e=>{e.oldVersion<Vu&&mm(o.result)},gm(t,s,o)});return t.onclose=()=>ym(e),t}function _m(e){return pm[e]||(pm[e]=vm(e)),pm[e]}function bm(e,t,s,o){return new Promise((a,n)=>{const r=e.transaction(t,s,{durability:"relaxed"}),i="string"===typeof t?r.objectStore(t):t.map(e=>r.objectStore(e));let l;o(i,r,e=>{l=e}),r.oncomplete=()=>a(l),r.onerror=()=>n(r.error)})}function ym(e){const t=hm[e],s=t&&t.result;if(s){s.close();const t=fm[e];if(t)for(const e of t)e()}delete hm[e],delete pm[e],delete fm[e]}function xm(e){return new Promise((t,s)=>{ym(e);const o=indexedDB.deleteDatabase(e);gm(t,s,o)})}function wm(e,t){let s=fm[e];s||(s=fm[e]=[]),s.push(t)}const km=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Mm(e){return e.split(/[\s_]+/).map(e=>!e.match(/\w/)||km.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const Sm=2;function Rm(e){return e.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=Sm)}function Am(e){const t=e.map(({annotation:e,emoticon:t,group:s,order:o,shortcodes:a,skins:n,tags:r,emoji:i,version:l})=>{const c=[...new Set(Rm([...(a||[]).map(Mm).flat(),...r.map(Mm).flat(),...Mm(e),t]))].sort(),d={annotation:e,group:s,order:o,tags:r,tokens:c,unicode:i,version:l};if(t&&(d.emoticon=t),a&&(d.shortcodes=a),n){d.skinTones=[],d.skinUnicodes=[],d.skinVersions=[];for(const{tone:e,emoji:t,version:s}of n)d.skinTones.push(e),d.skinUnicodes.push(t),d.skinVersions.push(s)}return d});return t}function Em(e,t,s,o){e[t](s).onsuccess=e=>o&&o(e.target.result)}function Tm(e,t,s){Em(e,"get",t,s)}function Im(e,t,s){Em(e,"getAll",t,s)}function Om(e){e.commit&&e.commit()}function Bm(e,t){let s=e[0];for(let o=1;o<e.length;o++){const a=e[o];t(s)>t(a)&&(s=a)}return s}function Cm(e,t){const s=Bm(e,e=>e.length),o=[];for(const a of s)e.some(e=>-1===e.findIndex(e=>t(e)===t(a)))||o.push(a);return o}async function jm(e){return!await $m(e,Yu,sm)}async function Lm(e,t,s){const[o,a]=await Promise.all([tm,sm].map(t=>$m(e,Yu,t)));return o===s&&a===t}async function Pm(e,t){const s=50;return bm(e,zu,am,(e,o,a)=>{let n;const r=()=>{e.getAll(n&&IDBKeyRange.lowerBound(n,!0),s).onsuccess=e=>{const o=e.target.result;for(const s of o)if(n=s.unicode,t(s))return a(s);if(o.length<s)return a();r()}};r()})}async function Nm(e,t,s,o){try{const a=Am(t);await bm(e,[zu,Yu],nm,([e,t],n)=>{let r,i,l=0;function c(){2===++l&&d()}function d(){if(r!==o||i!==s){e.clear();for(const t of a)e.put(t);t.put(o,tm),t.put(s,sm),Om(n)}}Tm(t,tm,e=>{r=e,c()}),Tm(t,sm,e=>{i=e,c()})})}finally{}}async function Hm(e,t){return bm(e,zu,am,(e,s,o)=>{const a=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Im(e.index(em),a,o)})}async function Dm(e,t){const s=Rm(Mm(t));return s.length?bm(e,zu,am,(e,t,o)=>{const a=[],n=()=>{a.length===s.length&&r()},r=()=>{const e=Cm(a,e=>e.unicode);o(e.sort((e,t)=>e.order<t.order?-1:1))};for(let i=0;i<s.length;i++){const t=s[i],o=i===s.length-1?IDBKeyRange.bound(t,t+"￿",!1,!0):IDBKeyRange.only(t);Im(e.index(Gu),o,e=>{a.push(e),n()})}}):[]}async function Um(e,t){const s=await Dm(e,t);if(!s.length){const s=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await Pm(e,s)||null}return s.filter(e=>{const s=(e.shortcodes||[]).map(e=>e.toLowerCase());return s.includes(t.toLowerCase())})[0]||null}async function Fm(e,t){return bm(e,zu,am,(e,s,o)=>Tm(e,t,s=>{if(s)return o(s);Tm(e.index(rm),t,e=>o(e||null))}))}function $m(e,t,s){return bm(e,t,am,(e,t,o)=>Tm(e,s,o))}function qm(e,t,s,o){return bm(e,t,nm,(e,t)=>{e.put(o,s),Om(t)})}function Vm(e,t){return bm(e,Xu,nm,(e,s)=>Tm(e,t,o=>{e.put((o||0)+1,t),Om(s)}))}function zm(e,t,s){return 0===s?[]:bm(e,[Xu,zu],am,([e,o],a,n)=>{const r=[];e.index(Wu).openCursor(void 0,"prev").onsuccess=e=>{const a=e.target.result;if(!a)return n(r);function i(e){if(r.push(e),r.length===s)return n(r);a.continue()}const l=a.primaryKey,c=t.byName(l);if(c)return i(c);Tm(o,l,e=>{if(e)return i(e);a.continue()})}})}const Ym="";function Xm(e,t){const s=new Map;for(const a of e){const e=t(a);for(const t of e){let e=s;for(let s=0;s<t.length;s++){const o=t.charAt(s);let a=e.get(o);a||(a=new Map,e.set(o,a)),e=a}let o=e.get(Ym);o||(o=[],e.set(Ym,o)),o.push(a)}}const o=(e,t)=>{let o=s;for(let s=0;s<e.length;s++){const t=e.charAt(s),a=o.get(t);if(!a)return[];o=a}if(t){const e=o.get(Ym);return e||[]}const a=[],n=[o];while(n.length){const e=n.shift(),t=[...e.entries()].sort((e,t)=>e[0]<t[0]?-1:1);for(const[s,o]of t)s===Ym?a.push(...o):n.push(o)}return a};return o}const Km=["name","url"];function Gm(e){const t=e&&Array.isArray(e),s=t&&e.length&&(!e[0]||Km.some(t=>!(t in e[0])));if(!t||s)throw new Error("Custom emojis are in the wrong format")}function Zm(e){Gm(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,s=e.sort(t),o=e=>[...new Set((e.shortcodes||[]).map(e=>Mm(e)).flat())],a=Xm(e,o),n=e=>a(e,!0),r=e=>a(e,!1),i=e=>{const s=Mm(e),o=s.map((e,t)=>(t<s.length-1?n:r)(e));return Cm(o,e=>e.name).sort(t)},l=new Map,c=new Map;for(const m of e){c.set(m.name.toLowerCase(),m);for(const e of m.shortcodes||[])l.set(e.toLowerCase(),m)}const d=e=>l.get(e.toLowerCase()),u=e=>c.get(e.toLowerCase());return{all:s,search:i,byShortcode:d,byName:u}}function Wm(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let s=0;s<t;s++)e.skins[s]={tone:e.skinTones[s],unicode:e.skinUnicodes[s],version:e.skinVersions[s]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Qm(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Jm=["annotation","emoji","group","order","tags","version"];function eh(e){if(!e||!Array.isArray(e)||!e[0]||"object"!==typeof e[0]||Jm.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function th(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function sh(e){const t=await fetch(e,{method:"HEAD"});th(t,e);const s=t.headers.get("etag");return Qm(s),s}async function oh(e){const t=await fetch(e);th(t,e);const s=t.headers.get("etag");Qm(s);const o=await t.json();return eh(o),[s,o]}function ah(e){var t="",s=new Uint8Array(e),o=s.byteLength,a=-1;while(++a<o)t+=String.fromCharCode(s[a]);return t}function nh(e){var t=e.length,s=new ArrayBuffer(t),o=new Uint8Array(s),a=-1;while(++a<t)o[a]=e.charCodeAt(a);return s}async function rh(e){const t=JSON.stringify(e),s=nh(t),o=await crypto.subtle.digest("SHA-1",s),a=ah(o),n=btoa(a);return n}async function ih(e,t){let s,o=await sh(t);if(!o){const e=await oh(t);o=e[0],s=e[1],o||(o=await rh(s))}if(await Lm(e,t,o));else{if(!s){const e=await oh(t);s=e[1]}await Nm(e,s,t,o)}}async function lh(e,t){let[s,o]=await oh(t);s||(s=await rh(o)),await Nm(e,o,t,s)}class ch{constructor({dataSource:e=lm,locale:t=cm,customEmoji:s=[]}={}){this.dataSource=e,this.locale=t,this._dbName="emoji-picker-element-"+this.locale,this._db=void 0,this._lazyUpdate=void 0,this._custom=Zm(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await _m(this._dbName);wm(this._dbName,this._clear);const t=this.dataSource,s=await jm(e);s?await lh(e,t):this._lazyUpdate=ih(e,t)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return $u(e),await this.ready(),um(await Hm(this._db,e)).map(Wm)}async getEmojiBySearchQuery(e){Fu(e),await this.ready();const t=this._custom.search(e),s=um(await Dm(this._db,e)).map(Wm);return[...t,...s]}async getEmojiByShortcode(e){Fu(e),await this.ready();const t=this._custom.byShortcode(e);return t||Wm(await Um(this._db,e))}async getEmojiByUnicodeOrName(e){Fu(e),await this.ready();const t=this._custom.byName(e);return t||Wm(await Fm(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await $m(this._db,Yu,om)||0}async setPreferredSkinTone(e){return $u(e),await this.ready(),qm(this._db,Yu,om,e)}async incrementFavoriteEmojiCount(e){return Fu(e),await this.ready(),Vm(this._db,e)}async getTopFavoriteEmoji(e){return $u(e),await this.ready(),(await zm(this._db,this._custom,e)).map(Wm)}set customEmoji(e){this._custom=Zm(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await ym(this._dbName)}async delete(){await this._shutdown(),await xm(this._dbName)}}function dh(){}function uh(e){return e()}function mh(){return Object.create(null)}function hh(e){e.forEach(uh)}function ph(e){return"function"===typeof e}function fh(e,t){return e!=e?t==t:e!==t||e&&"object"===typeof e||"function"===typeof e}let gh,vh;function _h(e,t){return gh||(gh=document.createElement("a")),gh.href=t,e===gh.href}function bh(e){return 0===Object.keys(e).length}function yh(e){return e&&ph(e.destroy)?e.destroy:dh}function xh(e,t){e.appendChild(t)}function wh(e,t,s){e.insertBefore(t,s||null)}function kh(e){e.parentNode.removeChild(e)}function Mh(e){return document.createElement(e)}function Sh(e){return document.createTextNode(e)}function Rh(e,t,s,o){return e.addEventListener(t,s,o),()=>e.removeEventListener(t,s,o)}function Ah(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function Eh(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Th(e,t){e.value=null==t?"":t}function Ih(e,t,s,o){null===s?e.style.removeProperty(t):e.style.setProperty(t,s,o?"important":"")}function Oh(e){vh=e}const Bh=[],Ch=[],jh=[],Lh=[],Ph=Promise.resolve();let Nh=!1;function Hh(){Nh||(Nh=!0,Ph.then(qh))}function Dh(){return Hh(),Ph}function Uh(e){jh.push(e)}const Fh=new Set;let $h=0;function qh(){const e=vh;do{while($h<Bh.length){const e=Bh[$h];$h++,Oh(e),Vh(e.$$)}Oh(null),Bh.length=0,$h=0;while(Ch.length)Ch.pop()();for(let e=0;e<jh.length;e+=1){const t=jh[e];Fh.has(t)||(Fh.add(t),t())}jh.length=0}while(Bh.length);while(Lh.length)Lh.pop()();Nh=!1,Fh.clear(),Oh(e)}function Vh(e){if(null!==e.fragment){e.update(),hh(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Uh)}}const zh=new Set;function Yh(e,t){e&&e.i&&(zh.delete(e),e.i(t))}const Xh="undefined"!==typeof window?window:"undefined"!==typeof globalThis?globalThis:e;function Kh(e,t){e.d(1),t.delete(e.key)}function Gh(e,t,s,o,a,n,r,i,l,c,d,u){let m=e.length,h=n.length,p=m;const f={};while(p--)f[e[p].key]=p;const g=[],v=new Map,_=new Map;p=h;while(p--){const e=u(a,n,p),i=s(e);let l=r.get(i);l?o&&l.p(e,t):(l=c(i,e),l.c()),v.set(i,g[p]=l),i in f&&_.set(i,Math.abs(p-f[i]))}const b=new Set,y=new Set;function x(e){Yh(e,1),e.m(i,d),r.set(e.key,e),d=e.first,h--}while(m&&h){const t=g[h-1],s=e[m-1],o=t.key,a=s.key;t===s?(d=t.first,m--,h--):v.has(a)?!r.has(o)||b.has(o)?x(t):y.has(a)?m--:_.get(o)>_.get(a)?(y.add(o),x(t)):(b.add(a),m--):(l(s,r),m--)}while(m--){const t=e[m];v.has(t.key)||l(t,r)}while(h)x(g[h-1]);return g}function Zh(e,t,s,o){const{fragment:a,on_mount:n,on_destroy:r,after_update:i}=e.$$;a&&a.m(t,s),o||Uh(()=>{const t=n.map(uh).filter(ph);r?r.push(...t):hh(t),e.$$.on_mount=[]}),i.forEach(Uh)}function Wh(e,t){const s=e.$$;null!==s.fragment&&(hh(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function Qh(e,t){-1===e.$$.dirty[0]&&(Bh.push(e),Hh(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Jh(e,t,s,o,a,n,r,i=[-1]){const l=vh;Oh(e);const c=e.$$={fragment:null,ctx:null,props:n,update:dh,not_equal:a,bound:mh(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:mh(),dirty:i,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let d=!1;c.ctx=s?s(e,t.props||{},(t,s,...o)=>{const n=o.length?o[0]:s;return c.ctx&&a(c.ctx[t],c.ctx[t]=n)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](n),d&&Qh(e,t)),s}):[],c.update(),d=!0,hh(c.before_update),c.fragment=!!o&&o(c.ctx),t.target&&(c.fragment&&c.fragment.c(),Zh(e,t.target,void 0,void 0),qh()),Oh(l)}class ep{$destroy(){Wh(this,1),this.$destroy=dh}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){this.$$set&&!bh(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const tp=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map(([e,t,s])=>({id:e,emoji:t,name:s})),sp=tp.slice(1),op=tp[0],ap=2,np=6,rp="function"===typeof requestIdleCallback?requestIdleCallback:setTimeout;function ip(e){return e.unicode.includes("‍")}const lp={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},cp=1e3,dp="🖐️",up=8,mp=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],hp='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',pp=(e,t)=>e<t?-1:e>t?1:0,fp=(e,t)=>{const s=document.createElement("canvas");s.width=s.height=1;const o=s.getContext("2d");return o.textBaseline="top",o.font="100px "+hp,o.fillStyle=t,o.scale(.01,.01),o.fillText(e,0,0),o.getImageData(0,0,1,1).data},gp=(e,t)=>{const s=[...e].join(","),o=[...t].join(",");return s===o&&!s.startsWith("0,0,0,")};function vp(e){const t=fp(e,"#000"),s=fp(e,"#fff");return t&&s&&gp(t,s)}function _p(){const e=Object.entries(lp);try{for(const[t,s]of e)if(vp(t))return s}catch(t){}return e[0][1]}const bp=new Promise(e=>rp(()=>e(_p()))),yp=new Map,xp="️",wp="\ud83c",kp="‍",Mp=127995,Sp=57339;function Rp(e,t){if(0===t)return e;const s=e.indexOf(kp);return-1!==s?e.substring(0,s)+String.fromCodePoint(Mp+t-1)+e.substring(s):(e.endsWith(xp)&&(e=e.substring(0,e.length-1)),e+wp+String.fromCodePoint(Sp+t-1))}function Ap(e){e.preventDefault(),e.stopPropagation()}function Ep(e,t,s){return t+=e?-1:1,t<0?t=s.length-1:t>=s.length&&(t=0),t}function Tp(e,t){const s=new Set,o=[];for(const a of e){const e=t(a);s.has(e)||(s.add(e),o.push(a))}return o}function Ip(e,t){const s=e=>{const s={};for(const o of e)"number"===typeof o.tone&&o.version<=t&&(s[o.tone]=o.unicode);return s};return e.map(({unicode:e,skins:t,shortcodes:o,url:a,name:n,category:r})=>({unicode:e,name:n,shortcodes:o,url:a,category:r,id:e||n,skins:t&&s(t),title:(o||[]).join(", ")}))}const Op=requestAnimationFrame;let Bp,Cp="function"===typeof ResizeObserver;function jp(e,t){let s;return Cp?(s=new ResizeObserver(e=>t(e[0].contentRect.width)),s.observe(e)):Op(()=>t(e.getBoundingClientRect().width)),{destroy(){s&&s.disconnect()}}}function Lp(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function Pp(e,t,s){for(const o of e){const e=s(o),a=Lp(e);"undefined"===typeof Bp&&(Bp=Lp(t));const n=a/1.8<Bp;yp.set(o.unicode,n)}}function Np(e){return Tp(e,e=>e)}const{Map:Hp}=Xh;function Dp(e,t,s){const o=e.slice();return o[63]=t[s],o[65]=s,o}function Up(e,t,s){const o=e.slice();return o[66]=t[s],o[65]=s,o}function Fp(e,t,s){const o=e.slice();return o[63]=t[s],o[65]=s,o}function $p(e,t,s){const o=e.slice();return o[69]=t[s],o}function qp(e,t,s){const o=e.slice();return o[72]=t[s],o[65]=s,o}function Vp(e,t){let s,o,a,n,r,i,l,c=t[72]+"";return{key:e,first:null,c(){s=Mh("div"),o=Sh(c),Ah(s,"id",a="skintone-"+t[65]),Ah(s,"class",n="emoji hide-focus "+(t[65]===t[20]?"active":"")),Ah(s,"aria-selected",r=t[65]===t[20]),Ah(s,"role","option"),Ah(s,"title",i=t[0].skinTones[t[65]]),Ah(s,"tabindex","-1"),Ah(s,"aria-label",l=t[0].skinTones[t[65]]),this.first=s},m(e,t){wh(e,s,t),xh(s,o)},p(e,d){t=e,512&d[0]&&c!==(c=t[72]+"")&&Eh(o,c),512&d[0]&&a!==(a="skintone-"+t[65])&&Ah(s,"id",a),1049088&d[0]&&n!==(n="emoji hide-focus "+(t[65]===t[20]?"active":""))&&Ah(s,"class",n),1049088&d[0]&&r!==(r=t[65]===t[20])&&Ah(s,"aria-selected",r),513&d[0]&&i!==(i=t[0].skinTones[t[65]])&&Ah(s,"title",i),513&d[0]&&l!==(l=t[0].skinTones[t[65]])&&Ah(s,"aria-label",l)},d(e){e&&kh(s)}}}function zp(e,t){let s,o,a,n,r,i,l,c,d,u=t[69].emoji+"";function m(){return t[49](t[69])}return{key:e,first:null,c(){s=Mh("button"),o=Mh("div"),a=Sh(u),Ah(o,"class","nav-emoji emoji"),Ah(s,"role","tab"),Ah(s,"class","nav-button"),Ah(s,"aria-controls",n="tab-"+t[69].id),Ah(s,"aria-label",r=t[0].categories[t[69].name]),Ah(s,"aria-selected",i=!t[4]&&t[13].id===t[69].id),Ah(s,"title",l=t[0].categories[t[69].name]),this.first=s},m(e,t){wh(e,s,t),xh(s,o),xh(o,a),c||(d=Rh(s,"click",m),c=!0)},p(e,o){t=e,4096&o[0]&&u!==(u=t[69].emoji+"")&&Eh(a,u),4096&o[0]&&n!==(n="tab-"+t[69].id)&&Ah(s,"aria-controls",n),4097&o[0]&&r!==(r=t[0].categories[t[69].name])&&Ah(s,"aria-label",r),12304&o[0]&&i!==(i=!t[4]&&t[13].id===t[69].id)&&Ah(s,"aria-selected",i),4097&o[0]&&l!==(l=t[0].categories[t[69].name])&&Ah(s,"title",l)},d(e){e&&kh(s),c=!1,d()}}}function Yp(e){let t,s;return{c(){t=Mh("img"),Ah(t,"class","custom-emoji"),_h(t.src,s=e[63].url)||Ah(t,"src",s),Ah(t,"alt",""),Ah(t,"loading","lazy")},m(e,s){wh(e,t,s)},p(e,o){32768&o[0]&&!_h(t.src,s=e[63].url)&&Ah(t,"src",s)},d(e){e&&kh(t)}}}function Xp(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=Sh(s)},m(e,s){wh(e,t,s)},p(e,o){33024&o[0]&&s!==(s=e[27](e[63],e[8])+"")&&Eh(t,s)},d(e){e&&kh(t)}}}function Kp(e,t){let s,o,a,n,r,i,l;function c(e,t){return e[63].unicode?Xp:Yp}let d=c(t),u=d(t);return{key:e,first:null,c(){s=Mh("button"),u.c(),Ah(s,"role",o=t[4]?"option":"menuitem"),Ah(s,"aria-selected",a=t[4]?t[65]==t[5]:""),Ah(s,"aria-label",n=t[28](t[63],t[8])),Ah(s,"title",r=t[63].title),Ah(s,"class",i="emoji "+(t[4]&&t[65]===t[5]?"active":"")),Ah(s,"id",l="emo-"+t[63].id),this.first=s},m(e,t){wh(e,s,t),u.m(s,null)},p(e,m){t=e,d===(d=c(t))&&u?u.p(t,m):(u.d(1),u=d(t),u&&(u.c(),u.m(s,null))),16&m[0]&&o!==(o=t[4]?"option":"menuitem")&&Ah(s,"role",o),32816&m[0]&&a!==(a=t[4]?t[65]==t[5]:"")&&Ah(s,"aria-selected",a),33024&m[0]&&n!==(n=t[28](t[63],t[8]))&&Ah(s,"aria-label",n),32768&m[0]&&r!==(r=t[63].title)&&Ah(s,"title",r),32816&m[0]&&i!==(i="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&Ah(s,"class",i),32768&m[0]&&l!==(l="emo-"+t[63].id)&&Ah(s,"id",l)},d(e){e&&kh(s),u.d()}}}function Gp(e,t){let s,o,a,n,r,i,l,c,d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",u=[],m=new Hp,h=t[66].emojis;const p=e=>e[63].id;for(let f=0;f<h.length;f+=1){let e=Fp(t,h,f),s=p(e);m.set(s,u[f]=Kp(s,e))}return{key:e,first:null,c(){s=Mh("div"),o=Sh(d),r=Mh("div");for(let e=0;e<u.length;e+=1)u[e].c();Ah(s,"id",a="menu-label-"+t[65]),Ah(s,"class",n="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),Ah(s,"aria-hidden","true"),Ah(r,"class","emoji-menu"),Ah(r,"role",i=t[4]?"listbox":"menu"),Ah(r,"aria-labelledby",l="menu-label-"+t[65]),Ah(r,"id",c=t[4]?"search-results":""),this.first=s},m(e,t){wh(e,s,t),xh(s,o),wh(e,r,t);for(let s=0;s<u.length;s+=1)u[s].m(r,null)},p(e,f){t=e,40977&f[0]&&d!==(d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&Eh(o,d),32768&f[0]&&a!==(a="menu-label-"+t[65])&&Ah(s,"id",a),32768&f[0]&&n!==(n="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&Ah(s,"class",n),402686256&f[0]&&(h=t[66].emojis,u=Gh(u,f,p,1,t,h,m,r,Kh,Kp,null,Fp)),16&f[0]&&i!==(i=t[4]?"listbox":"menu")&&Ah(r,"role",i),32768&f[0]&&l!==(l="menu-label-"+t[65])&&Ah(r,"aria-labelledby",l),16&f[0]&&c!==(c=t[4]?"search-results":"")&&Ah(r,"id",c)},d(e){e&&kh(s),e&&kh(r);for(let t=0;t<u.length;t+=1)u[t].d()}}}function Zp(e){let t,s;return{c(){t=Mh("img"),Ah(t,"class","custom-emoji"),_h(t.src,s=e[63].url)||Ah(t,"src",s),Ah(t,"alt",""),Ah(t,"loading","lazy")},m(e,s){wh(e,t,s)},p(e,o){1024&o[0]&&!_h(t.src,s=e[63].url)&&Ah(t,"src",s)},d(e){e&&kh(t)}}}function Wp(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=Sh(s)},m(e,s){wh(e,t,s)},p(e,o){1280&o[0]&&s!==(s=e[27](e[63],e[8])+"")&&Eh(t,s)},d(e){e&&kh(t)}}}function Qp(e,t){let s,o,a,n;function r(e,t){return e[63].unicode?Wp:Zp}let i=r(t),l=i(t);return{key:e,first:null,c(){s=Mh("button"),l.c(),Ah(s,"role","menuitem"),Ah(s,"aria-label",o=t[28](t[63],t[8])),Ah(s,"title",a=t[63].title),Ah(s,"class","emoji"),Ah(s,"id",n="fav-"+t[63].id),this.first=s},m(e,t){wh(e,s,t),l.m(s,null)},p(e,c){t=e,i===(i=r(t))&&l?l.p(t,c):(l.d(1),l=i(t),l&&(l.c(),l.m(s,null))),1280&c[0]&&o!==(o=t[28](t[63],t[8]))&&Ah(s,"aria-label",o),1024&c[0]&&a!==(a=t[63].title)&&Ah(s,"title",a),1024&c[0]&&n!==(n="fav-"+t[63].id)&&Ah(s,"id",n)},d(e){e&&kh(s),l.d()}}}function Jp(e){let t,s,o,a,n,r,i,l,c,d,u,m,h,p,f,g,v,_,b,y,x,w,k,M,S,R,A,E,T,I,O,B,C,j,L,P,N,H,D,U,F,$,q,V,z=e[0].searchLabel+"",Y=e[0].searchDescription+"",X=e[0].skinToneDescription+"",K=[],G=new Hp,Z=[],W=new Hp,Q=[],J=new Hp,ee=[],te=new Hp,se=e[9];const oe=e=>e[72];for(let de=0;de<se.length;de+=1){let t=qp(e,se,de),s=oe(t);G.set(s,K[de]=Vp(s,t))}let ae=e[12];const ne=e=>e[69].id;for(let de=0;de<ae.length;de+=1){let t=$p(e,ae,de),s=ne(t);W.set(s,Z[de]=zp(s,t))}let re=e[15];const ie=e=>e[66].category;for(let de=0;de<re.length;de+=1){let t=Up(e,re,de),s=ie(t);J.set(s,Q[de]=Gp(s,t))}let le=e[10];const ce=e=>e[63].id;for(let de=0;de<le.length;de+=1){let t=Dp(e,le,de),s=ce(t);te.set(s,ee[de]=Qp(s,t))}return{c(){t=Mh("section"),s=Mh("div"),o=Mh("div"),a=Mh("div"),n=Mh("input"),c=Mh("label"),d=Sh(z),u=Mh("span"),m=Sh(Y),h=Mh("div"),p=Mh("button"),f=Sh(e[21]),_=Mh("span"),b=Sh(X),y=Mh("div");for(let e=0;e<K.length;e+=1)K[e].c();S=Mh("div");for(let e=0;e<Z.length;e+=1)Z[e].c();A=Mh("div"),E=Mh("div"),T=Mh("div"),I=Sh(e[18]),B=Mh("div"),C=Mh("div");for(let e=0;e<Q.length;e+=1)Q[e].c();H=Mh("div");for(let e=0;e<ee.length;e+=1)ee[e].c();F=Mh("button"),F.textContent="😀",Ah(s,"class","pad-top"),Ah(n,"id","search"),Ah(n,"class","search"),Ah(n,"type","search"),Ah(n,"role","combobox"),Ah(n,"enterkeyhint","search"),Ah(n,"placeholder",r=e[0].searchLabel),Ah(n,"autocapitalize","none"),Ah(n,"autocomplete","off"),Ah(n,"spellcheck","true"),Ah(n,"aria-expanded",i=!(!e[4]||!e[1].length)),Ah(n,"aria-controls","search-results"),Ah(n,"aria-describedby","search-description"),Ah(n,"aria-autocomplete","list"),Ah(n,"aria-activedescendant",l=e[26]?"emo-"+e[26]:""),Ah(c,"class","sr-only"),Ah(c,"for","search"),Ah(u,"id","search-description"),Ah(u,"class","sr-only"),Ah(a,"class","search-wrapper"),Ah(p,"id","skintone-button"),Ah(p,"class",g="emoji "+(e[6]?"hide-focus":"")),Ah(p,"aria-label",e[23]),Ah(p,"title",e[23]),Ah(p,"aria-describedby","skintone-description"),Ah(p,"aria-haspopup","listbox"),Ah(p,"aria-expanded",e[6]),Ah(p,"aria-controls","skintone-list"),Ah(h,"class",v="skintone-button-wrapper "+(e[19]?"expanded":"")),Ah(_,"id","skintone-description"),Ah(_,"class","sr-only"),Ah(y,"id","skintone-list"),Ah(y,"class",x="skintone-list "+(e[6]?"":"hidden no-animate")),Ih(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),Ah(y,"role","listbox"),Ah(y,"aria-label",w=e[0].skinTonesLabel),Ah(y,"aria-activedescendant",k="skintone-"+e[20]),Ah(y,"aria-hidden",M=!e[6]),Ah(o,"class","search-row"),Ah(S,"class","nav"),Ah(S,"role","tablist"),Ih(S,"grid-template-columns","repeat("+e[12].length+", 1fr)"),Ah(S,"aria-label",R=e[0].categoriesLabel),Ah(E,"class","indicator"),Ih(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),Ah(A,"class","indicator-wrapper"),Ah(T,"class",O="message "+(e[18]?"":"gone")),Ah(T,"role","alert"),Ah(T,"aria-live","polite"),Ah(B,"class",j="tabpanel "+(!e[14]||e[18]?"gone":"")),Ah(B,"role",L=e[4]?"region":"tabpanel"),Ah(B,"aria-label",P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),Ah(B,"id",N=e[4]?"":"tab-"+e[13].id),Ah(B,"tabindex","0"),Ah(H,"class",D="favorites emoji-menu "+(e[18]?"gone":"")),Ah(H,"role","menu"),Ah(H,"aria-label",U=e[0].favoritesLabel),Ih(H,"padding-inline-end",e[25]+"px"),Ah(F,"aria-hidden","true"),Ah(F,"tabindex","-1"),Ah(F,"class","abs-pos hidden emoji"),Ah(t,"class","picker"),Ah(t,"aria-label",$=e[0].regionLabel),Ah(t,"style",e[22])},m(r,i){wh(r,t,i),xh(t,s),xh(t,o),xh(o,a),xh(a,n),Th(n,e[2]),xh(a,c),xh(c,d),xh(a,u),xh(u,m),xh(o,h),xh(h,p),xh(p,f),xh(o,_),xh(_,b),xh(o,y);for(let e=0;e<K.length;e+=1)K[e].m(y,null);e[48](y),xh(t,S);for(let e=0;e<Z.length;e+=1)Z[e].m(S,null);xh(t,A),xh(A,E),xh(t,T),xh(T,I),xh(t,B),xh(B,C);for(let e=0;e<Q.length;e+=1)Q[e].m(C,null);e[50](B),xh(t,H);for(let e=0;e<ee.length;e+=1)ee[e].m(H,null);xh(t,F),e[51](F),e[52](t),q||(V=[Rh(n,"input",e[47]),Rh(n,"keydown",e[30]),Rh(p,"click",e[35]),Rh(y,"focusout",e[38]),Rh(y,"click",e[34]),Rh(y,"keydown",e[36]),Rh(y,"keyup",e[37]),Rh(S,"keydown",e[32]),yh(e[29].call(null,C)),Rh(B,"click",e[33]),Rh(H,"click",e[33])],q=!0)},p(e,s){1&s[0]&&r!==(r=e[0].searchLabel)&&Ah(n,"placeholder",r),18&s[0]&&i!==(i=!(!e[4]||!e[1].length))&&Ah(n,"aria-expanded",i),67108864&s[0]&&l!==(l=e[26]?"emo-"+e[26]:"")&&Ah(n,"aria-activedescendant",l),4&s[0]&&Th(n,e[2]),1&s[0]&&z!==(z=e[0].searchLabel+"")&&Eh(d,z),1&s[0]&&Y!==(Y=e[0].searchDescription+"")&&Eh(m,Y),2097152&s[0]&&Eh(f,e[21]),64&s[0]&&g!==(g="emoji "+(e[6]?"hide-focus":""))&&Ah(p,"class",g),8388608&s[0]&&Ah(p,"aria-label",e[23]),8388608&s[0]&&Ah(p,"title",e[23]),64&s[0]&&Ah(p,"aria-expanded",e[6]),524288&s[0]&&v!==(v="skintone-button-wrapper "+(e[19]?"expanded":""))&&Ah(h,"class",v),1&s[0]&&X!==(X=e[0].skinToneDescription+"")&&Eh(b,X),1049089&s[0]&&(se=e[9],K=Gh(K,s,oe,1,e,se,G,y,Kh,Vp,null,qp)),64&s[0]&&x!==(x="skintone-list "+(e[6]?"":"hidden no-animate"))&&Ah(y,"class",x),64&s[0]&&Ih(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&s[0]&&w!==(w=e[0].skinTonesLabel)&&Ah(y,"aria-label",w),1048576&s[0]&&k!==(k="skintone-"+e[20])&&Ah(y,"aria-activedescendant",k),64&s[0]&&M!==(M=!e[6])&&Ah(y,"aria-hidden",M),12305&s[0]|1&s[1]&&(ae=e[12],Z=Gh(Z,s,ne,1,e,ae,W,S,Kh,zp,null,$p)),4096&s[0]&&Ih(S,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&s[0]&&R!==(R=e[0].categoriesLabel)&&Ah(S,"aria-label",R),16779264&s[0]&&Ih(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&s[0]&&Eh(I,e[18]),262144&s[0]&&O!==(O="message "+(e[18]?"":"gone"))&&Ah(T,"class",O),402694449&s[0]&&(re=e[15],Q=Gh(Q,s,ie,1,e,re,J,C,Kh,Gp,null,Up)),278528&s[0]&&j!==(j="tabpanel "+(!e[14]||e[18]?"gone":""))&&Ah(B,"class",j),16&s[0]&&L!==(L=e[4]?"region":"tabpanel")&&Ah(B,"role",L),8209&s[0]&&P!==(P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&Ah(B,"aria-label",P),8208&s[0]&&N!==(N=e[4]?"":"tab-"+e[13].id)&&Ah(B,"id",N),402654464&s[0]&&(le=e[10],ee=Gh(ee,s,ce,1,e,le,te,H,Kh,Qp,null,Dp)),262144&s[0]&&D!==(D="favorites emoji-menu "+(e[18]?"gone":""))&&Ah(H,"class",D),1&s[0]&&U!==(U=e[0].favoritesLabel)&&Ah(H,"aria-label",U),33554432&s[0]&&Ih(H,"padding-inline-end",e[25]+"px"),1&s[0]&&$!==($=e[0].regionLabel)&&Ah(t,"aria-label",$),4194304&s[0]&&Ah(t,"style",e[22])},i:dh,o:dh,d(s){s&&kh(t);for(let e=0;e<K.length;e+=1)K[e].d();e[48](null);for(let e=0;e<Z.length;e+=1)Z[e].d();for(let e=0;e<Q.length;e+=1)Q[e].d();e[50](null);for(let e=0;e<ee.length;e+=1)ee[e].d();e[51](null),e[52](null),q=!1,hh(V)}}}function ef(e,t,s){let o,a,n,r,i,l,c,d,u,m,{skinToneEmoji:h}=t,{i18n:p}=t,{database:f}=t,{customEmoji:g}=t,{customCategorySorting:v}=t,_=!0,b=[],y=[],x="",w="",k=!1,M=-1,S=!1,R=!1,A=0,E=0,T="",I=[],O=[],B=up,C=!1,j=0,L=0,P=sp,N=!1;const H=e=>{o.getRootNode().getElementById(e).focus()},D=(e,t)=>{o.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},U=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,F=(e,t)=>Np([e.name||U(e,t),...e.shortcodes||[]]).join(", "),$=e=>/^skintone-/.test(e.id);function q(e){return jp(e,t=>{{const a=getComputedStyle(o),n=parseInt(a.getPropertyValue("--num-columns"),10),r="rtl"===a.getPropertyValue("direction"),i=e.parentElement.getBoundingClientRect().width,l=i-t;s(46,B=n),s(25,j=l),s(24,C=r)}})}function V(e){const t=o.getRootNode(),n=e=>t.getElementById("emo-"+e.id);Pp(e,a,n),s(1,b=b)}function z(e){return!e.unicode||!ip(e)||yp.get(e.unicode)}async function Y(e){const t=await bp;return e.filter(({version:e})=>!e||e<=t)}async function X(e){return Ip(e,await bp)}async function K(e){if("undefined"===typeof e)return[];const t=-1===e?g:await f.getEmojiByGroup(e);return X(await Y(t))}async function G(e){return X(await Y(await f.getEmojiBySearchQuery(e)))}function Z(e){if(!k||!b.length)return;const t=t=>{Ap(e),s(5,M=Ep(t,M,b))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==M)return Ap(e),J(b[M].id);b.length&&s(5,M=0)}}function W(e){s(2,x=""),s(44,w=""),s(5,M=-1),s(11,L=P.findIndex(t=>t.id===e.id))}function Q(e){const{target:t,key:s}=e,o=t=>{t&&(Ap(e),t.focus())};switch(s){case"ArrowLeft":return o(t.previousSibling);case"ArrowRight":return o(t.nextSibling);case"Home":return o(t.parentElement.firstChild);case"End":return o(t.parentElement.lastChild)}}async function J(e){const t=await f.getEmojiByUnicodeOrName(e),s=[...b,...O].find(t=>t.id===e),o=s.unicode&&U(s,A);await f.incrementFavoriteEmojiCount(e),D("emoji-click",{emoji:t,skinTone:A,...o&&{unicode:o},...s.name&&{name:s.name}})}async function ee(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;Ap(e);const s=t.id.substring(4);J(s)}async function te(e){const{target:t}=e;if(!$(t))return;Ap(e);const o=parseInt(t.id.slice(9),10);s(8,A=o),s(6,S=!1),H("skintone-button"),D("skin-tone-change",{skinTone:o}),f.setPreferredSkinTone(o)}async function se(e){s(6,S=!S),s(20,E=A),S&&(Ap(e),Op(()=>H("skintone-"+E)))}function oe(e){if(!S)return;const t=async t=>{Ap(e),s(20,E=t),await Dh(),H("skintone-"+E)};switch(e.key){case"ArrowUp":return t(Ep(!0,E,I));case"ArrowDown":return t(Ep(!1,E,I));case"Home":return t(0);case"End":return t(I.length-1);case"Enter":return te(e);case"Escape":return Ap(e),s(6,S=!1),H("skintone-button")}}function ae(e){if(S)switch(e.key){case" ":return te(e)}}async function ne(e){const{relatedTarget:t}=e;t&&$(t)||s(6,S=!1)}function re(){x=this.value,s(2,x)}function ie(e){Ch[e?"unshift":"push"](()=>{i=e,s(7,i)})}bp.then(e=>{e||s(18,r=p.emojiUnsupportedMessage)});const le=e=>W(e);function ce(e){Ch[e?"unshift":"push"](()=>{n=e,s(3,n)})}function de(e){Ch[e?"unshift":"push"](()=>{a=e,s(17,a)})}function ue(e){Ch[e?"unshift":"push"](()=>{o=e,s(16,o)})}return e.$$set=e=>{"skinToneEmoji"in e&&s(40,h=e.skinToneEmoji),"i18n"in e&&s(0,p=e.i18n),"database"in e&&s(39,f=e.database),"customEmoji"in e&&s(41,g=e.customEmoji),"customCategorySorting"in e&&s(42,v=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&g&&f&&s(39,f.customEmoji=g,f),1&e.$$.dirty[0]|256&e.$$.dirty[1]){async function t(){let e=!1;const t=setTimeout(()=>{e=!0,s(18,r=p.loadingMessage)},cp);try{await f.ready(),s(14,N=!0)}catch(o){console.error(o),s(18,r=p.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,s(18,r=""))}}f&&t()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(g&&g.length?s(12,P=[op,...sp]):P!==sp&&(L&&s(11,L--,L),s(12,P=sp))),4&e.$$.dirty[0]&&rp(()=>{s(44,w=(x||"").trim()),s(5,M=-1)}),6144&e.$$.dirty[0]&&s(13,u=P[L]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){async function o(){if(N){if(w.length>=ap){const e=w,t=await G(e);e===w&&(s(1,b=t),s(4,k=!0))}else if(u){const e=u.id,t=await K(e);e===u.id&&(s(1,b=t),s(4,k=!1))}}else s(1,b=[]),s(4,k=!1)}o()}if(4112&e.$$.dirty[0]&&s(22,c=`\n  --font-family: ${hp};\n  --num-groups: ${P.length}; \n  --indicator-opacity: ${k?0:1}; \n  --num-skintones: ${np};`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function a(){N&&s(8,A=await f.getPreferredSkinTone())}a()}if(512&e.$$.dirty[1]&&s(9,I=Array(np).fill().map((e,t)=>Rp(h,t))),768&e.$$.dirty[0]&&s(21,l=I[A]),257&e.$$.dirty[0]&&s(23,T=p.skinToneLabel.replace("{skinTone}",p.skinTones[A])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function _(){s(45,d=(await Promise.all(mp.map(e=>f.getEmojiByUnicodeOrName(e)))).filter(Boolean))}N&&_()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){async function E(){const e=await f.getTopFavoriteEmoji(B),t=await X(Tp([...e,...d],e=>e.unicode||e.name).slice(0,B));s(10,O=t)}N&&d&&E()}if(10&e.$$.dirty[0]){const e=b.filter(e=>e.unicode).filter(e=>ip(e)&&!yp.has(e.unicode));e.length?Op(()=>V(e)):(s(1,b=b.filter(z)),Op(()=>{(n||{}).scrollTop=0}))}if(e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]){let e=function(){if(k)return[{category:"",emojis:b}];const e=new Map;for(const t of b){const s=t.category||"";let o=e.get(s);o||(o=[],e.set(s,o)),o.push(t)}return[...e.entries()].map(([e,t])=>({category:e,emojis:t})).sort((e,t)=>v(e.category,t.category))};s(15,y=e())}34&e.$$.dirty[0]&&s(26,m=-1!==M&&b[M].id),192&e.$$.dirty[0]&&(S?i.addEventListener("transitionend",()=>{s(19,R=!0)},{once:!0}):s(19,R=!1))},[p,b,x,n,k,M,S,i,A,I,O,L,P,u,N,y,o,a,r,R,E,l,c,T,C,j,m,U,F,q,Z,W,Q,ee,te,se,oe,ae,ne,f,h,g,v,_,w,d,B,re,ie,le,ce,de,ue]}class tf extends ep{constructor(e){super(),Jh(this,e,ef,Jp,fh,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const sf="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",of="en";var af={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const nf=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class rf extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(t),this._ctx={locale:of,dataSource:sf,skinToneEmoji:dp,customCategorySorting:pp,customEmoji:null,i18n:af,...e};for(const s of nf)"database"!==s&&Object.prototype.hasOwnProperty.call(this,s)&&(this._ctx[s]=this[s],delete this[s]);this._dbFlush()}connectedCallback(){this._cmp=new tf({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch(e=>console.error(e))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,s){this._set(e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),s)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:s}=this._ctx;s&&s.locale===e&&s.dataSource===t||this._set("database",new ch({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const lf={};for(const t of nf)lf[t]={get(){return"database"===t&&this._dbCreate(),this._ctx[t]},set(e){if("database"===t)throw new Error("database is read-only");this._set(t,e)}};function cf(e,t){while(e&&!e.querySelector(t)){e=e.parentNode;const s=e.querySelector(t);if(s)return s}return null}Object.defineProperties(rf.prototype,lf),customElements.get("emoji-picker")||customElements.define("emoji-picker",rf);const df={name:"EmojiPickerContainer",components:{SvgIcon:yi},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})})},0)}},methods:{addCustomStyling(){const e=".picker {\n\t\t\t\tborder: none;\n\t\t\t}",t=".nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}",s=".search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}",o="input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",a=document.createElement("style");a.textContent=e+t+s+o,this.$refs.emojiPicker.shadowRoot.appendChild(a)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,s){const o=t<500||s<700,a=cf(this.$el,"#room-footer");if(a)if(o)this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=s-200;else{const t=a.getBoundingClientRect().top,s=t-e>this.emojiPickerHeight-50;this.emojiPickerTop=s?e+10:e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""}else o&&(this.emojiPickerRight="-50px")}}},uf={class:"vac-emoji-wrapper"};function mf(e,t,s,o,a,n){const r=Mo("svg-icon"),i=Mo("emoji-picker");return Ia(),La("div",uf,[$a("div",{class:it(["vac-svg-button",{"vac-emoji-reaction":s.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>n.openEmoji&&n.openEmoji(...e))},[Bo(e.$slots,s.messageId?"emoji-picker-reaction-icon_"+s.messageId:"emoji-picker-icon",{},()=>[qa(r,{name:"emoji",param:s.emojiReaction?"reaction":""},null,8,["param"])])],2),s.emojiOpened?(Ia(),Pa(kr,{key:0,name:"vac-slide-up",appear:""},{default:As(()=>[$a("div",{class:it(["vac-emoji-picker",{"vac-picker-reaction":s.emojiReaction}]),style:ot({height:a.emojiPickerHeight+"px",top:s.positionTop?a.emojiPickerHeight:a.emojiPickerTop+"px",right:a.emojiPickerRight,display:a.emojiPickerTop||!s.emojiReaction?"initial":"none"})},[s.emojiOpened?(Ia(),Pa(i,{key:0,ref:"emojiPicker","data-source":s.emojiDataSource},null,8,["data-source"])):Ka("",!0)],6)]),_:1})):Ka("",!0)])}var hf=ni(df,[["render",mf]]);const pf={name:"RoomFiles",components:{Loader:pi,SvgIcon:yi},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}}},ff={class:"vac-room-file-container"},gf=["src"],vf={class:"vac-text-ellipsis"},_f={key:0,class:"vac-text-ellipsis vac-text-extension"};function bf(e,t,s,o,a,n){const r=Mo("loader"),i=Mo("svg-icon");return Ia(),La("div",ff,[qa(r,{show:s.file.loading,type:"room-file"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["show"]),$a("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",s.index))},[Bo(e.$slots,"image-close-icon",{},()=>[qa(i,{name:"close",param:"image"})])]),n.isImage?(Ia(),La("div",{key:0,class:it(["vac-message-image",{"vac-blur-loading":s.file.loading}]),style:ot({"background-image":`url('${s.file.localUrl||s.file.url}')`})},null,6)):n.isVideo?(Ia(),La("video",{key:1,controls:"",class:it({"vac-blur-loading":s.file.loading})},[$a("source",{src:s.file.localUrl||s.file.url},null,8,gf)],2)):(Ia(),La("div",{key:2,class:it(["vac-file-container",{"vac-blur-loading":s.file.loading}])},[$a("div",null,[Bo(e.$slots,"file-icon",{},()=>[qa(i,{name:"file"})])]),$a("div",vf,ct(s.file.name),1),s.file.extension?(Ia(),La("div",_f,ct(s.file.extension),1)):Ka("",!0)],2))])}var yf=ni(pf,[["render",bf]]);const xf={name:"RoomFiles",components:{SvgIcon:yi,RoomFile:yf},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},wf={key:0,class:"vac-room-files-container"},kf={class:"vac-files-box"},Mf={class:"vac-icon-close"};function Sf(e,t,s,o,a,n){const r=Mo("room-file"),i=Mo("svg-icon");return Ia(),Pa(kr,{name:"vac-slide-up"},{default:As(()=>[s.files.length?(Ia(),La("div",wf,[$a("div",kf,[(Ia(!0),La(Ma,null,Io(s.files,(s,o)=>(Ia(),La("div",{key:o},[qa(r,{file:s,index:o,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["file","index"])]))),128))]),$a("div",Mf,[$a("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[Bo(e.$slots,"files-close-icon",{},()=>[qa(i,{name:"close-outline"})])])])])):Ka("",!0)]),_:3})}var Rf=ni(xf,[["render",Sf]]);const Af={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const s=t.getBoundingClientRect().width,o=t.getBoundingClientRect().left;let a=(e.clientX-o)/s;return a=a<0?0:a,a=a>1?1:a,a}}},Ef={class:"vac-player-progress"},Tf={class:"vac-line-container"};function If(e,t,s,o,a,n){return Ia(),La("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>n.onMouseDown&&n.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[$a("div",Ef,[$a("div",Tf,[$a("div",{class:"vac-line-progress",style:ot({width:s.percentage+"%"})},null,4),$a("div",{class:it(["vac-line-dot",{"vac-line-dot__active":a.isMouseDown}]),style:ot({left:s.percentage+"%"})},null,6)])])],544)}var Of=ni(Af,[["render",If]]);const Bf={name:"AudioPlayer",components:{SvgIcon:yi,AudioControl:Of},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return"audio-player"+this.messageId},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(1e3*e).toISOString().substr(14,5)},playback(){!this.messageSelectionEnabled&&this.audioSource&&(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Cf={class:"vac-audio-player"},jf=["id","src"];function Lf(e,t,s,o,a,n){const r=Mo("svg-icon"),i=Mo("audio-control");return Ia(),La("div",null,[$a("div",Cf,[$a("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>n.playback&&n.playback(...e))},[a.isPlaying?Bo(e.$slots,"audio-pause-icon_"+s.messageId,{key:0},()=>[qa(r,{name:"audio-pause"})]):Bo(e.$slots,"audio-play-icon_"+s.messageId,{key:1},()=>[qa(r,{name:"audio-play"})])]),qa(i,{percentage:a.progress,"message-selection-enabled":s.messageSelectionEnabled,onChangeLinehead:n.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),$a("audio",{id:n.playerUniqId,src:n.audioSource},null,8,jf)])])}var Pf=ni(Bf,[["render",Lf]]);const Nf={name:"RoomMessageReply",components:{SvgIcon:yi,FormatMessage:Cd,AudioPlayer:Pf},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)?this.messageReply.files[0]:{}},isImage(){return Zd(this.firstFile)},isVideo(){return Wd(this.firstFile)},isAudio(){return Jd(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Hf={key:0,class:"vac-reply-container"},Df={class:"vac-reply-box"},Uf={class:"vac-reply-info"},Ff={class:"vac-reply-username"},$f={class:"vac-reply-content"},qf=["src"],Vf={key:1,controls:"",class:"vac-image-reply"},zf=["src"],Yf={key:3,class:"vac-image-reply vac-file-container"},Xf={class:"vac-text-ellipsis"},Kf={key:0,class:"vac-text-ellipsis vac-text-extension"},Gf={class:"vac-icon-reply"};function Zf(e,t,s,o,a,n){const r=Mo("format-message"),i=Mo("audio-player"),l=Mo("svg-icon");return Ia(),Pa(kr,{name:"vac-slide-up"},{default:As(()=>[s.messageReply?(Ia(),La("div",Hf,[$a("div",Df,[$a("div",Uf,[$a("div",Ff,ct(s.messageReply.username),1),$a("div",$f,[qa(r,{"message-id":s.messageReply._id,content:s.messageReply.content,users:s.room.users,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),n.isImage?(Ia(),La("img",{key:0,src:n.firstFile.url,class:"vac-image-reply"},null,8,qf)):n.isVideo?(Ia(),La("video",Vf,[$a("source",{src:n.firstFile.url},null,8,zf)])):n.isAudio?(Ia(),Pa(i,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["src"])):n.isOtherFile?(Ia(),La("div",Yf,[$a("div",null,[Bo(e.$slots,"file-icon",{},()=>[qa(l,{name:"file"})])]),$a("div",Xf,ct(n.firstFile.name),1),n.firstFile.extension?(Ia(),La("div",Kf,ct(n.firstFile.extension),1)):Ka("",!0)])):Ka("",!0)]),$a("div",Gf,[$a("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[Bo(e.$slots,"reply-close-icon",{},()=>[qa(l,{name:"close-outline"})])])])])):Ka("",!0)]),_:3})}var Wf=ni(Nf,[["render",Zf]]);const Qf={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Jf={key:0,class:"vac-tags-container"},eg=["onMouseover","onClick"],tg={class:"vac-tags-info"},sg={class:"vac-tags-username"};function og(e,t,s,o,a,n){return Ia(),Pa(kr,{name:"vac-slide-up"},{default:As(()=>[s.filteredUsersTag.length?(Ia(),La("div",Jf,[(Ia(!0),La(Ma,null,Io(s.filteredUsersTag,(t,s)=>(Ia(),La("div",{key:t._id,class:it(["vac-tags-box",{"vac-tags-box-active":s===a.activeItem}]),onMouseover:e=>a.activeItem=s,onClick:s=>e.$emit("select-user-tag",t)},[$a("div",tg,[t.avatar?(Ia(),La("div",{key:0,class:"vac-avatar vac-tags-avatar",style:ot({"background-image":`url('${t.avatar}')`})},null,4)):Ka("",!0),$a("div",sg,ct(t.username),1)])],42,eg))),128))])):Ka("",!0)]),_:1})}var ag=ni(Qf,[["render",og]]);const ng={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},rg={key:0,class:"vac-emojis-container"},ig=["onMouseover","onClick"];function lg(e,t,s,o,a,n){return Ia(),Pa(kr,{name:"vac-slide-up"},{default:As(()=>[s.filteredEmojis.length?(Ia(),La("div",rg,[(Ia(!0),La(Ma,null,Io(s.filteredEmojis,(t,s)=>(Ia(),La("div",{key:t,class:it(["vac-emoji-element",{"vac-emoji-element-active":s===a.activeItem}]),onMouseover:e=>a.activeItem=s,onClick:s=>e.$emit("select-emoji",t)},ct(t),43,ig))),128))])):Ka("",!0)]),_:1})}var cg=ni(ng,[["render",lg]]);const dg={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},ug={key:0,class:"vac-template-container vac-app-box-shadow"},mg=["onMouseover","onClick"],hg={class:"vac-template-info"},pg={class:"vac-template-tag"},fg={class:"vac-template-text"};function gg(e,t,s,o,a,n){return Ia(),Pa(kr,{name:"vac-slide-up"},{default:As(()=>[s.filteredTemplatesText.length?(Ia(),La("div",ug,[(Ia(!0),La(Ma,null,Io(s.filteredTemplatesText,(t,s)=>(Ia(),La("div",{key:s,class:it(["vac-template-box",{"vac-template-active":s===a.activeItem}]),onMouseover:e=>a.activeItem=s,onClick:s=>e.$emit("select-template-text",t)},[$a("div",hg,[$a("div",pg," /"+ct(t.tag),1),$a("div",fg,ct(t.text),1)])],42,mg))),128))])):Ka("",!0)]),_:1})}var vg=ni(dg,[["render",gg]]);function _g(e){return new Int8Array(e)}function bg(e){return new Int16Array(e)}function yg(e){return new Int32Array(e)}function xg(e){return new Float32Array(e)}function wg(e){return new Float64Array(e)}function kg(e){if(1==e.length)return xg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],o=0;o<t;o++)s.push(kg(e));return s}function Mg(e){if(1==e.length)return yg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],o=0;o<t;o++)s.push(Mg(e));return s}function Sg(e){if(1==e.length)return bg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],o=0;o<t;o++)s.push(Sg(e));return s}function Rg(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var s=[],o=0;o<t;o++)s.push(Rg(e));return s}var Ag={fill:function(e,t,s,o){if(2==arguments.length)for(var a=0;a<e.length;a++)e[a]=arguments[1];else for(a=t;a<s;a++)e[a]=o}},Eg={arraycopy:function(e,t,s,o,a){var n=t+a;while(t<n)s[o++]=e[t++]},out:{}};Eg.out.println=function(e){console.log(e)},Eg.out.printf=function(){console.log.apply(console,arguments)};var Tg={};function Ig(e){this.ordinal=e}Tg.SQRT2=1.4142135623730951,Tg.FAST_LOG10=function(e){return Math.log10(e)},Tg.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},Ig.short_block_allowed=new Ig(0),Ig.short_block_coupled=new Ig(1),Ig.short_block_dispensed=new Ig(2),Ig.short_block_forced=new Ig(3);var Og={};function Bg(e){this.ordinal=e}Og.MAX_VALUE=34028235e31,Bg.vbr_off=new Bg(0),Bg.vbr_mt=new Bg(1),Bg.vbr_rh=new Bg(2),Bg.vbr_abr=new Bg(3),Bg.vbr_mtrh=new Bg(4),Bg.vbr_default=Bg.vbr_mtrh;var Cg=function(e){},jg={System:Eg,VbrMode:Bg,Float:Og,ShortBlock:Ig,Util:Tg,Arrays:Ag,new_array_n:Rg,new_byte:_g,new_double:wg,new_float:xg,new_float_n:kg,new_int:yg,new_int_n:Mg,new_short:bg,new_short_n:Sg,assert:Cg},Lg=jg.System,Pg=jg.Util,Ng=jg.Arrays,Hg=jg.new_float;function Dg(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Pg.SQRT2*.5/2384e-9,.017876148*Pg.SQRT2*.5/2384e-9,.003134727*Pg.SQRT2*.5/2384e-9,.002457142*Pg.SQRT2*.5/2384e-9,971317e-9*Pg.SQRT2*.5/2384e-9,218868e-9*Pg.SQRT2*.5/2384e-9,101566e-9*Pg.SQRT2*.5/2384e-9,13828e-9*Pg.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,s=36,o=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],a=o[Jg.SHORT_TYPE],n=o[Jg.SHORT_TYPE],r=o[Jg.SHORT_TYPE],i=o[Jg.SHORT_TYPE],l=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(t,s,o){for(var a,n,r,i=10,l=s+238-14-286,c=-15;c<0;c++){var d,u,m;d=e[i+-10],u=t[l+-224]*d,m=t[s+224]*d,d=e[i+-9],u+=t[l+-160]*d,m+=t[s+160]*d,d=e[i+-8],u+=t[l+-96]*d,m+=t[s+96]*d,d=e[i+-7],u+=t[l+-32]*d,m+=t[s+32]*d,d=e[i+-6],u+=t[l+32]*d,m+=t[s+-32]*d,d=e[i+-5],u+=t[l+96]*d,m+=t[s+-96]*d,d=e[i+-4],u+=t[l+160]*d,m+=t[s+-160]*d,d=e[i+-3],u+=t[l+224]*d,m+=t[s+-224]*d,d=e[i+-2],u+=t[s+-256]*d,m-=t[l+256]*d,d=e[i+-1],u+=t[s+-192]*d,m-=t[l+192]*d,d=e[i+0],u+=t[s+-128]*d,m-=t[l+128]*d,d=e[i+1],u+=t[s+-64]*d,m-=t[l+64]*d,d=e[i+2],u+=t[s+0]*d,m-=t[l+0]*d,d=e[i+3],u+=t[s+64]*d,m-=t[l+-64]*d,d=e[i+4],u+=t[s+128]*d,m-=t[l+-128]*d,d=e[i+5],u+=t[s+192]*d,m-=t[l+-192]*d,u*=e[i+6],d=m-u,o[30+2*c]=m+u,o[31+2*c]=e[i+7]*d,i+=18,s--,l++}m=t[s+-16]*e[i+-10],u=t[s+-32]*e[i+-2],m+=(t[s+-48]-t[s+16])*e[i+-9],u+=t[s+-96]*e[i+-1],m+=(t[s+-80]+t[s+48])*e[i+-8],u+=t[s+-160]*e[i+0],m+=(t[s+-112]-t[s+80])*e[i+-7],u+=t[s+-224]*e[i+1],m+=(t[s+-144]+t[s+112])*e[i+-6],u-=t[s+32]*e[i+2],m+=(t[s+-176]-t[s+144])*e[i+-5],u-=t[s+96]*e[i+3],m+=(t[s+-208]+t[s+176])*e[i+-4],u-=t[s+160]*e[i+4],m+=(t[s+-240]-t[s+208])*e[i+-3],u-=t[s+224],a=u-m,n=u+m,m=o[14],u=o[15]-m,o[31]=n+m,o[30]=a+u,o[15]=a-u,o[14]=n-m,r=o[28]-o[0],o[0]+=o[28],o[28]=r*e[i+-36+7],r=o[29]-o[1],o[1]+=o[29],o[29]=r*e[i+-36+7],r=o[26]-o[2],o[2]+=o[26],o[26]=r*e[i+-72+7],r=o[27]-o[3],o[3]+=o[27],o[27]=r*e[i+-72+7],r=o[24]-o[4],o[4]+=o[24],o[24]=r*e[i+-108+7],r=o[25]-o[5],o[5]+=o[25],o[25]=r*e[i+-108+7],r=o[22]-o[6],o[6]+=o[22],o[22]=r*Pg.SQRT2,r=o[23]-o[7],o[7]+=o[23],o[23]=r*Pg.SQRT2-o[7],o[7]-=o[6],o[22]-=o[7],o[23]-=o[22],r=o[6],o[6]=o[31]-r,o[31]=o[31]+r,r=o[7],o[7]=o[30]-r,o[30]=o[30]+r,r=o[22],o[22]=o[15]-r,o[15]=o[15]+r,r=o[23],o[23]=o[14]-r,o[14]=o[14]+r,r=o[20]-o[8],o[8]+=o[20],o[20]=r*e[i+-180+7],r=o[21]-o[9],o[9]+=o[21],o[21]=r*e[i+-180+7],r=o[18]-o[10],o[10]+=o[18],o[18]=r*e[i+-216+7],r=o[19]-o[11],o[11]+=o[19],o[19]=r*e[i+-216+7],r=o[16]-o[12],o[12]+=o[16],o[16]=r*e[i+-252+7],r=o[17]-o[13],o[13]+=o[17],o[17]=r*e[i+-252+7],r=-o[20]+o[24],o[20]+=o[24],o[24]=r*e[i+-216+7],r=-o[21]+o[25],o[21]+=o[25],o[25]=r*e[i+-216+7],r=o[4]-o[8],o[4]+=o[8],o[8]=r*e[i+-216+7],r=o[5]-o[9],o[5]+=o[9],o[9]=r*e[i+-216+7],r=o[0]-o[12],o[0]+=o[12],o[12]=r*e[i+-72+7],r=o[1]-o[13],o[1]+=o[13],o[13]=r*e[i+-72+7],r=o[16]-o[28],o[16]+=o[28],o[28]=r*e[i+-72+7],r=-o[17]+o[29],o[17]+=o[29],o[29]=r*e[i+-72+7],r=Pg.SQRT2*(o[2]-o[10]),o[2]+=o[10],o[10]=r,r=Pg.SQRT2*(o[3]-o[11]),o[3]+=o[11],o[11]=r,r=Pg.SQRT2*(-o[18]+o[26]),o[18]+=o[26],o[26]=r-o[18],r=Pg.SQRT2*(-o[19]+o[27]),o[19]+=o[27],o[27]=r-o[19],r=o[2],o[19]-=o[3],o[3]-=r,o[2]=o[31]-r,o[31]+=r,r=o[3],o[11]-=o[19],o[18]-=r,o[3]=o[30]-r,o[30]+=r,r=o[18],o[27]-=o[11],o[19]-=r,o[18]=o[15]-r,o[15]+=r,r=o[19],o[10]-=r,o[19]=o[14]-r,o[14]+=r,r=o[10],o[11]-=r,o[10]=o[23]-r,o[23]+=r,r=o[11],o[26]-=r,o[11]=o[22]-r,o[22]+=r,r=o[26],o[27]-=r,o[26]=o[7]-r,o[7]+=r,r=o[27],o[27]=o[6]-r,o[6]+=r,r=Pg.SQRT2*(o[0]-o[4]),o[0]+=o[4],o[4]=r,r=Pg.SQRT2*(o[1]-o[5]),o[1]+=o[5],o[5]=r,r=Pg.SQRT2*(o[16]-o[20]),o[16]+=o[20],o[20]=r,r=Pg.SQRT2*(o[17]-o[21]),o[17]+=o[21],o[21]=r,r=-Pg.SQRT2*(o[8]-o[12]),o[8]+=o[12],o[12]=r-o[8],r=-Pg.SQRT2*(o[9]-o[13]),o[9]+=o[13],o[13]=r-o[9],r=-Pg.SQRT2*(o[25]-o[29]),o[25]+=o[29],o[29]=r-o[25],r=-Pg.SQRT2*(o[24]+o[28]),o[24]-=o[28],o[28]=r-o[24],r=o[24]-o[16],o[24]=r,r=o[20]-r,o[20]=r,r=o[28]-r,o[28]=r,r=o[25]-o[17],o[25]=r,r=o[21]-r,o[21]=r,r=o[29]-r,o[29]=r,r=o[17]-o[1],o[17]=r,r=o[9]-r,o[9]=r,r=o[25]-r,o[25]=r,r=o[5]-r,o[5]=r,r=o[21]-r,o[21]=r,r=o[13]-r,o[13]=r,r=o[29]-r,o[29]=r,r=o[1]-o[0],o[1]=r,r=o[16]-r,o[16]=r,r=o[17]-r,o[17]=r,r=o[8]-r,o[8]=r,r=o[9]-r,o[9]=r,r=o[24]-r,o[24]=r,r=o[25]-r,o[25]=r,r=o[4]-r,o[4]=r,r=o[5]-r,o[5]=r,r=o[20]-r,o[20]=r,r=o[21]-r,o[21]=r,r=o[12]-r,o[12]=r,r=o[13]-r,o[13]=r,r=o[28]-r,o[28]=r,r=o[29]-r,o[29]=r,r=o[0],o[0]+=o[31],o[31]-=r,r=o[1],o[1]+=o[30],o[30]-=r,r=o[16],o[16]+=o[15],o[15]-=r,r=o[17],o[17]+=o[14],o[14]-=r,r=o[8],o[8]+=o[23],o[23]-=r,r=o[9],o[9]+=o[22],o[22]-=r,r=o[24],o[24]+=o[7],o[7]-=r,r=o[25],o[25]+=o[6],o[6]-=r,r=o[4],o[4]+=o[27],o[27]-=r,r=o[5],o[5]+=o[26],o[26]-=r,r=o[20],o[20]+=o[11],o[11]-=r,r=o[21],o[21]+=o[10],o[10]-=r,r=o[12],o[12]+=o[19],o[19]-=r,r=o[13],o[13]+=o[18],o[18]-=r,r=o[28],o[28]+=o[3],o[3]-=r,r=o[29],o[29]+=o[2],o[2]-=r}function d(e,t){for(var s=0;s<3;s++){var a,n,r,i,l,c;i=e[t+6]*o[Jg.SHORT_TYPE][0]-e[t+15],a=e[t+0]*o[Jg.SHORT_TYPE][2]-e[t+9],n=i+a,r=i-a,i=e[t+15]*o[Jg.SHORT_TYPE][0]+e[t+6],a=e[t+9]*o[Jg.SHORT_TYPE][2]+e[t+0],l=i+a,c=-i+a,a=2069978111953089e-26*(e[t+3]*o[Jg.SHORT_TYPE][1]-e[t+12]),i=2069978111953089e-26*(e[t+12]*o[Jg.SHORT_TYPE][1]+e[t+3]),e[t+0]=190752519173728e-25*n+a,e[t+15]=190752519173728e-25*-l+i,r=.8660254037844387*r*1907525191737281e-26,l=.5*l*1907525191737281e-26+i,e[t+3]=r-l,e[t+6]=r+l,n=.5*n*1907525191737281e-26-a,c=.8660254037844387*c*1907525191737281e-26,e[t+9]=n+c,e[t+12]=n-c,t++}}function u(e,t,s){var o,a,r,i,l,c,d,u,m,h,p,f,g,v,_,b,y,x;r=s[17]-s[9],l=s[15]-s[11],c=s[14]-s[12],d=s[0]+s[8],u=s[1]+s[7],m=s[2]+s[6],h=s[3]+s[5],e[t+17]=d+m-h-(u-s[4]),a=(d+m-h)*n[19]+(u-s[4]),o=(r-l-c)*n[18],e[t+5]=o+a,e[t+6]=o-a,i=(s[16]-s[10])*n[18],u=u*n[19]+s[4],o=r*n[12]+i+l*n[13]+c*n[14],a=-d*n[16]+u-m*n[17]+h*n[15],e[t+1]=o+a,e[t+2]=o-a,o=r*n[13]-i-l*n[14]+c*n[12],a=-d*n[17]+u-m*n[15]+h*n[16],e[t+9]=o+a,e[t+10]=o-a,o=r*n[14]-i+l*n[12]-c*n[13],a=d*n[15]-u+m*n[16]-h*n[17],e[t+13]=o+a,e[t+14]=o-a,p=s[8]-s[0],g=s[6]-s[2],v=s[5]-s[3],_=s[17]+s[9],b=s[16]+s[10],y=s[15]+s[11],x=s[14]+s[12],e[t+0]=_+y+x+(b+s[13]),o=(_+y+x)*n[19]-(b+s[13]),a=(p-g+v)*n[18],e[t+11]=o+a,e[t+12]=o-a,f=(s[7]-s[1])*n[18],b=s[13]-b*n[19],o=_*n[15]-b+y*n[16]+x*n[17],a=p*n[14]+f+g*n[12]+v*n[13],e[t+3]=o+a,e[t+4]=o-a,o=-_*n[17]+b-y*n[15]-x*n[16],a=p*n[13]+f-g*n[14]-v*n[12],e[t+7]=o+a,e[t+8]=o-a,o=-_*n[16]+b-y*n[17]-x*n[15],a=p*n[12]-f+g*n[13]-v*n[14],e[t+15]=o+a,e[t+16]=o-a}this.mdct_sub48=function(e,n,m){for(var h=n,p=286,f=0;f<e.channels_out;f++){for(var g=0;g<e.mode_gr;g++){for(var v,_=e.l3_side.tt[g][f],b=_.xr,y=0,x=e.sb_sample[f][1-g],w=0,k=0;k<9;k++)for(c(h,p,x[w]),c(h,p+32,x[w+1]),w+=2,p+=64,v=1;v<32;v+=2)x[w-1][v]*=-1;for(v=0;v<32;v++,y+=18){var M=_.block_type,S=e.sb_sample[f][g],R=e.sb_sample[f][1-g];if(0!=_.mixed_block_flag&&v<2&&(M=0),e.amp_filter[v]<1e-12)Ng.fill(b,y+0,y+18,0);else{if(e.amp_filter[v]<1)for(k=0;k<18;k++)R[k][l[v]]*=e.amp_filter[v];if(M==Jg.SHORT_TYPE){for(k=-t/4;k<0;k++){var A=o[Jg.SHORT_TYPE][k+3];b[y+3*k+9]=S[9+k][l[v]]*A-S[8-k][l[v]],b[y+3*k+18]=S[14-k][l[v]]*A+S[15+k][l[v]],b[y+3*k+10]=S[15+k][l[v]]*A-S[14-k][l[v]],b[y+3*k+19]=R[2-k][l[v]]*A+R[3+k][l[v]],b[y+3*k+11]=R[3+k][l[v]]*A-R[2-k][l[v]],b[y+3*k+20]=R[8-k][l[v]]*A+R[9+k][l[v]]}d(b,y)}else{var E=Hg(18);for(k=-s/4;k<0;k++){var T,I;T=o[M][k+27]*R[k+9][l[v]]+o[M][k+36]*R[8-k][l[v]],I=o[M][k+9]*S[k+9][l[v]]-o[M][k+18]*S[8-k][l[v]],E[k+9]=T-I*a[3+k+9],E[k+18]=T*a[3+k+9]+I}u(b,y,E)}}if(M!=Jg.SHORT_TYPE&&0!=v)for(k=7;k>=0;--k){var O,B;O=b[y+k]*r[20+k]+b[y+-1-k]*i[28+k],B=b[y+k]*i[28+k]-b[y+-1-k]*r[20+k],b[y+-1-k]=O,b[y+k]=B}}}if(h=m,p=286,1==e.mode_gr)for(var C=0;C<18;C++)Lg.arraycopy(e.sb_sample[f][1][C],0,e.sb_sample[f][0][C],0,32)}}}var Ug=jg.System,Fg=jg.new_float,$g=jg.new_float_n;function qg(){this.l=Fg(Jg.SBMAX_l),this.s=$g([Jg.SBMAX_s,3]);var e=this;this.assign=function(t){Ug.arraycopy(t.l,0,e.l,0,Jg.SBMAX_l);for(var s=0;s<Jg.SBMAX_s;s++)for(var o=0;o<3;o++)e.s[s][o]=t.s[s][o]}}function Vg(){this.thm=new qg,this.en=new qg}function zg(e){var t=e;this.ordinal=function(){return t}}zg.STEREO=new zg(0),zg.JOINT_STEREO=new zg(1),zg.DUAL_CHANNEL=new zg(2),zg.MONO=new zg(3),zg.NOT_SET=new zg(4);var Yg=jg.System,Xg=jg.VbrMode,Kg=jg.new_array_n,Gg=jg.new_float,Zg=jg.new_float_n,Wg=jg.new_int,Qg=jg.assert;function Jg(){var e=Jg.FFTOFFSET,t=Jg.MPG_MD_MS_LR,s=null;this.psy=null;var o=null,a=null,n=null;this.setModules=function(e,t,r,i){s=e,this.psy=t,o=t,a=i,n=r};var r=new Dg;function i(e){var t,s;if(0!=e.ATH.useAdjust)if(s=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(s+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(s+=s,t+=t),2==e.mode_gr&&(s=Math.max(s,t)),s*=.5,s*=e.ATH.aaSensitivityP,s>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var o=31.98*s+625e-6;e.ATH.adjust>=o?(e.ATH.adjust*=.075*o+.925,e.ATH.adjust<o&&(e.ATH.adjust=o)):e.ATH.adjustLimit>=o?e.ATH.adjust=o:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=o}else e.ATH.adjust=1}function l(e){var t,s;for(Qg(e.bitrate_index>=0&&e.bitrate_index<16),Qg(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(s=0;s<e.channels_out;++s){var o=0|e.l3_side.tt[t][s].block_type;0!=e.l3_side.tt[t][s].mixed_block_flag&&(o=4),e.bitrate_blockType_Hist[e.bitrate_index][o]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][o]++,e.bitrate_blockType_Hist[15][5]++}}function c(e,t){var s,o,a=e.internal_flags;if(0==a.lame_encode_frame_init){var n,i,l=Gg(2014),c=Gg(2014);for(a.lame_encode_frame_init=1,n=0,i=0;n<286+576*(1+a.mode_gr);++n)n<576*a.mode_gr?(l[n]=0,2==a.channels_out&&(c[n]=0)):(l[n]=t[0][i],2==a.channels_out&&(c[n]=t[1][i]),++i);for(o=0;o<a.mode_gr;o++)for(s=0;s<a.channels_out;s++)a.l3_side.tt[o][s].block_type=Jg.SHORT_TYPE;r.mdct_sub48(a,l,c),Qg(a.mf_size>=Jg.BLKSIZE+e.framesize-Jg.FFTOFFSET),Qg(a.mf_size>=512+e.framesize-32)}}this.lame_encode_mp3_frame=function(d,u,m,h,p,f){var g,v=Kg([2,2]);v[0][0]=new Vg,v[0][1]=new Vg,v[1][0]=new Vg,v[1][1]=new Vg;var _,b=Kg([2,2]);b[0][0]=new Vg,b[0][1]=new Vg,b[1][0]=new Vg,b[1][1]=new Vg;var y,x,w,k=[null,null],M=d.internal_flags,S=Zg([2,4]),R=[.5,.5],A=[[0,0],[0,0]],E=[[0,0],[0,0]];if(k[0]=u,k[1]=m,0==M.lame_encode_frame_init&&c(d,k),M.padding=0,(M.slot_lag-=M.frac_SpF)<0&&(M.slot_lag+=d.out_samplerate,M.padding=1),0!=M.psymodel){var T,I=[null,null],O=0,B=Wg(2);for(w=0;w<M.mode_gr;w++){for(x=0;x<M.channels_out;x++)I[x]=k[x],O=576+576*w-Jg.FFTOFFSET;if(T=d.VBR==Xg.vbr_mtrh||d.VBR==Xg.vbr_mt?o.L3psycho_anal_vbr(d,I,O,w,v,b,A[w],E[w],S[w],B):o.L3psycho_anal_ns(d,I,O,w,v,b,A[w],E[w],S[w],B),0!=T)return-4;for(d.mode==zg.JOINT_STEREO&&(R[w]=S[w][2]+S[w][3],R[w]>0&&(R[w]=S[w][3]/R[w])),x=0;x<M.channels_out;x++){var C=M.l3_side.tt[w][x];C.block_type=B[x],C.mixed_block_flag=0}}}else for(w=0;w<M.mode_gr;w++)for(x=0;x<M.channels_out;x++)M.l3_side.tt[w][x].block_type=Jg.NORM_TYPE,M.l3_side.tt[w][x].mixed_block_flag=0,E[w][x]=A[w][x]=700;if(i(M),r.mdct_sub48(M,k[0],k[1]),M.mode_ext=Jg.MPG_MD_LR_LR,d.force_ms)M.mode_ext=Jg.MPG_MD_MS_LR;else if(d.mode==zg.JOINT_STEREO){var j=0,L=0;for(w=0;w<M.mode_gr;w++)for(x=0;x<M.channels_out;x++)j+=E[w][x],L+=A[w][x];if(j<=1*L){var P=M.l3_side.tt[0],N=M.l3_side.tt[M.mode_gr-1];P[0].block_type==P[1].block_type&&N[0].block_type==N[1].block_type&&(M.mode_ext=Jg.MPG_MD_MS_LR)}}if(M.mode_ext==t?(_=b,y=E):(_=v,y=A),d.analysis&&null!=M.pinfo)for(w=0;w<M.mode_gr;w++)for(x=0;x<M.channels_out;x++)M.pinfo.ms_ratio[w]=M.ms_ratio[w],M.pinfo.ms_ener_ratio[w]=R[w],M.pinfo.blocktype[w][x]=M.l3_side.tt[w][x].block_type,M.pinfo.pe[w][x]=y[w][x],Yg.arraycopy(M.l3_side.tt[w][x].xr,0,M.pinfo.xr[w][x],0,576),M.mode_ext==t&&(M.pinfo.ers[w][x]=M.pinfo.ers[w][x+2],Yg.arraycopy(M.pinfo.energy[w][x+2],0,M.pinfo.energy[w][x],0,M.pinfo.energy[w][x].length));if(d.VBR==Xg.vbr_off||d.VBR==Xg.vbr_abr){var H,D;for(H=0;H<18;H++)M.nsPsy.pefirbuf[H]=M.nsPsy.pefirbuf[H+1];for(D=0,w=0;w<M.mode_gr;w++)for(x=0;x<M.channels_out;x++)D+=y[w][x];for(M.nsPsy.pefirbuf[18]=D,D=M.nsPsy.pefirbuf[9],H=0;H<9;H++)D+=(M.nsPsy.pefirbuf[H]+M.nsPsy.pefirbuf[18-H])*Jg.fircoef[H];for(D=3350*M.mode_gr*M.channels_out/D,w=0;w<M.mode_gr;w++)for(x=0;x<M.channels_out;x++)y[w][x]*=D}if(M.iteration_loop.iteration_loop(d,y,R,_),s.format_bitstream(d),g=s.copy_buffer(M,h,p,f,1),d.bWriteVbrTag&&a.addVbrFrame(d),d.analysis&&null!=M.pinfo){for(x=0;x<M.channels_out;x++){var U;for(U=0;U<e;U++)M.pinfo.pcmdata[x][U]=M.pinfo.pcmdata[x][U+d.framesize];for(U=e;U<1600;U++)M.pinfo.pcmdata[x][U]=k[x][U-e]}n.set_frame_pinfo(d,_)}return l(M),g}}Jg.ENCDELAY=576,Jg.POSTDELAY=1152,Jg.MDCTDELAY=48,Jg.FFTOFFSET=224+Jg.MDCTDELAY,Jg.DECDELAY=528,Jg.SBLIMIT=32,Jg.CBANDS=64,Jg.SBPSY_l=21,Jg.SBPSY_s=12,Jg.SBMAX_l=22,Jg.SBMAX_s=13,Jg.PSFB21=6,Jg.PSFB12=6,Jg.BLKSIZE=1024,Jg.HBLKSIZE=Jg.BLKSIZE/2+1,Jg.BLKSIZE_s=256,Jg.HBLKSIZE_s=Jg.BLKSIZE_s/2+1,Jg.NORM_TYPE=0,Jg.START_TYPE=1,Jg.SHORT_TYPE=2,Jg.STOP_TYPE=3,Jg.MPG_MD_LR_LR=0,Jg.MPG_MD_LR_I=1,Jg.MPG_MD_MS_LR=2,Jg.MPG_MD_MS_I=3,Jg.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var ev=jg.Util,tv=jg.new_float;function sv(){var e=tv(Jg.BLKSIZE),t=tv(Jg.BLKSIZE_s/2),s=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function o(e,t,o){var a,n,r,i=0;o<<=1;var l=t+o;a=4;do{var c,d,u,m,h,p,f;f=a>>1,m=a,h=a<<1,p=h+m,a=h<<1,n=t,r=n+f;do{w=e[n+0]-e[n+m],x=e[n+0]+e[n+m],R=e[n+h]-e[n+p],M=e[n+h]+e[n+p],e[n+h]=x-M,e[n+0]=x+M,e[n+p]=w-R,e[n+m]=w+R,w=e[r+0]-e[r+m],x=e[r+0]+e[r+m],R=ev.SQRT2*e[r+p],M=ev.SQRT2*e[r+h],e[r+h]=x-M,e[r+0]=x+M,e[r+p]=w-R,e[r+m]=w+R,r+=a,n+=a}while(n<l);for(d=s[i+0],c=s[i+1],u=1;u<f;u++){var g,v;g=1-2*c*c,v=2*c*d,n=t+u,r=t+m-u;do{var _,b,y,x,w,k,M,S,R,A;b=v*e[n+m]-g*e[r+m],_=g*e[n+m]+v*e[r+m],w=e[n+0]-_,x=e[n+0]+_,k=e[r+0]-b,y=e[r+0]+b,b=v*e[n+p]-g*e[r+p],_=g*e[n+p]+v*e[r+p],R=e[n+h]-_,M=e[n+h]+_,A=e[r+h]-b,S=e[r+h]+b,b=c*M-d*A,_=d*M+c*A,e[n+h]=x-_,e[n+0]=x+_,e[r+p]=k-b,e[r+m]=k+b,b=d*S-c*R,_=c*S+d*R,e[r+h]=y-_,e[r+0]=y+_,e[n+p]=w-b,e[n+m]=w+b,r+=a,n+=a}while(n<l);g=d,d=g*s[i+0]-c*s[i+1],c=g*s[i+1]+c*s[i+0]}i+=2}while(a<o)}var a=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,s,n,r,i){for(var l=0;l<3;l++){var c=Jg.BLKSIZE_s/2,d=65535&192*(l+1),u=Jg.BLKSIZE_s/8-1;do{var m,h,p,f,g,v=255&a[u<<2];m=t[v]*r[n][i+v+d],g=t[127-v]*r[n][i+v+d+128],h=m-g,m+=g,p=t[v+64]*r[n][i+v+d+64],g=t[63-v]*r[n][i+v+d+192],f=p-g,p+=g,c-=4,s[l][c+0]=m+p,s[l][c+2]=m-p,s[l][c+1]=h+f,s[l][c+3]=h-f,m=t[v+1]*r[n][i+v+d+1],g=t[126-v]*r[n][i+v+d+129],h=m-g,m+=g,p=t[v+65]*r[n][i+v+d+65],g=t[62-v]*r[n][i+v+d+193],f=p-g,p+=g,s[l][c+Jg.BLKSIZE_s/2+0]=m+p,s[l][c+Jg.BLKSIZE_s/2+2]=m-p,s[l][c+Jg.BLKSIZE_s/2+1]=h+f,s[l][c+Jg.BLKSIZE_s/2+3]=h-f}while(--u>=0);o(s[l],c,Jg.BLKSIZE_s/2)}},this.fft_long=function(t,s,n,r,i){var l=Jg.BLKSIZE/8-1,c=Jg.BLKSIZE/2;do{var d,u,m,h,p,f=255&a[l];d=e[f]*r[n][i+f],p=e[f+512]*r[n][i+f+512],u=d-p,d+=p,m=e[f+256]*r[n][i+f+256],p=e[f+768]*r[n][i+f+768],h=m-p,m+=p,c-=4,s[c+0]=d+m,s[c+2]=d-m,s[c+1]=u+h,s[c+3]=u-h,d=e[f+1]*r[n][i+f+1],p=e[f+513]*r[n][i+f+513],u=d-p,d+=p,m=e[f+257]*r[n][i+f+257],p=e[f+769]*r[n][i+f+769],h=m-p,m+=p,s[c+Jg.BLKSIZE/2+0]=d+m,s[c+Jg.BLKSIZE/2+2]=d-m,s[c+Jg.BLKSIZE/2+1]=u+h,s[c+Jg.BLKSIZE/2+3]=u-h}while(--l>=0);o(s,c,Jg.BLKSIZE/2)},this.init_fft=function(s){for(var o=0;o<Jg.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/Jg.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/Jg.BLKSIZE);for(o=0;o<Jg.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/Jg.BLKSIZE_s))}}var ov=jg.VbrMode,av=jg.Float,nv=jg.ShortBlock,rv=jg.Util,iv=jg.Arrays,lv=jg.new_float,cv=jg.new_float_n,dv=jg.new_int,uv=jg.assert;function mv(){var e=new sv,t=2.302585092994046,s=2,o=16,a=2,n=16,r=.34,i=1/217621504/(Jg.BLKSIZE/2),l=.01,c=.8,d=.6,u=.3,m=3.5,h=21,p=.2302585093;function f(e){return e}function g(e,t){for(var s=0,o=0;o<Jg.BLKSIZE/2;++o)s+=e[o]*t.ATH.eql_w[o];return s*=i,s}function v(t,s,o,a,n,r,i,l,c,d,u){var m=t.internal_flags;if(c<2)e.fft_long(m,a[n],c,d,u),e.fft_short(m,r[i],c,d,u);else if(2==c){for(var h=Jg.BLKSIZE-1;h>=0;--h){var p=a[n+0][h],v=a[n+1][h];a[n+0][h]=(p+v)*rv.SQRT2*.5,a[n+1][h]=(p-v)*rv.SQRT2*.5}for(var _=2;_>=0;--_)for(h=Jg.BLKSIZE_s-1;h>=0;--h){p=r[i+0][_][h],v=r[i+1][_][h];r[i+0][_][h]=(p+v)*rv.SQRT2*.5,r[i+1][_][h]=(p-v)*rv.SQRT2*.5}}s[0]=f(a[n+0][0]),s[0]*=s[0];for(h=Jg.BLKSIZE/2-1;h>=0;--h){var b=a[n+0][Jg.BLKSIZE/2-h],y=a[n+0][Jg.BLKSIZE/2+h];s[Jg.BLKSIZE/2-h]=f(.5*(b*b+y*y))}for(_=2;_>=0;--_){o[_][0]=r[i+0][_][0],o[_][0]*=o[_][0];for(h=Jg.BLKSIZE_s/2-1;h>=0;--h){b=r[i+0][_][Jg.BLKSIZE_s/2-h],y=r[i+0][_][Jg.BLKSIZE_s/2+h];o[_][Jg.BLKSIZE_s/2-h]=f(.5*(b*b+y*y))}}var x=0;for(h=11;h<Jg.HBLKSIZE;h++)x+=s[h];if(m.tot_ener[c]=x,t.analysis){for(h=0;h<Jg.HBLKSIZE;h++)m.pinfo.energy[l][c][h]=m.pinfo.energy_save[c][h],m.pinfo.energy_save[c][h]=s[h];m.pinfo.pe[l][c]=m.pe[c]}2==t.athaa_loudapprox&&c<2&&(m.loudness_sq[l][c]=m.loudness_sq_save[c],m.loudness_sq_save[c]=g(s,m))}var _,b,y,x=8,w=23,k=15,M=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){_=Math.pow(10,(x+1)/16),b=Math.pow(10,(w+1)/16),y=Math.pow(10,k/10)}var R=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],A=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],E=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function T(e,t,s,o,a,n){var r;if(t>e){if(!(t<e*b))return e+t;r=t/e}else{if(e>=t*b)return e+t;r=e/t}if(e+=t,o+3<=6){if(r>=_)return e;var i=0|rv.FAST_LOG10_X(r,16);return e*A[i]}var l,c;i=0|rv.FAST_LOG10_X(r,16);return t=0!=n?a.ATH.cb_s[s]*a.ATH.adjust:a.ATH.cb_l[s]*a.ATH.adjust,e<y*t?e>t?(l=1,i<=13&&(l=E[i]),c=rv.FAST_LOG10_X(e/t,10/15),e*((R[i]-l)*c+l)):i>13?e:e*E[i]:e*R[i]}var I=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function O(e,t,s){var o;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(o=t>e?t/e:e/t,s>=-2&&s<=2){if(o>=_)return e+t;var a=0|rv.FAST_LOG10_X(o,16);return(e+t)*I[a]}return o<b?e+t:(e<t&&(e=t),e)}function B(e,t){var s=e.internal_flags;if(s.channels_out>1){for(var o=0;o<Jg.SBMAX_l;o++){var a=s.thm[0].l[o],n=s.thm[1].l[o];s.thm[0].l[o]+=n*t,s.thm[1].l[o]+=a*t}for(o=0;o<Jg.SBMAX_s;o++)for(var r=0;r<3;r++){a=s.thm[0].s[o][r],n=s.thm[1].s[o][r];s.thm[0].s[o][r]+=n*t,s.thm[1].s[o][r]+=a*t}}}function C(e){for(var t=0;t<Jg.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var s=e.mld_l[t]*e.en[3].l[t],o=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],s));s=e.mld_l[t]*e.en[2].l[t];var a=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],s));e.thm[2].l[t]=o,e.thm[3].l[t]=a}for(t=0;t<Jg.SBMAX_s;t++)for(var n=0;n<3;n++)if(!(e.thm[0].s[t][n]>1.58*e.thm[1].s[t][n]||e.thm[1].s[t][n]>1.58*e.thm[0].s[t][n])){s=e.mld_s[t]*e.en[3].s[t][n],o=Math.max(e.thm[2].s[t][n],Math.min(e.thm[3].s[t][n],s));s=e.mld_s[t]*e.en[2].s[t][n];a=Math.max(e.thm[3].s[t][n],Math.min(e.thm[2].s[t][n],s));e.thm[2].s[t][n]=o,e.thm[3].s[t][n]=a}}function j(e,t,s){var o=t,a=Math.pow(10,s);t*=2,o*=2;for(var n=0;n<Jg.SBMAX_l;n++){if(u=e.ATH.cb_l[e.bm_l[n]]*a,l=Math.min(Math.max(e.thm[0].l[n],u),Math.max(e.thm[1].l[n],u)),c=Math.max(e.thm[2].l[n],u),d=Math.max(e.thm[3].l[n],u),l*t<c+d){var r=l*o/(c+d);c*=r,d*=r}e.thm[2].l[n]=Math.min(c,e.thm[2].l[n]),e.thm[3].l[n]=Math.min(d,e.thm[3].l[n])}a*=Jg.BLKSIZE_s/Jg.BLKSIZE;for(n=0;n<Jg.SBMAX_s;n++)for(var i=0;i<3;i++){var l,c,d,u;if(u=e.ATH.cb_s[e.bm_s[n]]*a,l=Math.min(Math.max(e.thm[0].s[n][i],u),Math.max(e.thm[1].s[n][i],u)),c=Math.max(e.thm[2].s[n][i],u),d=Math.max(e.thm[3].s[n][i],u),l*t<c+d){r=l*t/(c+d);c*=r,d*=r}e.thm[2].s[n][i]=Math.min(e.thm[2].s[n][i],c),e.thm[3].s[n][i]=Math.min(e.thm[3].s[n][i],d)}}function L(e,t,s,o,a){var n,r,i=0,l=0;for(n=r=0;n<Jg.SBMAX_s;++r,++n){var c=e.bo_s[n],d=e.npart_s,u=c<d?c:d;while(r<u)uv(t[r]>=0),uv(s[r]>=0),i+=t[r],l+=s[r],r++;if(e.en[o].s[n][a]=i,e.thm[o].s[n][a]=l,r>=d){++n;break}uv(t[r]>=0),uv(s[r]>=0);var m=e.PSY.bo_s_weight[n],h=1-m;i=m*t[r],l=m*s[r],e.en[o].s[n][a]+=i,e.thm[o].s[n][a]+=l,i=h*t[r],l=h*s[r]}for(;n<Jg.SBMAX_s;++n)e.en[o].s[n][a]=0,e.thm[o].s[n][a]=0}function P(e,t,s,o){var a,n,r=0,i=0;for(a=n=0;a<Jg.SBMAX_l;++n,++a){var l=e.bo_l[a],c=e.npart_l,d=l<c?l:c;while(n<d)uv(t[n]>=0),uv(s[n]>=0),r+=t[n],i+=s[n],n++;if(e.en[o].l[a]=r,e.thm[o].l[a]=i,n>=c){++a;break}uv(t[n]>=0),uv(s[n]>=0);var u=e.PSY.bo_l_weight[a],m=1-u;r=u*t[n],i=u*s[n],e.en[o].l[a]+=r,e.thm[o].l[a]+=i,r=m*t[n],i=m*s[n]}for(;a<Jg.SBMAX_l;++a)e.en[o].l[a]=0,e.thm[o].l[a]=0}function N(e,t,s,o,r,i){var l,c,d=e.internal_flags;for(c=l=0;c<d.npart_s;++c){for(var u=0,m=d.numlines_s[c],h=0;h<m;++h,++l){var p=t[i][l];u+=p}s[c]=u}for(uv(c==d.npart_s),l=c=0;c<d.npart_s;c++){var f=d.s3ind_s[c][0],g=d.s3_ss[l++]*s[f];++f;while(f<=d.s3ind_s[c][1])g+=d.s3_ss[l]*s[f],++l,++f;var v=a*d.nb_s1[r][c];if(o[c]=Math.min(g,v),d.blocktype_old[1&r]==Jg.SHORT_TYPE){v=n*d.nb_s2[r][c];var _=o[c];o[c]=Math.min(v,_)}d.nb_s2[r][c]=d.nb_s1[r][c],d.nb_s1[r][c]=g,uv(o[c]>=0)}for(;c<=Jg.CBANDS;++c)s[c]=0,o[c]=0}function H(e,t,s,o){var a=e.internal_flags;e.short_blocks!=nv.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<a.channels_out;n++)o[n]=Jg.NORM_TYPE,e.short_blocks==nv.short_block_dispensed&&(t[n]=1),e.short_blocks==nv.short_block_forced&&(t[n]=0),0!=t[n]?(uv(a.blocktype_old[n]!=Jg.START_TYPE),a.blocktype_old[n]==Jg.SHORT_TYPE&&(o[n]=Jg.STOP_TYPE)):(o[n]=Jg.SHORT_TYPE,a.blocktype_old[n]==Jg.NORM_TYPE&&(a.blocktype_old[n]=Jg.START_TYPE),a.blocktype_old[n]==Jg.STOP_TYPE&&(a.blocktype_old[n]=Jg.SHORT_TYPE)),s[n]=a.blocktype_old[n],a.blocktype_old[n]=o[n]}function D(e,t,s){return s>=1?e:s<=0?t:t>0?Math.pow(e/t,s)*t:0}var U=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function F(e,s){for(var o=309.07,a=0;a<Jg.SBMAX_s-1;a++)for(var n=0;n<3;n++){var r=e.thm.s[a][n];if(r>0){var i=r*s,l=e.en.s[a][n];l>i&&(o+=l>1e10*i?U[a]*(10*t):U[a]*rv.FAST_LOG10(l/i))}}return o}var $=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function q(e,s){for(var o=281.0575,a=0;a<Jg.SBMAX_l-1;a++){var n=e.thm.l[a];if(n>0){var r=n*s,i=e.en.l[a];i>r&&(o+=i>1e10*r?$[a]*(10*t):$[a]*rv.FAST_LOG10(i/r))}}return o}function V(e,t,s,o,a){var n,r;for(n=r=0;n<e.npart_l;++n){var i,l=0,c=0;for(i=0;i<e.numlines_l[n];++i,++r){var d=t[r];l+=d,c<d&&(c=d)}s[n]=l,o[n]=c,a[n]=l*e.rnumlines_l[n],uv(e.rnumlines_l[n]>=0),uv(s[n]>=0),uv(o[n]>=0),uv(a[n]>=0)}}function z(e,t,s,o){var a=M.length-1,n=0,r=s[n]+s[n+1];if(r>0){var i=t[n];i<t[n+1]&&(i=t[n+1]),uv(e.numlines_l[n]+e.numlines_l[n+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[n]+e.numlines_l[n+1]-1));var l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;for(n=1;n<e.npart_l-1;n++)if(r=s[n-1]+s[n]+s[n+1],r>0){i=t[n-1];i<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),uv(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1));l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;if(uv(n==e.npart_l-1),r=s[n-1]+s[n],r>0){i=t[n-1];i<t[n]&&(i=t[n]),uv(e.numlines_l[n-1]+e.numlines_l[n]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]-1));l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;uv(n==e.npart_l-1)}var Y=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function X(t,s,o,a,n,r,i,l){var c=t.internal_flags;if(a<2)e.fft_long(c,i[l],a,s,o);else if(2==a)for(var d=Jg.BLKSIZE-1;d>=0;--d){var u=i[l+0][d],m=i[l+1][d];i[l+0][d]=(u+m)*rv.SQRT2*.5,i[l+1][d]=(u-m)*rv.SQRT2*.5}r[0]=f(i[l+0][0]),r[0]*=r[0];for(d=Jg.BLKSIZE/2-1;d>=0;--d){var h=i[l+0][Jg.BLKSIZE/2-d],p=i[l+0][Jg.BLKSIZE/2+d];r[Jg.BLKSIZE/2-d]=f(.5*(h*h+p*p))}var g=0;for(d=11;d<Jg.HBLKSIZE;d++)g+=r[d];if(c.tot_ener[a]=g,t.analysis){for(d=0;d<Jg.HBLKSIZE;d++)c.pinfo.energy[n][a][d]=c.pinfo.energy_save[a][d],c.pinfo.energy_save[a][d]=r[d];c.pinfo.pe[n][a]=c.pe[a]}}function K(t,s,o,a,n,r,i,l){var c=t.internal_flags;if(0==n&&a<2&&e.fft_short(c,i[l],a,s,o),2==a)for(var d=Jg.BLKSIZE_s-1;d>=0;--d){var u=i[l+0][n][d],m=i[l+1][n][d];i[l+0][n][d]=(u+m)*rv.SQRT2*.5,i[l+1][n][d]=(u-m)*rv.SQRT2*.5}r[n][0]=i[l+0][n][0],r[n][0]*=r[n][0];for(d=Jg.BLKSIZE_s/2-1;d>=0;--d){var h=i[l+0][n][Jg.BLKSIZE_s/2-d],p=i[l+0][n][Jg.BLKSIZE_s/2+d];r[n][Jg.BLKSIZE_s/2-d]=f(.5*(h*h+p*p))}}function G(e,t,s,o){var a=e.internal_flags;2==e.athaa_loudapprox&&s<2&&(a.loudness_sq[t][s]=a.loudness_sq_save[s],a.loudness_sq_save[s]=g(o,a))}this.L3psycho_anal_ns=function(e,t,a,n,r,i,l,m,p,f){var g,_,b,y,x,w,k,S,R,A,E=e.internal_flags,I=cv([2,Jg.BLKSIZE]),O=cv([2,3,Jg.BLKSIZE_s]),U=lv(Jg.CBANDS+1),$=lv(Jg.CBANDS+1),X=lv(Jg.CBANDS+2),K=dv(2),G=dv(2),Z=cv([2,576]),W=dv(Jg.CBANDS+2),Q=dv(Jg.CBANDS+2);for(iv.fill(Q,0),g=E.channels_out,e.mode==zg.JOINT_STEREO&&(g=4),R=e.VBR==ov.vbr_off?0==E.ResvMax?0:E.ResvSize/E.ResvMax*.5:e.VBR==ov.vbr_rh||e.VBR==ov.vbr_mtrh||e.VBR==ov.vbr_mt?.6:1,_=0;_<E.channels_out;_++){var J=t[_],ee=a+576-350-h+192;for(y=0;y<576;y++){var te,se;for(te=J[ee+y+10],se=0,x=0;x<(h-1)/2-1;x+=2)te+=Y[x]*(J[ee+y+x]+J[ee+y+h-x]),se+=Y[x+1]*(J[ee+y+x+1]+J[ee+y+h-x-1]);Z[_][y]=te+se}r[n][_].en.assign(E.en[_]),r[n][_].thm.assign(E.thm[_]),g>2&&(i[n][_].en.assign(E.en[_+2]),i[n][_].thm.assign(E.thm[_+2]))}for(_=0;_<g;_++){var oe,ae,ne,re=lv(12),ie=[0,0,0,0],le=lv(12),ce=1,de=lv(Jg.CBANDS),ue=lv(Jg.CBANDS),me=[0,0,0,0],he=lv(Jg.HBLKSIZE),pe=cv([3,Jg.HBLKSIZE_s]);for(uv(E.npart_s<=Jg.CBANDS),uv(E.npart_l<=Jg.CBANDS),y=0;y<3;y++)re[y]=E.nsPsy.last_en_subshort[_][y+6],uv(E.nsPsy.last_en_subshort[_][y+4]>0),le[y]=re[y]/E.nsPsy.last_en_subshort[_][y+4],ie[0]+=re[y];if(2==_)for(y=0;y<576;y++){var fe,ge;fe=Z[0][y],ge=Z[1][y],Z[0][y]=fe+ge,Z[1][y]=fe-ge}var ve=Z[1&_],_e=0;for(y=0;y<9;y++){for(var be=_e+64,ye=1;_e<be;_e++)ye<Math.abs(ve[_e])&&(ye=Math.abs(ve[_e]));E.nsPsy.last_en_subshort[_][y]=re[y+3]=ye,ie[1+y/3]+=ye,ye>re[y+3-2]?(uv(re[y+3-2]>0),ye/=re[y+3-2]):ye=re[y+3-2]>10*ye?re[y+3-2]/(10*ye):0,le[y+3]=ye}if(e.analysis){var xe=le[0];for(y=1;y<12;y++)xe<le[y]&&(xe=le[y]);E.pinfo.ers[n][_]=E.pinfo.ers_save[_],E.pinfo.ers_save[_]=xe}for(ne=3==_?E.nsPsy.attackthre_s:E.nsPsy.attackthre,y=0;y<12;y++)0==me[y/3]&&le[y]>ne&&(me[y/3]=y%3+1);for(y=1;y<4;y++){var we;ie[y-1]>ie[y]?(uv(ie[y]>0),we=ie[y-1]/ie[y]):(uv(ie[y-1]>0),we=ie[y]/ie[y-1]),we<1.7&&(me[y]=0,1==y&&(me[0]=0))}for(0!=me[0]&&0!=E.nsPsy.lastAttacks[_]&&(me[0]=0),3!=E.nsPsy.lastAttacks[_]&&me[0]+me[1]+me[2]+me[3]==0||(ce=0,0!=me[1]&&0!=me[0]&&(me[1]=0),0!=me[2]&&0!=me[1]&&(me[2]=0),0!=me[3]&&0!=me[2]&&(me[3]=0)),_<2?G[_]=ce:0==ce&&(G[0]=G[1]=0),p[_]=E.tot_ener[_],ae=O,oe=I,v(e,he,pe,oe,1&_,ae,1&_,n,_,t,a),V(E,he,U,de,ue),z(E,de,ue,W),S=0;S<3;S++){var ke,Me;for(N(e,pe,$,X,_,S),L(E,$,X,_,S),k=0;k<Jg.SBMAX_s;k++){if(Me=E.thm[_].s[k][S],Me*=c,me[S]>=2||1==me[S+1]){var Se=0!=S?S-1:2;ye=D(E.thm[_].s[k][Se],Me,d*R);Me=Math.min(Me,ye)}if(1==me[S]){Se=0!=S?S-1:2,ye=D(E.thm[_].s[k][Se],Me,u*R);Me=Math.min(Me,ye)}else if(0!=S&&3==me[S-1]||0==S&&3==E.nsPsy.lastAttacks[_]){Se=2!=S?S+1:0,ye=D(E.thm[_].s[k][Se],Me,u*R);Me=Math.min(Me,ye)}ke=re[3*S+3]+re[3*S+4]+re[3*S+5],6*re[3*S+5]<ke&&(Me*=.5,6*re[3*S+4]<ke&&(Me*=.5)),E.thm[_].s[k][S]=Me}}for(E.nsPsy.lastAttacks[_]=me[2],w=0,b=0;b<E.npart_l;b++){var Re=E.s3ind[b][0],Ae=U[Re]*M[W[Re]],Ee=E.s3_ll[w++]*Ae;while(++Re<=E.s3ind[b][1])Ae=U[Re]*M[W[Re]],Ee=T(Ee,E.s3_ll[w++]*Ae,Re,Re-b,E,0);Ee*=.158489319246111,E.blocktype_old[1&_]==Jg.SHORT_TYPE?X[b]=Ee:X[b]=D(Math.min(Ee,Math.min(s*E.nb_1[_][b],o*E.nb_2[_][b])),Ee,R),E.nb_2[_][b]=E.nb_1[_][b],E.nb_1[_][b]=Ee}for(;b<=Jg.CBANDS;++b)U[b]=0,X[b]=0;P(E,U,X,_)}(e.mode!=zg.STEREO&&e.mode!=zg.JOINT_STEREO||e.interChRatio>0&&B(e,e.interChRatio),e.mode==zg.JOINT_STEREO)&&(C(E),A=e.msfix,Math.abs(A)>0&&j(E,A,e.ATHlower*E.ATH.adjust));for(H(e,G,f,K),_=0;_<g;_++){var Te,Ie,Oe,Be=0;_>1?(Te=m,Be=-2,Ie=Jg.NORM_TYPE,f[0]!=Jg.SHORT_TYPE&&f[1]!=Jg.SHORT_TYPE||(Ie=Jg.SHORT_TYPE),Oe=i[n][_-2]):(Te=l,Be=0,Ie=f[_],Oe=r[n][_]),Ie==Jg.SHORT_TYPE?Te[Be+_]=F(Oe,E.masking_lower):Te[Be+_]=q(Oe,E.masking_lower),e.analysis&&(E.pinfo.pe[n][_]=Te[Be+_])}return 0};var Z=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function W(e,t,s,o,a,n,r,i,l,c){for(var d=cv([2,576]),u=e.internal_flags,m=u.channels_out,p=e.mode==zg.JOINT_STEREO?4:m,f=0;f<m;f++){firbuf=t[f];for(var g=s+576-350-h+192,v=0;v<576;v++){var _,b;_=firbuf[g+v+10],b=0;for(var y=0;y<(h-1)/2-1;y+=2)_+=Z[y]*(firbuf[g+v+y]+firbuf[g+v+h-y]),b+=Z[y+1]*(firbuf[g+v+y+1]+firbuf[g+v+h-y-1]);d[f][v]=_+b}a[o][f].en.assign(u.en[f]),a[o][f].thm.assign(u.thm[f]),p>2&&(n[o][f].en.assign(u.en[f+2]),n[o][f].thm.assign(u.thm[f+2]))}for(f=0;f<p;f++){var x=lv(12),w=lv(12),k=[0,0,0,0],M=d[1&f],S=0,R=3==f?u.nsPsy.attackthre_s:u.nsPsy.attackthre,A=1;if(2==f)for(v=0,y=576;y>0;++v,--y){var E=d[0][v],T=d[1][v];d[0][v]=E+T,d[1][v]=E-T}for(v=0;v<3;v++)w[v]=u.nsPsy.last_en_subshort[f][v+6],uv(u.nsPsy.last_en_subshort[f][v+4]>0),x[v]=w[v]/u.nsPsy.last_en_subshort[f][v+4],k[0]+=w[v];for(v=0;v<9;v++){for(var I=S+64,O=1;S<I;S++)O<Math.abs(M[S])&&(O=Math.abs(M[S]));u.nsPsy.last_en_subshort[f][v]=w[v+3]=O,k[1+v/3]+=O,O>w[v+3-2]?(uv(w[v+3-2]>0),O/=w[v+3-2]):O=w[v+3-2]>10*O?w[v+3-2]/(10*O):0,x[v+3]=O}for(v=0;v<3;++v){var B=w[3*v+3]+w[3*v+4]+w[3*v+5],C=1;6*w[3*v+5]<B&&(C*=.5,6*w[3*v+4]<B&&(C*=.5)),i[f][v]=C}if(e.analysis){var j=x[0];for(v=1;v<12;v++)j<x[v]&&(j=x[v]);u.pinfo.ers[o][f]=u.pinfo.ers_save[f],u.pinfo.ers_save[f]=j}for(v=0;v<12;v++)0==l[f][v/3]&&x[v]>R&&(l[f][v/3]=v%3+1);for(v=1;v<4;v++){var L=k[v-1],P=k[v],N=Math.max(L,P);N<4e4&&L<1.7*P&&P<1.7*L&&(1==v&&l[f][0]<=l[f][v]&&(l[f][0]=0),l[f][v]=0)}l[f][0]<=u.nsPsy.lastAttacks[f]&&(l[f][0]=0),3!=u.nsPsy.lastAttacks[f]&&l[f][0]+l[f][1]+l[f][2]+l[f][3]==0||(A=0,0!=l[f][1]&&0!=l[f][0]&&(l[f][1]=0),0!=l[f][2]&&0!=l[f][1]&&(l[f][2]=0),0!=l[f][3]&&0!=l[f][2]&&(l[f][3]=0)),f<2?c[f]=A:0==A&&(c[0]=c[1]=0),r[f]=u.tot_ener[f]}}function Q(e,t,s){if(0==s)for(var o=0;o<e.npart_s;o++)e.nb_s2[t][o]=e.nb_s1[t][o],e.nb_s1[t][o]=0}function J(e,t){for(var s=0;s<e.npart_l;s++)e.nb_2[t][s]=e.nb_1[t][s],e.nb_1[t][s]=0}function ee(e,t,s,o){var a=M.length-1,n=0,r=s[n]+s[n+1];if(r>0){var i=t[n];i<t[n+1]&&(i=t[n+1]),uv(e.numlines_s[n]+e.numlines_s[n+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[n]+e.numlines_s[n+1]-1));var l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;for(n=1;n<e.npart_s-1;n++)if(r=s[n-1]+s[n]+s[n+1],uv(n+1<e.npart_s),r>0){i=t[n-1];i<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),uv(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1));l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;if(uv(n==e.npart_s-1),r=s[n-1]+s[n],r>0){i=t[n-1];i<t[n]&&(i=t[n]),uv(e.numlines_s[n-1]+e.numlines_s[n]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]-1));l=0|r;l>a&&(l=a),o[n]=l}else o[n]=0;uv(n==e.npart_s-1)}function te(e,t,s,o,a,n){var r,i,l,c=e.internal_flags,d=new float[Jg.CBANDS],u=lv(Jg.CBANDS),m=new int[Jg.CBANDS];for(l=i=0;l<c.npart_s;++l){var h=0,p=0,f=c.numlines_s[l];for(r=0;r<f;++r,++i){var g=t[n][i];h+=g,p<g&&(p=g)}s[l]=h,d[l]=p,u[l]=h/f,uv(u[l]>=0)}for(uv(l==c.npart_s);l<Jg.CBANDS;++l)d[l]=0,u[l]=0;for(ee(c,d,u,m),i=l=0;l<c.npart_s;l++){var v,_,b,y,x,w=c.s3ind_s[l][0],k=c.s3ind_s[l][1];v=m[w],_=1,y=c.s3_ss[i]*s[w]*M[m[w]],++i,++w;while(w<=k)v+=m[w],_+=1,b=c.s3_ss[i]*s[w]*M[m[w]],y=O(y,b,w-l),++i,++w;v=(1+2*v)/(2*_),x=.5*M[v],y*=x,o[l]=y,c.nb_s2[a][l]=c.nb_s1[a][l],c.nb_s1[a][l]=y,b=d[l],b*=c.minval_s[l],b*=x,o[l]>b&&(o[l]=b),c.masking_lower>1&&(o[l]*=c.masking_lower),o[l]>s[l]&&(o[l]=s[l]),c.masking_lower<1&&(o[l]*=c.masking_lower),uv(o[l]>=0)}for(;l<Jg.CBANDS;++l)s[l]=0,o[l]=0}function se(e,t,a,n,r){var i,l=lv(Jg.CBANDS),c=lv(Jg.CBANDS),d=dv(Jg.CBANDS+2);V(e,t,a,l,c),z(e,l,c,d);var m=0;for(i=0;i<e.npart_l;i++){var h,p,f,g,v=e.s3ind[i][0],_=e.s3ind[i][1],b=0,y=0;b=d[v],y+=1,p=e.s3_ll[m]*a[v]*M[d[v]],++m,++v;while(v<=_)b+=d[v],y+=1,h=e.s3_ll[m]*a[v]*M[d[v]],g=O(p,h,v-i),p=g,++m,++v;if(b=(1+2*b)/(2*y),f=.5*M[b],p*=f,e.blocktype_old[1&r]==Jg.SHORT_TYPE){var x=s*e.nb_1[r][i];n[i]=x>0?Math.min(p,x):Math.min(p,a[i]*u)}else{var w=o*e.nb_2[r][i],k=s*e.nb_1[r][i];w<=0&&(w=p),k<=0&&(k=p),x=e.blocktype_old[1&r]==Jg.NORM_TYPE?Math.min(k,w):k,n[i]=Math.min(p,x)}e.nb_2[r][i]=e.nb_1[r][i],e.nb_1[r][i]=p,h=l[i],h*=e.minval_l[i],h*=f,n[i]>h&&(n[i]=h),e.masking_lower>1&&(n[i]*=e.masking_lower),n[i]>a[i]&&(n[i]=a[i]),e.masking_lower<1&&(n[i]*=e.masking_lower),uv(n[i]>=0)}for(;i<Jg.CBANDS;++i)a[i]=0,n[i]=0}function oe(e,t){var s=e.internal_flags;e.short_blocks!=nv.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var o=0;o<s.channels_out;o++)e.short_blocks==nv.short_block_dispensed&&(t[o]=1),e.short_blocks==nv.short_block_forced&&(t[o]=0)}function ae(e,t,s){for(var o=e.internal_flags,a=0;a<o.channels_out;a++){var n=Jg.NORM_TYPE;0!=t[a]?(uv(o.blocktype_old[a]!=Jg.START_TYPE),o.blocktype_old[a]==Jg.SHORT_TYPE&&(n=Jg.STOP_TYPE)):(n=Jg.SHORT_TYPE,o.blocktype_old[a]==Jg.NORM_TYPE&&(o.blocktype_old[a]=Jg.START_TYPE),o.blocktype_old[a]==Jg.STOP_TYPE&&(o.blocktype_old[a]=Jg.SHORT_TYPE)),s[a]=o.blocktype_old[a],o.blocktype_old[a]=n}}function ne(e,t,s,o,a,n,r){for(var i,l,c=2*n,d=n>0?Math.pow(10,a):1,u=0;u<r;++u){var m=e[2][u],h=e[3][u],p=t[0][u],f=t[1][u],g=t[2][u],v=t[3][u];if(p<=1.58*f&&f<=1.58*p){var _=s[u]*h,b=s[u]*m;l=Math.max(g,Math.min(v,_)),i=Math.max(v,Math.min(g,b))}else l=g,i=v;if(n>0){var y,x,w=o[u]*d;if(y=Math.min(Math.max(p,w),Math.max(f,w)),g=Math.max(l,w),v=Math.max(i,w),x=g+v,x>0&&y*c<x){var k=y*c/x;g*=k,v*=k}l=Math.min(g,l),i=Math.min(v,i)}l>m&&(l=m),i>h&&(i=h),t[2][u]=l,t[3][u]=i}}function re(e,t){var s,o=e;return s=o>=0?27*-o:o*t,s<=-72?0:Math.exp(s*p)}function ie(e){var t=0,s=0,o=0;for(o=0;re(o,e)>1e-20;o-=1);a=o,n=0;while(Math.abs(n-a)>1e-12)o=(n+a)/2,re(o,e)>0?n=o:a=o;t=a;var a,n;o=0;for(o=0;re(o,e)>1e-20;o+=1);a=0,n=o;while(Math.abs(n-a)>1e-12)o=(n+a)/2,re(o,e)>0?a=o:n=o;s=n;var r,i=0,l=1e3;for(r=0;r<=l;++r){o=t+r*(s-t)/l;var c=re(o,e);i+=c}var d=(l+1)/(i*(s-t));return d}function le(e){var t,s,o,a;return t=e,t*=t>=0?3:1.5,t>=.5&&t<=2.5?(a=t-.5,s=8*(a*a-2*a)):s=0,t+=.474,o=15.811389+7.5*t-17.5*Math.sqrt(1+t*t),o<=-60?0:(t=Math.exp((s+o)*p),t/=.6609193,t)}function ce(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function de(e,t,s,o,a,n,i,l,c,d,u,m){var h,p=lv(Jg.CBANDS+1),f=l/(m>15?1152:384),g=dv(Jg.HBLKSIZE);l/=c;var v=0,_=0;for(h=0;h<Jg.CBANDS;h++){var b;for(E=ce(l*v),p[h]=l*v,b=v;ce(l*b)-E<r&&b<=c/2;b++);e[h]=b-v,_=h+1;while(v<b)g[v++]=h;if(v>c/2){v=c/2,++h;break}}p[h]=l*v;for(var y=0;y<m;y++){var x,w,k,M,S;k=d[y],M=d[y+1],x=0|Math.floor(.5+u*(k-.5)),x<0&&(x=0),w=0|Math.floor(.5+u*(M-.5)),w>c/2&&(w=c/2),s[y]=(g[x]+g[w])/2,t[y]=g[w];var R=f*M;i[y]=(R-p[t[y]])/(p[t[y]+1]-p[t[y]]),i[y]<0?i[y]=0:i[y]>1&&(i[y]=1),S=ce(l*d[y]*u),S=Math.min(S,15.5)/15.5,n[y]=Math.pow(10,1.25*(1-Math.cos(Math.PI*S))-2.5)}v=0;for(var A=0;A<_;A++){var E,T,I=e[A];E=ce(l*v),T=ce(l*(v+I-1)),o[A]=.5*(E+T),E=ce(l*(v-.5)),T=ce(l*(v+I-.5)),a[A]=T-E,v+=I}return _}function ue(e,t,s,o,a,n){var r,i=cv([Jg.CBANDS,Jg.CBANDS]),l=0;if(n)for(var c=0;c<t;c++)for(r=0;r<t;r++){var d=le(s[c]-s[r])*o[r];i[c][r]=d*a[c]}else for(r=0;r<t;r++){var u=15+Math.min(21/s[r],12),m=ie(u);for(c=0;c<t;c++){d=m*re(s[c]-s[r],u)*o[r];i[c][r]=d*a[c]}}for(c=0;c<t;c++){for(r=0;r<t;r++)if(i[c][r]>0)break;for(e[c][0]=r,r=t-1;r>0;r--)if(i[c][r]>0)break;e[c][1]=r,l+=e[c][1]-e[c][0]+1}var h=lv(l),p=0;for(c=0;c<t;c++)for(r=e[c][0];r<=e[c][1];r++)h[p++]=i[c][r];return h}function me(e){var t=ce(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function he(e,t){e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e);var s=3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4);return s}this.L3psycho_anal_vbr=function(e,t,s,o,a,n,r,i,l,m){var h,p,f=e.internal_flags,g=lv(Jg.HBLKSIZE),v=cv([3,Jg.HBLKSIZE_s]),_=cv([2,Jg.BLKSIZE]),b=cv([2,3,Jg.BLKSIZE_s]),y=cv([4,Jg.CBANDS]),x=cv([4,Jg.CBANDS]),w=cv([4,3]),k=.6,M=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],S=dv(2),R=e.mode==zg.JOINT_STEREO?4:f.channels_out;W(e,t,s,o,a,n,l,w,M,S),oe(e,S);for(var A=0;A<R;A++){var E=1&A;h=_,X(e,t,s,A,o,g,h,E),G(e,o,A,g),0!=S[E]?se(f,g,y[A],x[A],A):J(f,A)}S[0]+S[1]==2&&e.mode==zg.JOINT_STEREO&&ne(y,x,f.mld_cb_l,f.ATH.cb_l,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_l);for(A=0;A<R;A++){E=1&A;0!=S[E]&&P(f,y[A],x[A],A)}for(var T=0;T<3;T++){for(A=0;A<R;++A){E=1&A;0!=S[E]?Q(f,A,T):(p=b,K(e,t,s,A,T,v,p,E),te(e,v,y[A],x[A],A,T))}S[0]+S[1]==0&&e.mode==zg.JOINT_STEREO&&ne(y,x,f.mld_cb_s,f.ATH.cb_s,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_s);for(A=0;A<R;++A){E=1&A;0==S[E]&&L(f,y[A],x[A],A,T)}}for(A=0;A<R;A++){E=1&A;if(0==S[E])for(var I=0;I<Jg.SBMAX_s;I++){var O=lv(3);for(T=0;T<3;T++){var B=f.thm[A].s[I][T];if(B*=c,M[A][T]>=2||1==M[A][T+1]){var C=0!=T?T-1:2,j=D(f.thm[A].s[I][C],B,d*k);B=Math.min(B,j)}else if(1==M[A][T]){C=0!=T?T-1:2,j=D(f.thm[A].s[I][C],B,u*k);B=Math.min(B,j)}else if(0!=T&&3==M[A][T-1]||0==T&&3==f.nsPsy.lastAttacks[A]){C=2!=T?T+1:0,j=D(f.thm[A].s[I][C],B,u*k);B=Math.min(B,j)}B*=w[A][T],O[T]=B}for(T=0;T<3;T++)f.thm[A].s[I][T]=O[T]}}for(A=0;A<R;A++)f.nsPsy.lastAttacks[A]=M[A][2];ae(e,S,m);for(A=0;A<R;A++){var N,H,U,$;A>1?(N=i,H=-2,U=Jg.NORM_TYPE,m[0]!=Jg.SHORT_TYPE&&m[1]!=Jg.SHORT_TYPE||(U=Jg.SHORT_TYPE),$=n[o][A-2]):(N=r,H=0,U=m[A],$=a[o][A]),U==Jg.SHORT_TYPE?N[H+A]=F($,f.masking_lower):N[H+A]=q($,f.masking_lower),e.analysis&&(f.pinfo.pe[o][A]=N[H+A])}return 0},this.psymodel_init=function(s){var o,a=s.internal_flags,n=!0,r=13,i=24,c=0,d=0,u=-8.25,h=-4.5,p=lv(Jg.CBANDS),f=lv(Jg.CBANDS),g=lv(Jg.CBANDS),v=s.out_samplerate;switch(s.experimentalZ){default:case 0:n=!0;break;case 1:n=!(s.VBR==ov.vbr_mtrh||s.VBR==ov.vbr_mt);break;case 2:n=!1;break;case 3:r=8,c=-1.75,d=-.0125,u=-8.25,h=-2.25;break}for(a.ms_ener_ratio_old=.25,a.blocktype_old[0]=a.blocktype_old[1]=Jg.NORM_TYPE,o=0;o<4;++o){for(var _=0;_<Jg.CBANDS;++_)a.nb_1[o][_]=1e20,a.nb_2[o][_]=1e20,a.nb_s1[o][_]=a.nb_s2[o][_]=1;for(var b=0;b<Jg.SBMAX_l;b++)a.en[o].l[b]=1e20,a.thm[o].l[b]=1e20;for(_=0;_<3;++_){for(b=0;b<Jg.SBMAX_s;b++)a.en[o].s[b][_]=1e20,a.thm[o].s[b][_]=1e20;a.nsPsy.lastAttacks[o]=0}for(_=0;_<9;_++)a.nsPsy.last_en_subshort[o][_]=10}for(a.loudness_sq_save[0]=a.loudness_sq_save[1]=0,a.npart_l=de(a.numlines_l,a.bo_l,a.bm_l,p,f,a.mld_l,a.PSY.bo_l_weight,v,Jg.BLKSIZE,a.scalefac_band.l,Jg.BLKSIZE/1152,Jg.SBMAX_l),uv(a.npart_l<Jg.CBANDS),o=0;o<a.npart_l;o++){var y=c;p[o]>=r&&(y=d*(p[o]-r)/(i-r)+c*(i-p[o])/(i-r)),g[o]=Math.pow(10,y/10),a.numlines_l[o]>0?a.rnumlines_l[o]=1/a.numlines_l[o]:a.rnumlines_l[o]=0}a.s3_ll=ue(a.s3ind,a.npart_l,p,f,g,n);var x;_=0;for(o=0;o<a.npart_l;o++){M=av.MAX_VALUE;for(var w=0;w<a.numlines_l[o];w++,_++){var k=v*_/(1e3*Jg.BLKSIZE);R=this.ATHformula(1e3*k,s)-20,R=Math.pow(10,.1*R),R*=a.numlines_l[o],M>R&&(M=R)}a.ATH.cb_l[o]=M,M=20*p[o]/10-20,M>6&&(M=100),M<-15&&(M=-15),M-=8,a.minval_l[o]=Math.pow(10,M/10)*a.numlines_l[o]}for(a.npart_s=de(a.numlines_s,a.bo_s,a.bm_s,p,f,a.mld_s,a.PSY.bo_s_weight,v,Jg.BLKSIZE_s,a.scalefac_band.s,Jg.BLKSIZE_s/384,Jg.SBMAX_s),uv(a.npart_s<Jg.CBANDS),_=0,o=0;o<a.npart_s;o++){var M;y=u;p[o]>=r&&(y=h*(p[o]-r)/(i-r)+u*(i-p[o])/(i-r)),g[o]=Math.pow(10,y/10),M=av.MAX_VALUE;for(w=0;w<a.numlines_s[o];w++,_++){var R;k=v*_/(1e3*Jg.BLKSIZE_s);R=this.ATHformula(1e3*k,s)-20,R=Math.pow(10,.1*R),R*=a.numlines_s[o],M>R&&(M=R)}a.ATH.cb_s[o]=M,M=7*p[o]/12-7,p[o]>12&&(M*=1+3.1*Math.log(1+M)),p[o]<12&&(M*=1+2.3*Math.log(1-M)),M<-15&&(M=-15),M-=8,a.minval_s[o]=Math.pow(10,M/10)*a.numlines_s[o]}a.s3_ss=ue(a.s3ind_s,a.npart_s,p,f,g,n),S(),e.init_fft(a),a.decay=Math.exp(-1*t/(l*v/192)),x=m,0!=(2&s.exp_nspsytune)&&(x=1),Math.abs(s.msfix)>0&&(x=s.msfix),s.msfix=x;for(var A=0;A<a.npart_l;A++)a.s3ind[A][1]>a.npart_l-1&&(a.s3ind[A][1]=a.npart_l-1);var E=576*a.mode_gr/v;if(a.ATH.decay=Math.pow(10,-1.2*E),a.ATH.adjust=.01,a.ATH.adjustLimit=1,uv(a.bo_l[Jg.SBMAX_l-1]<=a.npart_l),uv(a.bo_s[Jg.SBMAX_s-1]<=a.npart_s),-1!=s.ATHtype){var T=s.out_samplerate/Jg.BLKSIZE,I=0;for(k=0,o=0;o<Jg.BLKSIZE/2;++o)k+=T,a.ATH.eql_w[o]=1/Math.pow(10,this.ATHformula(k,s)/10),I+=a.ATH.eql_w[o];for(I=1/I,o=Jg.BLKSIZE/2;--o>=0;)a.ATH.eql_w[o]*=I}for(A=_=0;A<a.npart_s;++A)for(o=0;o<a.numlines_s[A];++o)++_;for(A=_=0;A<a.npart_l;++A)for(o=0;o<a.numlines_l[A];++o)++_;for(_=0,o=0;o<a.npart_l;o++){k=v*(_+a.numlines_l[o]/2)/(1*Jg.BLKSIZE);a.mld_cb_l[o]=me(k),_+=a.numlines_l[o]}for(;o<Jg.CBANDS;++o)a.mld_cb_l[o]=1;for(_=0,o=0;o<a.npart_s;o++){k=v*(_+a.numlines_s[o]/2)/(1*Jg.BLKSIZE_s);a.mld_cb_s[o]=me(k),_+=a.numlines_s[o]}for(;o<Jg.CBANDS;++o)a.mld_cb_s[o]=1;return 0},this.ATHformula=function(e,t){var s;switch(t.ATHtype){case 0:s=he(e,9);break;case 1:s=he(e,-1);break;case 2:s=he(e,0);break;case 3:s=he(e,1)+6;break;case 4:s=he(e,t.ATHcurve);break;default:s=he(e,0);break}return s}}function hv(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=zg.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var pv={};pv.SFBMAX=3*Jg.SBMAX_s;var fv=jg.new_float,gv=jg.new_int;function vv(){this.xr=fv(576),this.l3_enc=gv(576),this.scalefac=gv(pv.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=gv(3),this.subblock_gain=gv(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=gv(pv.SFBMAX),this.window=gv(pv.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=gv(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}function s(e){return new Float32Array(e)}this.assign=function(o){e.xr=s(o.xr),e.l3_enc=t(o.l3_enc),e.scalefac=t(o.scalefac),e.xrpow_max=o.xrpow_max,e.part2_3_length=o.part2_3_length,e.big_values=o.big_values,e.count1=o.count1,e.global_gain=o.global_gain,e.scalefac_compress=o.scalefac_compress,e.block_type=o.block_type,e.mixed_block_flag=o.mixed_block_flag,e.table_select=t(o.table_select),e.subblock_gain=t(o.subblock_gain),e.region0_count=o.region0_count,e.region1_count=o.region1_count,e.preflag=o.preflag,e.scalefac_scale=o.scalefac_scale,e.count1table_select=o.count1table_select,e.part2_length=o.part2_length,e.sfb_lmax=o.sfb_lmax,e.sfb_smin=o.sfb_smin,e.psy_lmax=o.psy_lmax,e.sfbmax=o.sfbmax,e.psymax=o.psymax,e.sfbdivide=o.sfbdivide,e.width=t(o.width),e.window=t(o.window),e.count1bits=o.count1bits,e.sfb_partition_table=o.sfb_partition_table.slice(0),e.slen=t(o.slen),e.max_nonzero_coeff=o.max_nonzero_coeff}}var _v=jg.new_int;function bv(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[_v(4),_v(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new vv}var yv=jg.System,xv=jg.new_int;function wv(e,t,s,o){this.l=xv(1+Jg.SBMAX_l),this.s=xv(1+Jg.SBMAX_s),this.psfb21=xv(1+Jg.PSFB21),this.psfb12=xv(1+Jg.PSFB12);var a=this.l,n=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],yv.arraycopy(this.arrL,0,a,0,Math.min(this.arrL.length,this.l.length)),yv.arraycopy(this.arrS,0,n,0,Math.min(this.arrS.length,this.s.length)),yv.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),yv.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var kv=jg.new_float,Mv=jg.new_float_n,Sv=jg.new_int;function Rv(){this.last_en_subshort=Mv([4,9]),this.lastAttacks=Sv(4),this.pefirbuf=kv(19),this.longfact=kv(Jg.SBMAX_l),this.shortfact=kv(Jg.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Av(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Ev=jg.new_byte,Tv=jg.new_double,Iv=jg.new_float,Ov=jg.new_float_n,Bv=jg.new_int,Cv=jg.new_int_n;function jv(){var e=40;function t(){this.write_timing=0,this.ptr=0,this.buf=Ev(e)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Ov([2,jv.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new bv,this.ms_ratio=Iv(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Bv(2),this.CurrentStep=Bv(2),this.masking_lower=0,this.bv_scf=Bv(576),this.pseudohalf=Bv(pv.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*jv.BPC+1),this.itime=Tv(2),this.sideinfo_len=0,this.sb_sample=Ov([2,2,18,Jg.SBLIMIT]),this.amp_filter=Iv(32),this.header=new Array(jv.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new wv,this.minval_l=Iv(Jg.CBANDS),this.minval_s=Iv(Jg.CBANDS),this.nb_1=Ov([4,Jg.CBANDS]),this.nb_2=Ov([4,Jg.CBANDS]),this.nb_s1=Ov([4,Jg.CBANDS]),this.nb_s2=Ov([4,Jg.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Iv(4),this.loudness_sq=Ov([2,2]),this.loudness_sq_save=Iv(2),this.mld_l=Iv(Jg.SBMAX_l),this.mld_s=Iv(Jg.SBMAX_s),this.bm_l=Bv(Jg.SBMAX_l),this.bo_l=Bv(Jg.SBMAX_l),this.bm_s=Bv(Jg.SBMAX_s),this.bo_s=Bv(Jg.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Cv([Jg.CBANDS,2]),this.s3ind_s=Cv([Jg.CBANDS,2]),this.numlines_s=Bv(Jg.CBANDS),this.numlines_l=Bv(Jg.CBANDS),this.rnumlines_l=Iv(Jg.CBANDS),this.mld_cb_l=Iv(Jg.CBANDS),this.mld_cb_s=Iv(Jg.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Iv(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Bv(2),this.nsPsy=new Rv,this.VBR_seek_table=new Av,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Cv([16,5]),this.bitrate_blockType_Hist=Cv([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var s=0;s<this.en.length;s++)this.en[s]=new qg;for(s=0;s<this.thm.length;s++)this.thm[s]=new qg;for(s=0;s<this.header.length;s++)this.header[s]=new t}jv.MFSIZE=3456+Jg.ENCDELAY-Jg.MDCTDELAY,jv.MAX_HEADER_BUF=256,jv.MAX_BITS_PER_CHANNEL=4095,jv.MAX_BITS_PER_GRANULE=7680,jv.BPC=320;var Lv=jg.new_float;function Pv(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Lv(Jg.SBMAX_l),this.s=Lv(Jg.SBMAX_s),this.psfb21=Lv(Jg.PSFB21),this.psfb12=Lv(Jg.PSFB12),this.cb_l=Lv(Jg.CBANDS),this.cb_s=Lv(Jg.CBANDS),this.eql_w=Lv(Jg.BLKSIZE/2)}var Nv=jg.System,Hv=jg.Arrays;function Dv(){var e=64.82,t=.95,s=Dv.RMS_WINDOW_TIME_NUMERATOR,o=Dv.RMS_WINDOW_TIME_DENOMINATOR,a=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],n=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function r(e,t,s,o,a,n){while(0!=a--)s[o]=1e-10+e[t+0]*n[0]-s[o-1]*n[1]+e[t-1]*n[2]-s[o-2]*n[3]+e[t-2]*n[4]-s[o-3]*n[5]+e[t-3]*n[6]-s[o-4]*n[7]+e[t-4]*n[8]-s[o-5]*n[9]+e[t-5]*n[10]-s[o-6]*n[11]+e[t-6]*n[12]-s[o-7]*n[13]+e[t-7]*n[14]-s[o-8]*n[15]+e[t-8]*n[16]-s[o-9]*n[17]+e[t-9]*n[18]-s[o-10]*n[19]+e[t-10]*n[20],++o,++t}function i(e,t,s,o,a,n){while(0!=a--)s[o]=e[t+0]*n[0]-s[o-1]*n[1]+e[t-1]*n[2]-s[o-2]*n[3]+e[t-2]*n[4],++o,++t}function l(e,t){for(var a=0;a<MAX_ORDER;a++)e.linprebuf[a]=e.lstepbuf[a]=e.loutbuf[a]=e.rinprebuf[a]=e.rstepbuf[a]=e.routbuf[a]=0;switch(0|t){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(t*s+o-1)/o,e.lsum=0,e.rsum=0,e.totsamp=0,Hv.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}function c(e){return e*e}function d(s,o){var a,n=0;for(a=0;a<o;a++)n+=s[a];if(0==n)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(n*(1-t));for(a=o;a-- >0;)if((r-=s[a])<=0)break;return e-a/Dv.STEPS_per_dB}this.InitGainAnalysis=function(e,t){return l(e,t)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,Hv.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,s,o,l,d,u){var m,h,p,f,g,v,_;if(0==d)return GAIN_ANALYSIS_OK;switch(_=0,g=d,u){case 1:o=t,l=s;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}d<MAX_ORDER?(Nv.arraycopy(t,s,e.linprebuf,MAX_ORDER,d),Nv.arraycopy(o,l,e.rinprebuf,MAX_ORDER,d)):(Nv.arraycopy(t,s,e.linprebuf,MAX_ORDER,MAX_ORDER),Nv.arraycopy(o,l,e.rinprebuf,MAX_ORDER,MAX_ORDER));while(g>0){v=g>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:g,_<MAX_ORDER?(m=e.linpre+_,h=e.linprebuf,p=e.rinpre+_,f=e.rinprebuf,v>MAX_ORDER-_&&(v=MAX_ORDER-_)):(m=s+_,h=t,p=l+_,f=o),r(h,m,e.lstepbuf,e.lstep+e.totsamp,v,a[e.reqindex]),r(f,p,e.rstepbuf,e.rstep+e.totsamp,v,a[e.reqindex]),i(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,v,n[e.reqindex]),i(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,v,n[e.reqindex]),m=e.lout+e.totsamp,h=e.loutbuf,p=e.rout+e.totsamp,f=e.routbuf;var b=v%8;while(0!=b--)e.lsum+=c(h[m++]),e.rsum+=c(f[p++]);b=v/8;while(0!=b--)e.lsum+=c(h[m+0])+c(h[m+1])+c(h[m+2])+c(h[m+3])+c(h[m+4])+c(h[m+5])+c(h[m+6])+c(h[m+7]),m+=8,e.rsum+=c(f[p+0])+c(f[p+1])+c(f[p+2])+c(f[p+3])+c(f[p+4])+c(f[p+5])+c(f[p+6])+c(f[p+7]),p+=8;if(g-=v,_+=v,e.totsamp+=v,e.totsamp==e.sampleWindow){var y=10*Dv.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),x=y<=0?0:0|y;x>=e.A.length&&(x=e.A.length-1),e.A[x]++,e.lsum=e.rsum=0,Nv.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),Nv.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),Nv.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),Nv.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return d<MAX_ORDER?(Nv.arraycopy(e.linprebuf,d,e.linprebuf,0,MAX_ORDER-d),Nv.arraycopy(e.rinprebuf,d,e.rinprebuf,0,MAX_ORDER-d),Nv.arraycopy(t,s,e.linprebuf,MAX_ORDER-d,d),Nv.arraycopy(o,l,e.rinprebuf,MAX_ORDER-d,d)):(Nv.arraycopy(t,s+d-MAX_ORDER,e.linprebuf,0,MAX_ORDER),Nv.arraycopy(o,l+d-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=d(e.A,e.A.length),s=0;s<e.A.length;s++)e.B[s]+=e.A[s],e.A[s]=0;for(s=0;s<MAX_ORDER;s++)e.linprebuf[s]=e.lstepbuf[s]=e.loutbuf[s]=e.rinprebuf[s]=e.rstepbuf[s]=e.routbuf[s]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}Dv.STEPS_per_dB=100,Dv.MAX_dB=120,Dv.GAIN_NOT_ENOUGH_SAMPLES=-24601,Dv.GAIN_ANALYSIS_ERROR=0,Dv.GAIN_ANALYSIS_OK=1,Dv.INIT_GAIN_ANALYSIS_ERROR=0,Dv.INIT_GAIN_ANALYSIS_OK=1,Dv.YULE_ORDER=10,Dv.MAX_ORDER=Dv.YULE_ORDER,Dv.MAX_SAMP_FREQ=48e3,Dv.RMS_WINDOW_TIME_NUMERATOR=1,Dv.RMS_WINDOW_TIME_DENOMINATOR=20,Dv.MAX_SAMPLES_PER_WINDOW=Dv.MAX_SAMP_FREQ*Dv.RMS_WINDOW_TIME_NUMERATOR/Dv.RMS_WINDOW_TIME_DENOMINATOR+1;var Uv=jg.new_float,Fv=jg.new_int;function $v(){this.linprebuf=Uv(NaN),this.linpre=0,this.lstepbuf=Uv(NaN),this.lstep=0,this.loutbuf=Uv(NaN),this.lout=0,this.rinprebuf=Uv(NaN),this.rinpre=0,this.rstepbuf=Uv(NaN),this.rstep=0,this.routbuf=Uv(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=Fv(0),this.B=Fv(0)}function qv(e){this.bits=e}var Vv=jg.new_float,zv=jg.new_int,Yv=jg.assert;function Xv(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,s,o){var a,n=e.internal_flags,r=Vv(pv.SFBMAX),i=Vv(576),l=zv(2),c=0,d=n.l3_side,u=new qv(c);this.quantize.rv.ResvFrameBegin(e,u),c=u.bits;for(var m=0;m<n.mode_gr;m++){a=this.quantize.qupvt.on_pe(e,t,l,c,m,m),n.mode_ext==Jg.MPG_MD_MS_LR&&(this.quantize.ms_convert(n.l3_side,m),this.quantize.qupvt.reduce_side(l,s[m],c,a));for(var h=0;h<n.channels_out;h++){var p,f,g=d.tt[m][h];g.block_type!=Jg.SHORT_TYPE?(p=0,f=n.PSY.mask_adjust-p):(p=0,f=n.PSY.mask_adjust_short-p),n.masking_lower=Math.pow(10,.1*f),this.quantize.init_outer_loop(n,g),this.quantize.init_xrpow(n,g,i)&&(this.quantize.qupvt.calc_xmin(e,o[m][h],g,r),this.quantize.outer_loop(e,g,r,i,h,l[h])),this.quantize.iteration_finish_one(n,m,h),Yv(g.part2_3_length<=jv.MAX_BITS_PER_CHANNEL),Yv(g.part2_3_length<=l[h])}}this.quantize.rv.ResvFrameEnd(n,c)}}function Kv(e,t,s,o){this.xlen=e,this.linmax=t,this.table=s,this.hlen=o}var Gv={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};Gv.ht=[new Kv(0,0,null,null),new Kv(2,0,Gv.t1HB,Gv.t1l),new Kv(3,0,Gv.t2HB,Gv.t2l),new Kv(3,0,Gv.t3HB,Gv.t3l),new Kv(0,0,null,null),new Kv(4,0,Gv.t5HB,Gv.t5l),new Kv(4,0,Gv.t6HB,Gv.t6l),new Kv(6,0,Gv.t7HB,Gv.t7l),new Kv(6,0,Gv.t8HB,Gv.t8l),new Kv(6,0,Gv.t9HB,Gv.t9l),new Kv(8,0,Gv.t10HB,Gv.t10l),new Kv(8,0,Gv.t11HB,Gv.t11l),new Kv(8,0,Gv.t12HB,Gv.t12l),new Kv(16,0,Gv.t13HB,Gv.t13l),new Kv(0,0,null,Gv.t16_5l),new Kv(16,0,Gv.t15HB,Gv.t15l),new Kv(1,1,Gv.t16HB,Gv.t16l),new Kv(2,3,Gv.t16HB,Gv.t16l),new Kv(3,7,Gv.t16HB,Gv.t16l),new Kv(4,15,Gv.t16HB,Gv.t16l),new Kv(6,63,Gv.t16HB,Gv.t16l),new Kv(8,255,Gv.t16HB,Gv.t16l),new Kv(10,1023,Gv.t16HB,Gv.t16l),new Kv(13,8191,Gv.t16HB,Gv.t16l),new Kv(4,15,Gv.t24HB,Gv.t24l),new Kv(5,31,Gv.t24HB,Gv.t24l),new Kv(6,63,Gv.t24HB,Gv.t24l),new Kv(7,127,Gv.t24HB,Gv.t24l),new Kv(8,255,Gv.t24HB,Gv.t24l),new Kv(9,511,Gv.t24HB,Gv.t24l),new Kv(11,2047,Gv.t24HB,Gv.t24l),new Kv(13,8191,Gv.t24HB,Gv.t24l),new Kv(0,0,Gv.t32HB,Gv.t32l),new Kv(0,0,Gv.t33HB,Gv.t33l)],Gv.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],Gv.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],Gv.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],Gv.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],Gv.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],Gv.scfsi_band=[0,6,11,16,21];var Zv=jg.VbrMode,Wv=jg.Float,Qv=jg.Util,Jv=jg.new_float,e_=jg.new_int,t_=jg.assert;function s_(){var e=null,t=null,s=null;function o(e){return u[e+s_.Q_MAX2]}this.setModules=function(o,a,n){e=o,t=a,s=n},this.IPOW20=function(e){return m[e]};var a=2220446049250313e-31,n=s_.IXMAX_VAL,r=n+2,i=s_.Q_MAX,l=s_.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new wv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new wv([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=Jv(i+l+1),m=Jv(i),h=Jv(r),p=Jv(r);function f(e,t){var o=s.ATHformula(t,e);return o-=c,o=Math.pow(10,o/10+e.ATHlower),o}function g(e){for(var t=e.internal_flags.ATH.l,s=e.internal_flags.ATH.psfb21,o=e.internal_flags.ATH.s,a=e.internal_flags.ATH.psfb12,n=e.internal_flags,r=e.out_samplerate,i=0;i<Jg.SBMAX_l;i++){var l=n.scalefac_band.l[i],c=n.scalefac_band.l[i+1];t[i]=Wv.MAX_VALUE;for(var d=l;d<c;d++){var u=d*r/1152,m=f(e,u);t[i]=Math.min(t[i],m)}}for(i=0;i<Jg.PSFB21;i++){l=n.scalefac_band.psfb21[i],c=n.scalefac_band.psfb21[i+1];s[i]=Wv.MAX_VALUE;for(d=l;d<c;d++){u=d*r/1152,m=f(e,u);s[i]=Math.min(s[i],m)}}for(i=0;i<Jg.SBMAX_s;i++){l=n.scalefac_band.s[i],c=n.scalefac_band.s[i+1];o[i]=Wv.MAX_VALUE;for(d=l;d<c;d++){u=d*r/384,m=f(e,u);o[i]=Math.min(o[i],m)}o[i]*=n.scalefac_band.s[i+1]-n.scalefac_band.s[i]}for(i=0;i<Jg.PSFB12;i++){l=n.scalefac_band.psfb12[i],c=n.scalefac_band.psfb12[i+1];a[i]=Wv.MAX_VALUE;for(d=l;d<c;d++){u=d*r/384,m=f(e,u);a[i]=Math.min(a[i],m)}a[i]*=n.scalefac_band.s[13]-n.scalefac_band.s[12]}if(e.noATH){for(i=0;i<Jg.SBMAX_l;i++)t[i]=1e-20;for(i=0;i<Jg.PSFB21;i++)s[i]=1e-20;for(i=0;i<Jg.SBMAX_s;i++)o[i]=1e-20;for(i=0;i<Jg.PSFB12;i++)a[i]=1e-20}n.ATH.floor=10*Math.log10(f(e,-1))}function v(e){this.s=e}this.adj43=p,this.iteration_init=function(t){var s,o=t.internal_flags,a=o.l3_side;if(0==o.iteration_init_init){for(o.iteration_init_init=1,a.main_data_begin=0,g(t),h[0]=0,s=1;s<r;s++)h[s]=Math.pow(s,4/3);for(s=0;s<r-1;s++)p[s]=s+1-Math.pow(.5*(h[s]+h[s+1]),.75);for(p[s]=.5,s=0;s<i;s++)m[s]=Math.pow(2,-.1875*(s-210));for(s=0;s<=i+l;s++)u[s]=Math.pow(2,.25*(s-210-l));var n,c,d,f;for(e.huffman_init(o),s=t.exp_nspsytune>>2&63,s>=32&&(s-=64),n=Math.pow(10,s/4/10),s=t.exp_nspsytune>>8&63,s>=32&&(s-=64),c=Math.pow(10,s/4/10),s=t.exp_nspsytune>>14&63,s>=32&&(s-=64),d=Math.pow(10,s/4/10),s=t.exp_nspsytune>>20&63,s>=32&&(s-=64),f=d*Math.pow(10,s/4/10),s=0;s<Jg.SBMAX_l;s++){v=s<=6?n:s<=13?c:s<=20?d:f,o.nsPsy.longfact[s]=v}for(s=0;s<Jg.SBMAX_s;s++){var v;v=s<=5?n:s<=10?c:s<=11?d:f,o.nsPsy.shortfact[s]=v}}},this.on_pe=function(e,s,o,a,n,r){var i,l,c=e.internal_flags,d=0,u=e_(2),m=new qv(d),h=t.ResvMaxBits(e,a,m,r);d=m.bits;var p=d+h;for(p>jv.MAX_BITS_PER_GRANULE&&(p=jv.MAX_BITS_PER_GRANULE),i=0,l=0;l<c.channels_out;++l)o[l]=Math.min(jv.MAX_BITS_PER_CHANNEL,d/c.channels_out),u[l]=0|o[l]*s[n][l]/700-o[l],u[l]>3*a/4&&(u[l]=3*a/4),u[l]<0&&(u[l]=0),u[l]+o[l]>jv.MAX_BITS_PER_CHANNEL&&(u[l]=Math.max(0,jv.MAX_BITS_PER_CHANNEL-o[l])),i+=u[l];if(i>h)for(l=0;l<c.channels_out;++l)u[l]=h*u[l]/i;for(l=0;l<c.channels_out;++l)o[l]+=u[l],h-=u[l];for(i=0,l=0;l<c.channels_out;++l)i+=o[l];if(i>jv.MAX_BITS_PER_GRANULE){for(l=0;l<c.channels_out;++l)o[l]*=jv.MAX_BITS_PER_GRANULE,o[l]/=i,o[l]}return p},this.reduce_side=function(e,t,s,o){t_(e[0]+e[1]<=jv.MAX_BITS_PER_GRANULE);var a=.33*(.5-t)/.5;a<0&&(a=0),a>.5&&(a=.5);var n=0|.5*a*(e[0]+e[1]);n>jv.MAX_BITS_PER_CHANNEL-e[0]&&(n=jv.MAX_BITS_PER_CHANNEL-e[0]),n<0&&(n=0),e[1]>=125&&(e[1]-n>125?(e[0]<s&&(e[0]+=n),e[1]-=n):(e[0]+=e[1]-125,e[1]=125)),n=e[0]+e[1],n>o&&(e[0]=o*e[0]/n,e[1]=o*e[1]/n),t_(e[0]<=jv.MAX_BITS_PER_CHANNEL),t_(e[1]<=jv.MAX_BITS_PER_CHANNEL),t_(e[0]+e[1]<=jv.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,s){var o=90.30873362,a=94.82444863,n=Qv.FAST_LOG10_X(t,10),r=e*e,i=0;return n-=s,r>1e-20&&(i=1+Qv.FAST_LOG10_X(r,10/o)),i<0&&(i=0),n*=i,n+=s+o-a,Math.pow(10,.1*n)},this.calc_xmin=function(e,t,s,o){var n,r=0,i=e.internal_flags,l=0,c=0,d=i.ATH,u=s.xr,m=e.VBR==Zv.vbr_mtrh?1:0,h=i.masking_lower;for(e.VBR!=Zv.vbr_mtrh&&e.VBR!=Zv.vbr_mt||(h=1),n=0;n<s.psy_lmax;n++){w=e.VBR==Zv.vbr_rh||e.VBR==Zv.vbr_mtrh?athAdjust(d.adjust,d.l[n],d.floor):d.adjust*d.l[n],b=s.width[n],k=w/b,M=a,R=b>>1,S=0;do{A=u[l]*u[l],S+=A,M+=A<k?A:k,l++,E=u[l]*u[l],S+=E,M+=E<k?E:k,l++}while(--R>0);if(S>w&&c++,n==Jg.SBPSY_l){var p=w*i.nsPsy.longfact[n];M<p&&(M=p)}if(0!=m&&(w=M),!e.ATHonly){var f=t.en.l[n];if(f>0)p=S*t.thm.l[n]*h/f,0!=m&&(p*=i.nsPsy.longfact[n]),w<p&&(w=p)}o[r++]=0!=m?w:w*i.nsPsy.longfact[n]}var g=575;if(s.block_type!=Jg.SHORT_TYPE){var v=576;while(0!=v--&&p_.EQ(u[v],0))g=v}s.max_nonzero_coeff=g;for(var _=s.sfb_smin;n<s.psymax;_++,n+=3){var b,y,x;for(x=e.VBR==Zv.vbr_rh||e.VBR==Zv.vbr_mtrh?athAdjust(d.adjust,d.s[_],d.floor):d.adjust*d.s[_],b=s.width[n],y=0;y<3;y++){var w,k,M,S=0,R=b>>1;k=x/b,M=a;do{var A,E;A=u[l]*u[l],S+=A,M+=A<k?A:k,l++,E=u[l]*u[l],S+=E,M+=E<k?E:k,l++}while(--R>0);if(S>x&&c++,_==Jg.SBPSY_s){p=x*i.nsPsy.shortfact[_];M<p&&(M=p)}if(w=0!=m?M:x,!e.ATHonly&&!e.ATHshort){f=t.en.s[_][y];if(f>0)p=S*t.thm.s[_][y]*h/f,0!=m&&(p*=i.nsPsy.shortfact[_]),w<p&&(w=p)}o[r++]=0!=m?w:w*i.nsPsy.shortfact[_]}e.useTemporal&&(o[r-3]>o[r-3+1]&&(o[r-3+1]+=(o[r-3]-o[r-3+1])*i.decay),o[r-3+1]>o[r-3+2]&&(o[r-3+2]+=(o[r-3+1]-o[r-3+2])*i.decay))}return c},this.calc_noise_core=function(e,t,s,o){var a=0,n=t.s,r=e.l3_enc;if(n>e.count1)while(0!=s--){l=e.xr[n],n++,a+=l*l,l=e.xr[n],n++,a+=l*l}else if(n>e.big_values){var i=Jv(2);i[0]=0,i[1]=o;while(0!=s--){l=Math.abs(e.xr[n])-i[r[n]],n++,a+=l*l,l=Math.abs(e.xr[n])-i[r[n]],n++,a+=l*l}}else while(0!=s--){var l;l=Math.abs(e.xr[n])-h[r[n]]*o,n++,a+=l*l,l=Math.abs(e.xr[n])-h[r[n]]*o,n++,a+=l*l}return t.s=n,a},this.calc_noise=function(e,t,s,a,n){var r,i,l=0,c=0,u=0,m=0,h=0,p=-20,f=0,g=e.scalefac,_=0;for(a.over_SSD=0,r=0;r<e.psymax;r++){var b,y=e.global_gain-(g[_++]+(0!=e.preflag?d[r]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[r]],x=0;if(null!=n&&n.step[r]==y)x=n.noise[r],f+=e.width[r],s[l++]=x/t[c++],x=n.noise_log[r];else{var w,k=o(y);if(i=e.width[r]>>1,f+e.width[r]>e.max_nonzero_coeff)w=e.max_nonzero_coeff-f+1,i=w>0?w>>1:0;var M=new v(f);x=this.calc_noise_core(e,M,i,k),f=M.s,null!=n&&(n.step[r]=y,n.noise[r]=x),x=s[l++]=x/t[c++],x=Qv.FAST_LOG10(Math.max(x,1e-20)),null!=n&&(n.noise_log[r]=x)}if(null!=n&&(n.global_gain=e.global_gain),h+=x,x>0)b=Math.max(0|10*x+.5,1),a.over_SSD+=b*b,u++,m+=x;p=Math.max(p,x)}return a.over_count=u,a.tot_noise=h,a.over_noise=m,a.max_noise=p,u},this.set_pinfo=function(e,t,s,o,a){var n,r,i,l,c,u=e.internal_flags,m=0==t.scalefac_scale?.5:1,h=t.scalefac,p=Jv(L3Side.SFBMAX),f=Jv(L3Side.SFBMAX),g=new CalcNoiseResult;calc_xmin(e,s,t,p),calc_noise(t,p,f,g,null);var v=0;for(r=t.sfb_lmax,t.block_type!=Jg.SHORT_TYPE&&0==t.mixed_block_flag&&(r=22),n=0;n<r;n++){var _=u.scalefac_band.l[n],b=u.scalefac_band.l[n+1],y=b-_;for(l=0;v<b;v++)l+=t.xr[v]*t.xr[v];l/=y,c=1e15,u.pinfo.en[o][a][n]=c*l,u.pinfo.xfsf[o][a][n]=c*p[n]*f[n]/y,s.en.l[n]>0&&!e.ATHonly?l/=s.en.l[n]:l=0,u.pinfo.thr[o][a][n]=c*Math.max(l*s.thm.l[n],u.ATH.l[n]),u.pinfo.LAMEsfb[o][a][n]=0,0!=t.preflag&&n>=11&&(u.pinfo.LAMEsfb[o][a][n]=-m*d[n]),n<Jg.SBPSY_l&&(t_(h[n]>=0),u.pinfo.LAMEsfb[o][a][n]-=m*h[n])}if(t.block_type==Jg.SHORT_TYPE)for(r=n,n=t.sfb_smin;n<Jg.SBMAX_s;n++){_=u.scalefac_band.s[n],b=u.scalefac_band.s[n+1],y=b-_;for(var x=0;x<3;x++){for(l=0,i=_;i<b;i++)l+=t.xr[v]*t.xr[v],v++;l=Math.max(l/y,1e-20),c=1e15,u.pinfo.en_s[o][a][3*n+x]=c*l,u.pinfo.xfsf_s[o][a][3*n+x]=c*p[r]*f[r]/y,s.en.s[n][x]>0?l/=s.en.s[n][x]:l=0,(e.ATHonly||e.ATHshort)&&(l=0),u.pinfo.thr_s[o][a][3*n+x]=c*Math.max(l*s.thm.s[n][x],u.ATH.s[n]),u.pinfo.LAMEsfb_s[o][a][3*n+x]=-2*t.subblock_gain[x],n<Jg.SBPSY_s&&(u.pinfo.LAMEsfb_s[o][a][3*n+x]-=m*h[r]),r++}}u.pinfo.LAMEqss[o][a]=t.global_gain,u.pinfo.LAMEmainbits[o][a]=t.part2_3_length+t.part2_length,u.pinfo.LAMEsfbits[o][a]=t.part2_length,u.pinfo.over[o][a]=g.over_count,u.pinfo.max_noise[o][a]=10*g.max_noise,u.pinfo.over_noise[o][a]=10*g.over_noise,u.pinfo.tot_noise[o][a]=10*g.tot_noise,u.pinfo.over_SSD[o][a]=g.over_SSD}}s_.Q_MAX=257,s_.Q_MAX2=116,s_.LARGE_BITS=1e5,s_.IXMAX_VAL=8206;var o_=jg.System,a_=jg.Arrays,n_=jg.new_int,r_=jg.assert;function i_(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var s=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function o(e,t,s,o,a,n){var r=.5946/t;e>>=1;while(0!=e--)a[n++]=r>s[o++]?0:1,a[n++]=r>s[o++]?0:1}function a(t,s,o,a,n,r){t>>=1;var i=t%2;t>>=1;while(0!=t--){var l,c,d,u,m,h,p,f;l=o[a++]*s,c=o[a++]*s,m=0|l,d=o[a++]*s,h=0|c,u=o[a++]*s,p=0|d,l+=e.adj43[m],f=0|u,c+=e.adj43[h],n[r++]=0|l,d+=e.adj43[p],n[r++]=0|c,u+=e.adj43[f],n[r++]=0|d,n[r++]=0|u}0!=i&&(l=o[a++]*s,c=o[a++]*s,m=0|l,h=0|c,l+=e.adj43[m],c+=e.adj43[h],n[r++]=0|l,n[r++]=0|c)}function n(t,s,n,r,i){var l,c,d,u=0,m=0,h=0,p=0,f=s,g=0,v=f,_=0,b=t,y=0;for(d=null!=i&&r.global_gain==i.global_gain,c=r.block_type==Jg.SHORT_TYPE?38:21,l=0;l<=c;l++){var x=-1;if((d||r.block_type==Jg.NORM_TYPE)&&(x=r.global_gain-(r.scalefac[l]+(0!=r.preflag?e.pretab[l]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[l]]),r_(r.width[l]>=0),d&&i.step[l]==x)0!=m&&(a(m,n,b,y,v,_),m=0),0!=h&&(o(h,n,b,y,v,_),h=0);else{var w,k=r.width[l];if(u+r.width[l]>r.max_nonzero_coeff)w=r.max_nonzero_coeff-u+1,a_.fill(s,r.max_nonzero_coeff,576,0),k=w,k<0&&(k=0),l=c+1;if(0==m&&0==h&&(v=f,_=g,b=t,y=p),null!=i&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&x>=i.step[l]?(0!=m&&(a(m,n,b,y,v,_),m=0,v=f,_=g,b=t,y=p),h+=k):(0!=h&&(o(h,n,b,y,v,_),h=0,v=f,_=g,b=t,y=p),m+=k),k<=0){0!=h&&(o(h,n,b,y,v,_),h=0),0!=m&&(a(m,n,b,y,v,_),m=0);break}}l<=c&&(g+=r.width[l],p+=r.width[l],u+=r.width[l])}0!=m&&(a(m,n,b,y,v,_),m=0),0!=h&&(o(h,n,b,y,v,_),h=0)}function r(e,t,s){var o=0,a=0;do{var n=e[t++],r=e[t++];o<n&&(o=n),a<r&&(a=r)}while(t<s);return o<a&&(o=a),o}function i(e,t,s,o,a,n){var r,i=65536*Gv.ht[o].xlen+Gv.ht[a].xlen,l=0;do{var c=e[t++],d=e[t++];0!=c&&(c>14&&(c=15,l+=i),c*=16),0!=d&&(d>14&&(d=15,l+=i),c+=d),l+=Gv.largetbl[c]}while(t<s);return r=65535&l,l>>=16,l>r&&(l=r,o=a),n.bits+=l,o}function l(e,t,s,o){var a=0,n=Gv.ht[1].hlen;do{var r=2*e[t+0]+e[t+1];t+=2,a+=n[r]}while(t<s);return o.bits+=a,1}function c(e,t,s,o,a){var n,r,i=0,l=Gv.ht[o].xlen;r=2==o?Gv.table23:Gv.table56;do{var c=e[t+0]*l+e[t+1];t+=2,i+=r[c]}while(t<s);return n=65535&i,i>>=16,i>n&&(i=n,o++),a.bits+=i,o}function d(e,t,s,o,a){var n=0,r=0,i=0,l=Gv.ht[o].xlen,c=Gv.ht[o].hlen,d=Gv.ht[o+1].hlen,u=Gv.ht[o+2].hlen;do{var m=e[t+0]*l+e[t+1];t+=2,n+=c[m],r+=d[m],i+=u[m]}while(t<s);var h=o;return n>r&&(n=r,h++),n>i&&(n=i,h=o+2),a.bits+=n,h}var u=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function m(e,t,s,o){var a=r(e,t,s);switch(a){case 0:return a;case 1:return l(e,t,s,o);case 2:case 3:return c(e,t,s,u[a-1],o);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return d(e,t,s,u[a-1],o);default:if(a>s_.IXMAX_VAL)return o.bits=s_.LARGE_BITS,-1;var n,m;for(a-=15,n=24;n<32;n++)if(Gv.ht[n].linmax>=a)break;for(m=n-8;m<24;m++)if(Gv.ht[m].linmax>=a)break;return i(e,t,s,m,n,o)}}function h(e,s,o,a,n,r,i){for(var l=s.big_values,c=0;c<=22;c++)a[c]=s_.LARGE_BITS;for(c=0;c<16;c++){var d=e.scalefac_band.l[c+1];if(d>=l)break;var u=0,h=new t(u),p=m(o,0,d,h);u=h.bits;for(var f=0;f<8;f++){var g=e.scalefac_band.l[c+f+2];if(g>=l)break;var v=u;h=new t(v);var _=m(o,d,g,h);v=h.bits,a[c+f]>v&&(a[c+f]=v,n[c+f]=c,r[c+f]=p,i[c+f]=_)}}}function p(e,s,o,a,n,r,i,l){for(var c=s.big_values,d=2;d<Jg.SBMAX_l+1;d++){var u=e.scalefac_band.l[d];if(u>=c)break;var h=n[d-2]+s.count1bits;if(o.part2_3_length<=h)break;var p=new t(h),f=m(a,u,c,p);h=p.bits,o.part2_3_length<=h||(o.assign(s),o.part2_3_length=h,o.region0_count=r[d-2],o.region1_count=d-2-r[d-2],o.table_select[0]=i[d-2],o.table_select[1]=l[d-2],o.table_select[2]=f)}}this.noquant_count_bits=function(e,s,o){var a=s.l3_enc,n=Math.min(576,s.max_nonzero_coeff+2>>1<<1);for(null!=o&&(o.sfb_count1=0);n>1;n-=2)if(0!=(a[n-1]|a[n-2]))break;s.count1=n;for(var r=0,i=0;n>3;n-=4){var l;if((2147483647&(a[n-1]|a[n-2]|a[n-3]|a[n-4]))>1)break;l=2*(2*(2*a[n-4]+a[n-3])+a[n-2])+a[n-1],r+=Gv.t32l[l],i+=Gv.t33l[l]}var c=r;if(s.count1table_select=0,r>i&&(c=i,s.count1table_select=1),s.count1bits=c,s.big_values=n,0==n)return c;if(s.block_type==Jg.SHORT_TYPE)r=3*e.scalefac_band.s[3],r>s.big_values&&(r=s.big_values),i=s.big_values;else if(s.block_type==Jg.NORM_TYPE){if(r=s.region0_count=e.bv_scf[n-2],i=s.region1_count=e.bv_scf[n-1],i=e.scalefac_band.l[r+i+2],r=e.scalefac_band.l[r+1],i<n){var d=new t(c);s.table_select[2]=m(a,i,n,d),c=d.bits}}else s.region0_count=7,s.region1_count=Jg.SBMAX_l-1-7-1,r=e.scalefac_band.l[8],i=n,r>i&&(r=i);if(r=Math.min(r,n),i=Math.min(i,n),r>0){d=new t(c);s.table_select[0]=m(a,0,r,d),c=d.bits}if(r<i){d=new t(c);s.table_select[1]=m(a,r,i,d),c=d.bits}if(2==e.use_best_huffman&&(s.part2_3_length=c,best_huffman_divide(e,s),c=s.part2_3_length),null!=o&&s.block_type==Jg.NORM_TYPE){var u=0;while(e.scalefac_band.l[u]<s.big_values)u++;o.sfb_count1=u}return c},this.count_bits=function(t,s,o,a){var r=o.l3_enc,i=s_.IXMAX_VAL/e.IPOW20(o.global_gain);if(o.xrpow_max>i)return s_.LARGE_BITS;if(n(s,r,e.IPOW20(o.global_gain),o,a),0!=(2&t.substep_shaping))for(var l=0,c=o.global_gain+o.scalefac_scale,d=.634521682242439/e.IPOW20(c),u=0;u<o.sfbmax;u++){var m,h=o.width[u];if(0==t.pseudohalf[u])l+=h;else for(m=l,l+=h;m<l;++m)r[m]=s[m]>=d?r[m]:0}return this.noquant_count_bits(t,o,a)},this.best_huffman_divide=function(e,s){var o=new vv,a=s.l3_enc,n=n_(23),r=n_(23),i=n_(23),l=n_(23);if(s.block_type!=Jg.SHORT_TYPE||1!=e.mode_gr){o.assign(s),s.block_type==Jg.NORM_TYPE&&(h(e,s,a,n,r,i,l),p(e,o,s,a,n,r,i,l));var c=o.big_values;if(!(0==c||(a[c-2]|a[c-1])>1)&&(c=s.count1+2,!(c>576))){o.assign(s),o.count1=c;for(var d=0,u=0;c>o.big_values;c-=4){var f=2*(2*(2*a[c-4]+a[c-3])+a[c-2])+a[c-1];d+=Gv.t32l[f],u+=Gv.t33l[f]}if(o.big_values=c,o.count1table_select=0,d>u&&(d=u,o.count1table_select=1),o.count1bits=d,o.block_type==Jg.NORM_TYPE)p(e,o,s,a,n,r,i,l);else{if(o.part2_3_length=d,d=e.scalefac_band.l[8],d>c&&(d=c),d>0){var g=new t(o.part2_3_length);o.table_select[0]=m(a,0,d,g),o.part2_3_length=g.bits}if(c>d){g=new t(o.part2_3_length);o.table_select[1]=m(a,d,c,g),o.part2_3_length=g.bits}s.part2_3_length>o.part2_3_length&&s.assign(o)}}}};var f=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],g=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],v=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];function b(e,t){for(var s,o=t.tt[1][e],a=t.tt[0][e],n=0;n<Gv.scfsi_band.length-1;n++){for(s=Gv.scfsi_band[n];s<Gv.scfsi_band[n+1];s++)if(a.scalefac[s]!=o.scalefac[s]&&o.scalefac[s]>=0)break;if(s==Gv.scfsi_band[n+1]){for(s=Gv.scfsi_band[n];s<Gv.scfsi_band[n+1];s++)o.scalefac[s]=-1;t.scfsi[e][n]=1}}var r=0,i=0;for(s=0;s<11;s++)-1!=o.scalefac[s]&&(i++,r<o.scalefac[s]&&(r=o.scalefac[s]));for(var l=0,c=0;s<Jg.SBPSY_l;s++)-1!=o.scalefac[s]&&(c++,l<o.scalefac[s]&&(l=o.scalefac[s]));for(n=0;n<16;n++)if(r<f[n]&&l<g[n]){var d=v[n]*i+_[n]*c;o.part2_length>d&&(o.part2_length=d,o.scalefac_compress=n)}}function y(e,t){for(var s=0;s<t;++s)if(e[s]<0)return!1;return!0}i_.slen1_tab=v,i_.slen2_tab=_,this.best_scalefac_store=function(t,s,o,a){var n,r,i,l,c=a.tt[s][o],d=0;for(i=0,n=0;n<c.sfbmax;n++){var u=c.width[n];for(i+=u,l=-u;l<0;l++)if(0!=c.l3_enc[l+i])break;0==l&&(c.scalefac[n]=d=-2)}if(0==c.scalefac_scale&&0==c.preflag){var m=0;for(n=0;n<c.sfbmax;n++)c.scalefac[n]>0&&(m|=c.scalefac[n]);if(0==(1&m)&&0!=m){for(n=0;n<c.sfbmax;n++)c.scalefac[n]>0&&(c.scalefac[n]>>=1);c.scalefac_scale=d=1}}if(0==c.preflag&&c.block_type!=Jg.SHORT_TYPE&&2==t.mode_gr){for(n=11;n<Jg.SBPSY_l;n++)if(c.scalefac[n]<e.pretab[n]&&-2!=c.scalefac[n])break;if(n==Jg.SBPSY_l){for(n=11;n<Jg.SBPSY_l;n++)c.scalefac[n]>0&&(c.scalefac[n]-=e.pretab[n]);c.preflag=d=1}}for(r=0;r<4;r++)a.scfsi[o][r]=0;for(2==t.mode_gr&&1==s&&a.tt[0][o].block_type!=Jg.SHORT_TYPE&&a.tt[1][o].block_type!=Jg.SHORT_TYPE&&(b(o,a),d=0),n=0;n<c.sfbmax;n++)-2==c.scalefac[n]&&(c.scalefac[n]=0);0!=d&&(2==t.mode_gr?this.scale_bitcount(c):this.scale_bitcount_lsf(t,c))};var x=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],w=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],k=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var s,o,a,n=0,r=0,i=t.scalefac;if(r_(y(i,t.sfbmax)),t.block_type==Jg.SHORT_TYPE)a=x,0!=t.mixed_block_flag&&(a=w);else if(a=k,0==t.preflag){for(o=11;o<Jg.SBPSY_l;o++)if(i[o]<e.pretab[o])break;if(o==Jg.SBPSY_l)for(t.preflag=1,o=11;o<Jg.SBPSY_l;o++)i[o]-=e.pretab[o]}for(o=0;o<t.sfbdivide;o++)n<i[o]&&(n=i[o]);for(;o<t.sfbmax;o++)r<i[o]&&(r=i[o]);for(t.part2_length=s_.LARGE_BITS,s=0;s<16;s++)n<f[s]&&r<g[s]&&t.part2_length>a[s]&&(t.part2_length=a[s],t.scalefac_compress=s);return t.part2_length==s_.LARGE_BITS};var M=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,s){var o,a,n,r,i,l,c,d,u=n_(4),m=s.scalefac;for(o=0!=s.preflag?2:0,c=0;c<4;c++)u[c]=0;if(s.block_type==Jg.SHORT_TYPE){a=1;var h=e.nr_of_sfb_block[o][a];for(d=0,n=0;n<4;n++)for(r=h[n]/3,c=0;c<r;c++,d++)for(i=0;i<3;i++)m[3*d+i]>u[n]&&(u[n]=m[3*d+i])}else{a=0;h=e.nr_of_sfb_block[o][a];for(d=0,n=0;n<4;n++)for(r=h[n],c=0;c<r;c++,d++)m[d]>u[n]&&(u[n]=m[d])}for(l=!1,n=0;n<4;n++)u[n]>M[o][n]&&(l=!0);if(!l){var p,f,g,v;for(s.sfb_partition_table=e.nr_of_sfb_block[o][a],n=0;n<4;n++)s.slen[n]=S[u[n]];switch(p=s.slen[0],f=s.slen[1],g=s.slen[2],v=s.slen[3],o){case 0:s.scalefac_compress=(5*p+f<<4)+(g<<2)+v;break;case 1:s.scalefac_compress=400+(5*p+f<<2)+g;break;case 2:s.scalefac_compress=500+3*p+f;break;default:o_.err.printf("intensity stereo not implemented yet\n");break}}if(!l)for(r_(null!=s.sfb_partition_table),s.part2_length=0,n=0;n<4;n++)s.part2_length+=s.slen[n]*s.sfb_partition_table[n];return l};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){var o,a=0;while(e.scalefac_band.l[++a]<t);o=s[a][0];while(e.scalefac_band.l[o+1]>t)o--;o<0&&(o=s[a][0]),e.bv_scf[t-2]=o,o=s[a][1];while(e.scalefac_band.l[o+e.bv_scf[t-2]+2]>t)o--;o<0&&(o=s[a][1]),e.bv_scf[t-1]=o}}}var l_=jg.System,c_=jg.Arrays,d_=jg.new_byte,u_=jg.new_float_n,m_=jg.new_int,h_=jg.assert;function p_(){var e=this,t=32773,s=null,o=null,a=null,n=null;this.setModules=function(e,t,r,i){s=e,o=t,a=r,n=i};var r=null,i=0,l=0,c=0;function d(e){l_.arraycopy(e.header[e.w_ptr].buf,0,r,l,e.sideinfo_len),l+=e.sideinfo_len,i+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&jv.MAX_HEADER_BUF-1}function u(e,t,s){while(s>0){var o;0==c&&(c=8,l++,h_(e.header[e.w_ptr].write_timing>=i),e.header[e.w_ptr].write_timing==i&&d(e),r[l]=0),o=Math.min(s,c),s-=o,c-=o,r[l]|=t>>s<<c,i+=o}}function m(e,t,s){while(s>0){var o;0==c&&(c=8,l++,r[l]=0),o=Math.min(s,c),s-=o,c-=o,r[l]|=t>>s<<c,i+=o}}function h(e,t){var s,o=e.internal_flags;if(t>=8&&(u(o,76,8),t-=8),t>=8&&(u(o,65,8),t-=8),t>=8&&(u(o,77,8),t-=8),t>=8&&(u(o,69,8),t-=8),t>=32){var n=a.getLameShortVersion();if(t>=32)for(s=0;s<n.length&&t>=8;++s)t-=8,u(o,n.charAt(s),8)}for(;t>=1;t-=1)u(o,o.ancillary_flag,1),o.ancillary_flag^=e.disable_reservoir?0:1}function p(e,t,s){var o=e.header[e.h_ptr].ptr;while(s>0){var a=Math.min(s,8-(7&o));s-=a,e.header[e.h_ptr].buf[o>>3]|=t>>s<<8-(7&o)-a,o+=a}e.header[e.h_ptr].ptr=o}function f(e,s){e<<=8;for(var o=0;o<8;o++)e<<=1,s<<=1,0!=(65536&(s^e))&&(s^=t);return s}function g(e,t){var s,o,a,n=e.internal_flags;if(s=n.l3_side,n.header[n.h_ptr].ptr=0,c_.fill(n.header[n.h_ptr].buf,0,n.sideinfo_len,0),e.out_samplerate<16e3?p(n,4094,12):p(n,4095,12),p(n,e.version,1),p(n,1,2),p(n,e.error_protection?0:1,1),p(n,n.bitrate_index,4),p(n,n.samplerate_index,2),p(n,n.padding,1),p(n,e.extension,1),p(n,e.mode.ordinal(),2),p(n,n.mode_ext,2),p(n,e.copyright,1),p(n,e.original,1),p(n,e.emphasis,2),e.error_protection&&p(n,0,16),1==e.version){for(h_(s.main_data_begin>=0),p(n,s.main_data_begin,9),2==n.channels_out?p(n,s.private_bits,3):p(n,s.private_bits,5),a=0;a<n.channels_out;a++){var r;for(r=0;r<4;r++)p(n,s.scfsi[a][r],1)}for(o=0;o<2;o++)for(a=0;a<n.channels_out;a++){var i=s.tt[o][a];p(n,i.part2_3_length+i.part2_length,12),p(n,i.big_values/2,9),p(n,i.global_gain,8),p(n,i.scalefac_compress,4),i.block_type!=Jg.NORM_TYPE?(p(n,1,1),p(n,i.block_type,2),p(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),p(n,i.subblock_gain[0],3),p(n,i.subblock_gain[1],3),p(n,i.subblock_gain[2],3)):(p(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),p(n,i.table_select[2],5),h_(i.region0_count>=0&&i.region0_count<16),h_(i.region1_count>=0&&i.region1_count<8),p(n,i.region0_count,4),p(n,i.region1_count,3)),p(n,i.preflag,1),p(n,i.scalefac_scale,1),p(n,i.count1table_select,1)}}else for(h_(s.main_data_begin>=0),p(n,s.main_data_begin,8),p(n,s.private_bits,n.channels_out),o=0,a=0;a<n.channels_out;a++){i=s.tt[o][a];p(n,i.part2_3_length+i.part2_length,12),p(n,i.big_values/2,9),p(n,i.global_gain,8),p(n,i.scalefac_compress,9),i.block_type!=Jg.NORM_TYPE?(p(n,1,1),p(n,i.block_type,2),p(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),p(n,i.subblock_gain[0],3),p(n,i.subblock_gain[1],3),p(n,i.subblock_gain[2],3)):(p(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),p(n,i.table_select[2],5),h_(i.region0_count>=0&&i.region0_count<16),h_(i.region1_count>=0&&i.region1_count<8),p(n,i.region0_count,4),p(n,i.region1_count,3)),p(n,i.scalefac_scale,1),p(n,i.count1table_select,1)}e.error_protection&&CRC_writeheader(n,n.header[n.h_ptr].buf);var l=n.h_ptr;h_(n.header[l].ptr==8*n.sideinfo_len),n.h_ptr=l+1&jv.MAX_HEADER_BUF-1,n.header[n.h_ptr].write_timing=n.header[l].write_timing+t,n.h_ptr==n.w_ptr&&l_.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function v(e,t){var s,o=Gv.ht[t.count1table_select+32],a=0,n=t.big_values,r=t.big_values;for(h_(t.count1table_select<2),s=(t.count1-t.big_values)/4;s>0;--s){var i,l=0,c=0;i=t.l3_enc[n+0],0!=i&&(c+=8,t.xr[r+0]<0&&l++),i=t.l3_enc[n+1],0!=i&&(c+=4,l*=2,t.xr[r+1]<0&&l++),i=t.l3_enc[n+2],0!=i&&(c+=2,l*=2,t.xr[r+2]<0&&l++),i=t.l3_enc[n+3],0!=i&&(c++,l*=2,t.xr[r+3]<0&&l++),n+=4,r+=4,u(e,l+o.table[c],o.hlen[c]),a+=o.hlen[c]}return a}function _(e,t,s,o,a){var n=Gv.ht[t],r=0;if(0==t)return r;for(var i=s;i<o;i+=2){var l=0,c=0,d=n.xlen,m=n.xlen,h=0,p=a.l3_enc[i],f=a.l3_enc[i+1];if(0!=p&&(a.xr[i]<0&&h++,l--),t>15){if(p>14){var g=p-15;h_(g<=n.linmax),h|=g<<1,c=d,p=15}if(f>14){var v=f-15;h_(v<=n.linmax),h<<=d,h|=v,c+=d,f=15}m=16}0!=f&&(h<<=1,a.xr[i+1]<0&&h++,l--),p=p*m+f,c-=l,l+=n.hlen[p],u(e,n.table[p],l),u(e,h,c),r+=l+c}return r}function b(e,t){var s=3*e.scalefac_band.s[3];s>t.big_values&&(s=t.big_values);var o=_(e,t.table_select[0],0,s,t);return o+=_(e,t.table_select[1],s,t.big_values,t),o}function y(e,t){var s,o,a,n;s=t.big_values;var r=t.region0_count+1;return h_(r<e.scalefac_band.l.length),a=e.scalefac_band.l[r],r+=t.region1_count+1,h_(r<e.scalefac_band.l.length),n=e.scalefac_band.l[r],a>s&&(a=s),n>s&&(n=s),o=_(e,t.table_select[0],0,a,t),o+=_(e,t.table_select[1],a,n,t),o+=_(e,t.table_select[2],n,s,t),o}function x(e){var t,s,o,a,n=0,r=e.internal_flags,i=r.l3_side;if(1==e.version)for(t=0;t<2;t++)for(s=0;s<r.channels_out;s++){var l=i.tt[t][s],c=i_.slen1_tab[l.scalefac_compress],d=i_.slen2_tab[l.scalefac_compress];for(a=0,o=0;o<l.sfbdivide;o++)-1!=l.scalefac[o]&&(u(r,l.scalefac[o],c),a+=c);for(;o<l.sfbmax;o++)-1!=l.scalefac[o]&&(u(r,l.scalefac[o],d),a+=d);h_(a==l.part2_length),l.block_type==Jg.SHORT_TYPE?a+=b(r,l):a+=y(r,l),a+=v(r,l),h_(a==l.part2_3_length+l.part2_length),n+=a}else for(t=0,s=0;s<r.channels_out;s++){l=i.tt[t][s];var m,h,p=0;if(h_(null!=l.sfb_partition_table),a=0,o=0,h=0,l.block_type==Jg.SHORT_TYPE){for(;h<4;h++){var f=l.sfb_partition_table[h]/3,g=l.slen[h];for(m=0;m<f;m++,o++)u(r,Math.max(l.scalefac[3*o+0],0),g),u(r,Math.max(l.scalefac[3*o+1],0),g),u(r,Math.max(l.scalefac[3*o+2],0),g),p+=3*g}a+=b(r,l)}else{for(;h<4;h++){f=l.sfb_partition_table[h],g=l.slen[h];for(m=0;m<f;m++,o++)u(r,Math.max(l.scalefac[o],0),g),p+=g}a+=y(r,l)}a+=v(r,l),h_(a==l.part2_3_length),h_(p==l.part2_length),n+=p+a}return n}function w(){this.total=0}function k(t,s){var o,a,n,r,c,d=t.internal_flags;return c=d.w_ptr,r=d.h_ptr-1,-1==r&&(r=jv.MAX_HEADER_BUF-1),o=d.header[r].write_timing-i,s.total=o,o>=0&&(a=1+r-c,r<c&&(a=1+r-c+jv.MAX_HEADER_BUF),o-=8*a*d.sideinfo_len),n=e.getframebits(t),o+=n,s.total+=n,s.total%8!=0?s.total=1+s.total/8:s.total=s.total/8,s.total+=l+1,o<0&&l_.err.println("strange error flushing buffer ... \n"),o}this.getframebits=function(e){var t,s=e.internal_flags;t=0!=s.bitrate_index?Gv.bitrate_table[e.version][s.bitrate_index]:e.brate;var o=0|72e3*(e.version+1)*t/e.out_samplerate+s.padding;return 8*o},this.CRC_writeheader=function(e,t){var s=65535;s=f(255&t[2],s),s=f(255&t[3],s);for(var o=6;o<e.sideinfo_len;o++)s=f(255&t[o],s);t[4]=byte(s>>8),t[5]=byte(255&s)},this.flush_bitstream=function(e){var t,o,a=e.internal_flags,n=a.h_ptr-1;if(-1==n&&(n=jv.MAX_HEADER_BUF-1),t=a.l3_side,!((o=k(e,new w))<0)){if(h(e,o),h_(a.header[n].write_timing+this.getframebits(e)==i),a.ResvSize=0,t.main_data_begin=0,a.findReplayGain){var r=s.GetTitleGain(a.rgdata);h_(NEQ(r,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),a.RadioGain=0|Math.floor(10*r+.5)}a.findPeakSample&&(a.noclipGainChange=0|Math.ceil(20*Math.log10(a.PeakSample/32767)*10),a.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?a.noclipScale=Math.floor(32767/a.PeakSample*100)/100:a.noclipScale=-1)}},this.add_dummy_byte=function(e,t,s){var o,a=e.internal_flags;while(s-- >0)for(m(a,t,8),o=0;o<jv.MAX_HEADER_BUF;++o)a.header[o].write_timing+=8},this.format_bitstream=function(e){var t,s=e.internal_flags;t=s.l3_side;var o=this.getframebits(e);h(e,t.resvDrain_pre),g(e,o);var a=8*s.sideinfo_len;if(a+=x(e),h(e,t.resvDrain_post),a+=t.resvDrain_post,t.main_data_begin+=(o-a)/8,k(e,new w)!=s.ResvSize&&l_.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=s.ResvSize&&(l_.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,s.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*s.sideinfo_len,a-t.resvDrain_post-8*s.sideinfo_len,a,a%8,o),l_.err.println("This is a fatal error.  It has several possible causes:"),l_.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),l_.err.println(" 9%%  Your system is overclocked"),l_.err.println(" 1%%  bug in LAME encoding library"),s.ResvSize=8*t.main_data_begin),i>1e9){var n;for(n=0;n<jv.MAX_HEADER_BUF;++n)s.header[n].write_timing-=i;i=0}return 0},this.copy_buffer=function(e,t,a,i,d){var u=l+1;if(u<=0)return 0;if(0!=i&&u>i)return-1;if(l_.arraycopy(r,0,t,a,u),l=-1,c=0,0!=d){var m=m_(1);if(m[0]=e.nMusicCRC,n.updateMusicCRC(m,t,a,u),e.nMusicCRC=m[0],u>0&&(e.VBR_seek_table.nBytesWritten+=u),e.decode_on_the_fly){var h,p=u_([2,1152]),f=u,g=-1;while(0!=g)if(g=o.hip_decode1_unclipped(e.hip,t,a,f,p[0],p[1]),f=0,-1==g&&(g=0),g>0){if(e.findPeakSample){for(h=0;h<g;h++)p[0][h]>e.PeakSample?e.PeakSample=p[0][h]:-p[0][h]>e.PeakSample&&(e.PeakSample=-p[0][h]);if(e.channels_out>1)for(h=0;h<g;h++)p[1][h]>e.PeakSample?e.PeakSample=p[1][h]:-p[1][h]>e.PeakSample&&(e.PeakSample=-p[1][h])}if(e.findReplayGain&&s.AnalyzeSamples(e.rgdata,p[0],0,p[1],0,g,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return u},this.init_bit_stream_w=function(e){r=d_(w_.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,l=-1,c=0,i=0}}p_.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},p_.NEQ=function(e,t){return!p_.EQ(e,t)};var f_=jg.System,g_=jg.VbrMode,v_=jg.ShortBlock,__=jg.new_float,b_=jg.new_int_n,y_=jg.new_short_n,x_=jg.assert;function w_(){var e=this,t=131072;w_.V9=410,w_.V8=420,w_.V7=430,w_.V6=440,w_.V5=450,w_.V4=460,w_.V3=470,w_.V2=480,w_.V1=490,w_.V0=500,w_.R3MIX=1e3,w_.STANDARD=1001,w_.EXTREME=1002,w_.INSANE=1003,w_.STANDARD_FAST=1004,w_.EXTREME_FAST=1005,w_.MEDIUM=1006,w_.MEDIUM_FAST=1007;var s,o,a,n,r,i=16384+t;w_.LAME_MAXMP3BUFFER=i;var l,c,d,u=new mv;function m(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=__(Jg.SBMAX_l),this.bo_s_weight=__(Jg.SBMAX_s)}function h(){this.lowerlimit=0}function p(e,t){this.lowpass=t}this.enc=new Jg,this.setModules=function(e,t,i,m,h,p,f,g,v){s=e,o=t,a=i,n=m,r=h,l=p,c=g,d=v,this.enc.setModules(o,u,n,l)};var f=4294479419;function g(e){var t;return e.class_id=f,t=e.internal_flags=new jv,e.mode=zg.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=g_.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=Jg.ENCDELAY+Jg.POSTDELAY,e.encoder_padding=0,t.mf_size=Jg.ENCDELAY-Jg.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}function v(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function _(e,t){var s=44100;return t>=48e3?s=48e3:t>=44100?s=44100:t>=32e3?s=32e3:t>=24e3?s=24e3:t>=22050?s=22050:t>=16e3?s=16e3:t>=12e3?s=12e3:t>=11025?s=11025:t>=8e3&&(s=8e3),-1==e?s:(e<=15960&&(s=44100),e<=15250&&(s=32e3),e<=11220&&(s=24e3),e<=9970&&(s=22050),e<=7230&&(s=16e3),e<=5420&&(s=12e3),e<=4510&&(s=11025),e<=3970&&(s=8e3),t<s?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:s)}function b(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function y(e,t,s){s<16e3&&(t=2);for(var o=Gv.bitrate_table[t][1],a=2;a<=14;a++)Gv.bitrate_table[t][a]>0&&Math.abs(Gv.bitrate_table[t][a]-e)<Math.abs(o-e)&&(o=Gv.bitrate_table[t][a]);return o}function x(e,t,s){s<16e3&&(t=2);for(var o=0;o<=14;o++)if(Gv.bitrate_table[t][o]>0&&Gv.bitrate_table[t][o]==e)return o;return-1}function w(t,s){var o=[new p(8,2e3),new p(16,3700),new p(24,3900),new p(32,5500),new p(40,7e3),new p(48,7500),new p(56,1e4),new p(64,11e3),new p(80,13500),new p(96,15100),new p(112,15600),new p(128,17e3),new p(160,17500),new p(192,18600),new p(224,19400),new p(256,19700),new p(320,20500)],a=e.nearestBitrateFullIndex(s);t.lowerlimit=o[a].lowpass}function k(e){var t=e.internal_flags,s=32,o=-1;if(t.lowpass1>0){for(var a=999,n=0;n<=31;n++){var r=n/31;r>=t.lowpass2&&(s=Math.min(s,n)),t.lowpass1<r&&r<t.lowpass2&&(a=Math.min(a,n))}t.lowpass1=999==a?(s-.75)/31:(a-.75)/31,t.lowpass2=s/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,f_.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var i=-1;for(n=0;n<=31;n++){r=n/31;r<=t.highpass1&&(o=Math.max(o,n)),t.highpass1<r&&r<t.highpass2&&(i=Math.max(i,n))}t.highpass1=o/31,t.highpass2=-1==i?(o+.75)/31:(i+.75)/31}for(n=0;n<32;n++){var l,c;r=n/31;l=t.highpass2>t.highpass1?v((t.highpass2-r)/(t.highpass2-t.highpass1+1e-20)):1,c=t.lowpass2>t.lowpass1?v((r-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[n]=l*c}}function M(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break}}function S(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&c.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=b_([16,5]),t.bitrate_blockType_Hist=b_([16,6]),t.PeakSample=0,e.bWriteVbrTag&&l.InitVbrTag(e)}function R(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=__(t),e.in_buffer_1=__(t),e.in_buffer_nsamples=t)}function A(e){var t=Jg.BLKSIZE+e.framesize-Jg.FFTOFFSET;return t=Math.max(t,512+e.framesize-32),t}function E(e,t,a,n,r,i,l){var c,d,u,m,h,p=e.internal_flags,g=0,v=[null,null],_=[null,null];if(p.Class_ID!=f)return-3;if(0==n)return 0;if(h=o.copy_buffer(p,r,i,l,0),h<0)return h;if(i+=h,g+=h,_[0]=t,_[1]=a,p_.NEQ(e.scale,0)&&p_.NEQ(e.scale,1))for(d=0;d<n;++d)_[0][d]*=e.scale,2==p.channels_out&&(_[1][d]*=e.scale);if(p_.NEQ(e.scale_left,0)&&p_.NEQ(e.scale_left,1))for(d=0;d<n;++d)_[0][d]*=e.scale_left;if(p_.NEQ(e.scale_right,0)&&p_.NEQ(e.scale_right,1))for(d=0;d<n;++d)_[1][d]*=e.scale_right;if(2==e.num_channels&&1==p.channels_out)for(d=0;d<n;++d)_[0][d]=.5*(_[0][d]+_[1][d]),_[1][d]=0;m=A(e),v[0]=p.mfbuf[0],v[1]=p.mfbuf[1];var b=0;while(n>0){var y=[null,null],x=0,w=0;y[0]=_[0],y[1]=_[1];var k=new I;if(L(e,v,y,b,n,k),x=k.n_in,w=k.n_out,p.findReplayGain&&!p.decode_on_the_fly&&s.AnalyzeSamples(p.rgdata,v[0],p.mf_size,v[1],p.mf_size,w,p.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(n-=x,b+=x,p.channels_out,p.mf_size+=w,x_(p.mf_size<=jv.MFSIZE),p.mf_samples_to_encode<1&&(p.mf_samples_to_encode=Jg.ENCDELAY+Jg.POSTDELAY),p.mf_samples_to_encode+=w,p.mf_size>=m){var M=l-g;if(0==l&&(M=0),c=T(e,v[0],v[1],r,i,M),c<0)return c;for(i+=c,g+=c,p.mf_size-=e.framesize,p.mf_samples_to_encode-=e.framesize,u=0;u<p.channels_out;u++)for(d=0;d<p.mf_size;d++)v[u][d]=v[u][d+e.framesize]}}return g}function T(t,s,o,a,n,r){var i=e.enc.lame_encode_mp3_frame(t,s,o,a,n,r);return t.frameNum++,i}function I(){this.n_in=0,this.n_out=0}function O(){this.num_used=0}function B(e,t){return 0!=t?B(t,e%t):e}function C(e,t,s){var o=Math.PI*t;e/=s,e<0&&(e=0),e>1&&(e=1);var a=e-.5,n=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(a)<1e-9?o/Math.PI:n*Math.sin(s*o*a)/(Math.PI*s*a)}function j(e,t,s,o,a,n,r,i,l){var c,d,u=e.internal_flags,m=0,h=e.out_samplerate/B(e.out_samplerate,e.in_samplerate);h>jv.BPC&&(h=jv.BPC);var p=Math.abs(u.resample_ratio-Math.floor(.5+u.resample_ratio))<1e-4?1:0,f=1/u.resample_ratio;f>1&&(f=1);var g=31;g%2==0&&--g,g+=p;var v=g+1;if(0==u.fill_buffer_resample_init){for(u.inbuf_old[0]=__(v),u.inbuf_old[1]=__(v),c=0;c<=2*h;++c)u.blackfilt[c]=__(v);for(u.itime[0]=0,u.itime[1]=0,m=0;m<=2*h;m++){var _=0,b=(m-h)/(2*h);for(c=0;c<=g;c++)_+=u.blackfilt[m][c]=C(c-b,f,g);for(c=0;c<=g;c++)u.blackfilt[m][c]/=_}u.fill_buffer_resample_init=1}var y=u.inbuf_old[l];for(d=0;d<o;d++){var x,w;if(x=d*u.resample_ratio,m=0|Math.floor(x-u.itime[l]),g+m-g/2>=r)break;b=x-u.itime[l]-(m+g%2*.5);w=0|Math.floor(2*b*h+h+.5);var k=0;for(c=0;c<=g;++c){var M,S=0|c+m-g/2;M=S<0?y[v+S]:a[n+S],k+=M*u.blackfilt[w][c]}t[s+d]=k}if(i.num_used=Math.min(r,g+m-g/2),u.itime[l]+=i.num_used-d*u.resample_ratio,i.num_used>=v)for(c=0;c<v;c++)y[c]=a[n+i.num_used+c-v];else{var R=v-i.num_used;for(c=0;c<R;++c)y[c]=y[c+i.num_used];for(m=0;c<v;++c,++m)y[c]=a[n+m];x_(m==i.num_used)}return d}function L(e,t,s,o,a,n){var r=e.internal_flags;if(r.resample_ratio<.9999||r.resample_ratio>1.0001)for(var i=0;i<r.channels_out;i++){var l=new O;n.n_out=j(e,t[i],r.mf_size,e.framesize,s[i],o,a,l,i),n.n_in=l.num_used}else{n.n_out=Math.min(e.framesize,a),n.n_in=n.n_out;for(var c=0;c<n.n_out;++c)t[0][r.mf_size+c]=s[0][o+c],2==r.channels_out&&(t[1][r.mf_size+c]=s[1][o+c])}}this.lame_init=function(){var e=new hv;return g(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],s=0,o=0,a=0,n=0;n=t[16],a=16,o=t[16],s=16;for(var r=0;r<16;r++)if(Math.max(e,t[r+1])!=e){n=t[r+1],a=r+1,o=t[r],s=r;break}return n-e>e-o?s:a},this.lame_init_params=function(e){var t=e.internal_flags;if(t.Class_ID=0,null==t.ATH&&(t.ATH=new Pv),null==t.PSY&&(t.PSY=new m),null==t.rgdata&&(t.rgdata=new $v),t.channels_in=e.num_channels,1==t.channels_in&&(e.mode=zg.MONO),t.channels_out=e.mode==zg.MONO?1:2,t.mode_ext=Jg.MPG_MD_MS_LR,e.mode==zg.MONO&&(e.force_ms=!1),e.VBR==g_.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==g_.vbr_off||e.VBR==g_.vbr_mtrh||e.VBR==g_.vbr_mt||(e.free_format=!1),e.VBR==g_.vbr_off&&0==e.brate&&p_.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==g_.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*t.channels_out/(1e3*e.compression_ratio),t.samplerate_index=b(e.out_samplerate,e),e.free_format||(e.brate=y(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var i=16e3;switch(e.VBR){case g_.vbr_off:var l=new h;w(l,e.brate),i=l.lowerlimit;break;case g_.vbr_abr:l=new h;w(l,e.VBR_mean_bitrate_kbps),i=l.lowerlimit;break;case g_.vbr_rh:var c=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var p=c[e.VBR_q],g=c[e.VBR_q+1],v=e.VBR_q_frac;i=linear_int(p,g,v)}else i=19500;break;default:c=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){p=c[e.VBR_q],g=c[e.VBR_q+1],v=e.VBR_q_frac;i=linear_int(p,g,v)}else i=19500}e.mode!=zg.MONO||e.VBR!=g_.vbr_off&&e.VBR!=g_.vbr_abr||(i*=1.5),e.lowpassfreq=0|i}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=_(0|e.lowpassfreq,e.in_samplerate)),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==g_.vbr_off&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)),e.VBR==g_.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,t.findPeakSample=!1),t.findReplayGain=e.findReplayGain,t.decode_on_the_fly=e.decode_on_the_fly,t.decode_on_the_fly&&(t.findPeakSample=!0),t.findReplayGain&&s.InitGainAnalysis(t.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(t.decode_on_the_fly&&!e.decode_only&&(null!=t.hip&&d.hip_decode_exit(t.hip),t.hip=d.hip_decode_init()),t.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*t.mode_gr,e.encoder_delay=Jg.ENCDELAY,t.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case g_.vbr_mt:case g_.vbr_rh:case g_.vbr_mtrh:var R=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];e.compression_ratio=R[e.VBR_q];break;case g_.vbr_abr:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate);break}if(e.mode==zg.NOT_SET&&(e.mode=zg.JOINT_STEREO),e.highpassfreq>0?(t.highpass1=2*e.highpassfreq,e.highpasswidth>=0?t.highpass2=2*(e.highpassfreq+e.highpasswidth):t.highpass2=2*e.highpassfreq,t.highpass1/=e.out_samplerate,t.highpass2/=e.out_samplerate):(t.highpass1=0,t.highpass2=0),e.lowpassfreq>0?(t.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(t.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),t.lowpass1<0&&(t.lowpass1=0)):t.lowpass1=2*e.lowpassfreq,t.lowpass1/=e.out_samplerate,t.lowpass2/=e.out_samplerate):(t.lowpass1=0,t.lowpass2=0),k(e),t.samplerate_index=b(e.out_samplerate,e),t.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==g_.vbr_off){if(e.free_format)t.bitrate_index=0;else if(e.brate=y(e.brate,e.version,e.out_samplerate),t.bitrate_index=x(e.brate,e.version,e.out_samplerate),t.bitrate_index<=0)return e.internal_flags=null,-1}else t.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=t.pinfo&&(e.bWriteVbrTag=!1),o.init_bit_stream_w(t);for(var A,E=t.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),T=0;T<Jg.SBMAX_l+1;T++)t.scalefac_band.l[T]=n.sfBandIndex[E].l[T];for(T=0;T<Jg.PSFB21+1;T++){var I=(t.scalefac_band.l[22]-t.scalefac_band.l[21])/Jg.PSFB21,O=t.scalefac_band.l[21]+T*I;t.scalefac_band.psfb21[T]=O}t.scalefac_band.psfb21[Jg.PSFB21]=576;for(T=0;T<Jg.SBMAX_s+1;T++)t.scalefac_band.s[T]=n.sfBandIndex[E].s[T];for(T=0;T<Jg.PSFB12+1;T++){I=(t.scalefac_band.s[13]-t.scalefac_band.s[12])/Jg.PSFB12,O=t.scalefac_band.s[12]+T*I;t.scalefac_band.psfb12[T]=O}for(t.scalefac_band.psfb12[Jg.PSFB12]=192,1==e.version?t.sideinfo_len=1==t.channels_out?21:36:t.sideinfo_len=1==t.channels_out?13:21,e.error_protection&&(t.sideinfo_len+=2),S(e),t.Class_ID=f,A=0;A<19;A++)t.nsPsy.pefirbuf[A]=700*t.mode_gr*t.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),x_(e.VBR_q<=9),x_(e.VBR_q>=0),e.VBR){case g_.vbr_mt:e.VBR=g_.vbr_mtrh;case g_.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),a.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,t.iteration_loop=new VBRNewIterationLoop(r);break;case g_.vbr_rh:a.apply_preset(e,500-10*e.VBR_q,0),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),t.iteration_loop=new VBROldIterationLoop(r);break;default:var B;t.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),B=e.VBR,B==g_.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),a.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=B,t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,B==g_.vbr_off?t.iteration_loop=new Xv(r):t.iteration_loop=new ABRIterationLoop(r);break}if(x_(e.scale>=0),e.VBR!=g_.vbr_off){if(t.VBR_min_bitrate=1,t.VBR_max_bitrate=14,e.out_samplerate<16e3&&(t.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=y(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate=x(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=y(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate=x(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=Gv.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_max_bitrate_kbps=Gv.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(Gv.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(Gv.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(t.PSY.mask_adjust+=e.tune_value_a,t.PSY.mask_adjust_short+=e.tune_value_a),M(e),x_(e.scale>=0),e.athaa_type<0?t.ATH.useAdjust=3:t.ATH.useAdjust=e.athaa_type,t.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=v_.short_block_allowed),e.short_blocks!=v_.short_block_allowed||e.mode!=zg.JOINT_STEREO&&e.mode!=zg.STEREO||(e.short_blocks=v_.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=mv.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=mv.NSATTACKTHRE_S),x_(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),t.slot_lag=t.frac_SpF=0,e.VBR==g_.vbr_off&&(t.slot_lag=t.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),n.iteration_init(e),u.psymodel_init(e),x_(e.scale>=0),0},this.lame_encode_flush=function(e,t,s,a){var n,r,i,l,d=e.internal_flags,u=y_([2,1152]),m=0,h=d.mf_samples_to_encode-Jg.POSTDELAY,p=A(e);if(d.mf_samples_to_encode<1)return 0;n=0,e.in_samplerate!=e.out_samplerate&&(h+=16*e.out_samplerate/e.in_samplerate),i=e.framesize-h%e.framesize,i<576&&(i+=e.framesize),e.encoder_padding=i,l=(h+i)/e.framesize;while(l>0&&m>=0){var f=p-d.mf_size,g=e.frameNum;f*=e.in_samplerate,f/=e.out_samplerate,f>1152&&(f=1152),f<1&&(f=1),r=a-n,0==a&&(r=0),m=this.lame_encode_buffer(e,u[0],u[1],f,t,s,r),s+=m,n+=m,l-=g!=e.frameNum?1:0}if(d.mf_samples_to_encode=0,m<0)return m;if(r=a-n,0==a&&(r=0),o.flush_bitstream(e),m=o.copy_buffer(d,t,s,r,1),m<0)return m;if(s+=m,n+=m,r=a-n,0==a&&(r=0),e.write_id3tag_automatic){if(c.id3tag_write_v1(e),m=o.copy_buffer(d,t,s,r,0),m<0)return m;n+=m}return n},this.lame_encode_buffer=function(e,t,s,o,a,n,r){var i=e.internal_flags,l=[null,null];if(i.Class_ID!=f)return-3;if(0==o)return 0;R(i,o),l[0]=i.in_buffer_0,l[1]=i.in_buffer_1;for(var c=0;c<o;c++)l[0][c]=t[c],i.channels_in>1&&(l[1][c]=s[c]);return E(e,l[0],l[1],o,a,n,r)}}var k_=jg.VbrMode;function M_(){function e(e,t,s,o,a,n,r,i,l,c,d,u,m,h,p){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=s,this.expY=o,this.st_lrm=a,this.st_s=n,this.masking_adj=r,this.masking_adj_short=i,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=d,this.interch=u,this.safejoint=m,this.sfb21mod=h,this.msfix=p}function t(e,t,s,o,a,n,r,i,l,c,d,u,m,h){this.quant_comp=t,this.quant_comp_s=s,this.safejoint=o,this.nsmsfix=a,this.st_lrm=n,this.st_s=r,this.nsbass=i,this.scale=l,this.masking_adj=c,this.ath_lower=d,this.ath_curve=u,this.interch=m,this.sfscale=h}var s;this.setModules=function(e){s=e};var o=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],a=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function n(e,t,s){var n=e.VBR==k_.vbr_rh?o:a,r=e.VBR_q_frac,i=n[t],c=n[t+1],d=i;i.st_lrm=i.st_lrm+r*(c.st_lrm-i.st_lrm),i.st_s=i.st_s+r*(c.st_s-i.st_s),i.masking_adj=i.masking_adj+r*(c.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+r*(c.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+r*(c.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+r*(c.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+r*(c.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+r*(c.interch-i.interch),i.msfix=i.msfix+r*(c.msfix-i.msfix),l(e,d.vbr_q),0!=s?e.quant_comp=d.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=d.quant_comp),0!=s?e.quant_comp_short=d.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=d.quant_comp_s),0!=d.expY&&(e.experimentalY=0!=d.expY),0!=s?e.internal_flags.nsPsy.attackthre=d.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=d.st_lrm),0!=s?e.internal_flags.nsPsy.attackthre_s=d.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=d.st_s),0!=s?e.maskingadjust=d.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=d.masking_adj),0!=s?e.maskingadjust_short=d.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=d.masking_adj_short),0!=s?e.ATHlower=-d.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-d.ath_lower/10),0!=s?e.ATHcurve=d.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=d.ath_curve),0!=s?e.athaa_sensitivity=d.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=d.ath_sensitivity),d.interch>0&&(0!=s?e.interChRatio=d.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=d.interch)),d.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|d.safejoint),d.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|d.sfb21mod<<20),0!=s?e.msfix=d.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=d.msfix),0==s&&(e.VBR_q=t,e.VBR_q_frac=r)}var r=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function i(e,t,o){var a=t,n=s.nearestBitrateFullIndex(t);if(e.VBR=k_.vbr_abr,e.VBR_mean_bitrate_kbps=a,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),r[n].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),r[n].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(r[n].nsbass)>0){var i=int(4*r[n].nsbass);i<0&&(i+=64),e.exp_nspsytune=e.exp_nspsytune|i<<2}return 0!=o?e.quant_comp=r[n].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=r[n].quant_comp),0!=o?e.quant_comp_short=r[n].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=r[n].quant_comp_s),0!=o?e.msfix=r[n].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=r[n].nsmsfix),0!=o?e.internal_flags.nsPsy.attackthre=r[n].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=r[n].st_lrm),0!=o?e.internal_flags.nsPsy.attackthre_s=r[n].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=r[n].st_s),0!=o?e.scale=r[n].scale:Math.abs(e.scale- -1)>0||(e.scale=r[n].scale),0!=o?e.maskingadjust=r[n].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=r[n].masking_adj),r[n].masking_adj>0?0!=o?e.maskingadjust_short=.9*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*r[n].masking_adj):0!=o?e.maskingadjust_short=1.1*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*r[n].masking_adj),0!=o?e.ATHlower=-r[n].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-r[n].ath_lower/10),0!=o?e.ATHcurve=r[n].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=r[n].ath_curve),0!=o?e.interChRatio=r[n].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=r[n].interch),t}function l(e,t){var s=0;return t<0&&(s=-1,t=0),t>9&&(s=-1,t=9),e.VBR_q=t,e.VBR_q_frac=0,s}this.apply_preset=function(e,t,s){switch(t){case w_.R3MIX:t=w_.V3,e.VBR=k_.vbr_mtrh;break;case w_.MEDIUM:t=w_.V4,e.VBR=k_.vbr_rh;break;case w_.MEDIUM_FAST:t=w_.V4,e.VBR=k_.vbr_mtrh;break;case w_.STANDARD:t=w_.V2,e.VBR=k_.vbr_rh;break;case w_.STANDARD_FAST:t=w_.V2,e.VBR=k_.vbr_mtrh;break;case w_.EXTREME:t=w_.V0,e.VBR=k_.vbr_rh;break;case w_.EXTREME_FAST:t=w_.V0,e.VBR=k_.vbr_mtrh;break;case w_.INSANE:return t=320,e.preset=t,i(e,t,s),e.VBR=k_.vbr_off,t}switch(e.preset=t,t){case w_.V9:return n(e,9,s),t;case w_.V8:return n(e,8,s),t;case w_.V7:return n(e,7,s),t;case w_.V6:return n(e,6,s),t;case w_.V5:return n(e,5,s),t;case w_.V4:return n(e,4,s),t;case w_.V3:return n(e,3,s),t;case w_.V2:return n(e,2,s),t;case w_.V1:return n(e,1,s),t;case w_.V0:return n(e,0,s),t}return t>=8&&t<=320?i(e,t,s):(e.preset=0,t)}}function S_(){this.setModules=function(e,t){}}function R_(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var A_=jg.new_float,E_=jg.new_int;function T_(){this.global_gain=0,this.sfb_count1=0,this.step=E_(39),this.noise=A_(39),this.noise_log=A_(39)}var I_=jg.System,O_=jg.VbrMode,B_=jg.Util,C_=jg.Arrays,j_=jg.new_float,L_=jg.assert;function P_(){var e,t,s;this.rv=null,this.qupvt=null;var o,a=new S_;function n(e,t,s,o){o=0;for(var a=0;a<=s;++a){var n=Math.abs(e.xr[a]);o+=n,t[a]=Math.sqrt(n*Math.sqrt(n)),t[a]>e.xrpow_max&&(e.xrpow_max=t[a])}return o}function r(e,t){var o=e.ATH,a=t.xr;if(t.block_type!=Jg.SHORT_TYPE)for(var n=!1,r=Jg.PSFB21-1;r>=0&&!n;r--){var i=e.scalefac_band.psfb21[r],l=e.scalefac_band.psfb21[r+1],c=s.athAdjust(o.adjust,o.psfb21[r],o.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var d=l-1;d>=i;d--){if(!(Math.abs(a[d])<c)){n=!0;break}a[d]=0}}else for(var u=0;u<3;u++)for(n=!1,r=Jg.PSFB12-1;r>=0&&!n;r--){i=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*u+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]),l=i+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]);var m=s.athAdjust(o.adjust,o.psfb12[r],o.floor);e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]);for(d=l-1;d>=i;d--){if(!(Math.abs(a[d])<m)){n=!0;break}a[d]=0}}}function i(e){this.ordinal=e}function l(e,t,s,a,n){var r,l=e.CurrentStep[a],c=!1,d=e.OldValue[a],u=i.BINSEARCH_NONE;for(t.global_gain=d,s-=t.part2_length;;){var m;if(r=o.count_bits(e,n,t,null),1==l||r==s)break;r>s?(u==i.BINSEARCH_DOWN&&(c=!0),c&&(l/=2),u=i.BINSEARCH_UP,m=l):(u==i.BINSEARCH_UP&&(c=!0),c&&(l/=2),u=i.BINSEARCH_DOWN,m=-l),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}L_(t.global_gain>=0),L_(t.global_gain<256);while(r>s&&t.global_gain<255)t.global_gain++,r=o.count_bits(e,n,t,null);return e.CurrentStep[a]=d-t.global_gain>=4?4:2,e.OldValue[a]=t.global_gain,t.part2_3_length=r,r}function c(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function d(e){return B_.FAST_LOG10(.368+.632*e*e*e)}function u(e,t){for(var s=1e-37,o=0;o<t.psymax;o++)s+=d(e[o]);return Math.max(1e-20,s)}function m(e,t,s,o,a){var n;switch(e){default:case 9:t.over_count>0?(n=s.over_SSD<=t.over_SSD,s.over_SSD==t.over_SSD&&(n=s.bits<t.bits)):n=s.max_noise<0&&10*s.max_noise+s.bits<=10*t.max_noise+t.bits;break;case 0:n=s.over_count<t.over_count||s.over_count==t.over_count&&s.over_noise<t.over_noise||s.over_count==t.over_count&&BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 8:s.max_noise=u(a,o);case 1:n=s.max_noise<t.max_noise;break;case 2:n=s.tot_noise<t.tot_noise;break;case 3:n=s.tot_noise<t.tot_noise&&s.max_noise<t.max_noise;break;case 4:n=s.max_noise<=0&&t.max_noise>.2||s.max_noise<=0&&t.max_noise<0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise||s.max_noise<=0&&t.max_noise>0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.05&&t.max_noise>s.max_noise-.1&&s.tot_noise+s.over_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.1&&t.max_noise>s.max_noise-.15&&s.tot_noise+s.over_noise+s.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 6:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&(s.max_noise<t.max_noise||BitStream.EQ(s.max_noise,t.max_noise)&&s.tot_noise<=t.tot_noise);break;case 7:n=s.over_count<t.over_count||s.over_noise<t.over_noise;break}return 0==t.over_count&&(n=n&&s.bits<t.bits),n}function h(e,t,s,o,a){var n,r=e.internal_flags;n=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var i=0,l=0;l<t.sfbmax;l++)i<s[l]&&(i=s[l]);var c=r.noise_shaping_amp;switch(3==c&&(c=a?2:1),c){case 2:break;case 1:i>1?i=Math.pow(i,.5):i*=.95;break;case 0:default:i>1?i=1:i*=.95;break}var d=0;for(l=0;l<t.sfbmax;l++){var u,m=t.width[l];if(d+=m,!(s[l]<i)){if(0!=(2&r.substep_shaping)&&(r.pseudohalf[l]=0==r.pseudohalf[l]?1:0,0==r.pseudohalf[l]&&2==r.noise_shaping_amp))return;for(t.scalefac[l]++,u=-m;u<0;u++)o[d+u]*=n,o[d+u]>t.xrpow_max&&(t.xrpow_max=o[d+u]);if(2==r.noise_shaping_amp)return}}}function p(e,t){for(var o=1.2968395546510096,a=0,n=0;n<e.sfbmax;n++){var r=e.width[n],i=e.scalefac[n];if(0!=e.preflag&&(i+=s.pretab[n]),a+=r,0!=(1&i)){i++;for(var l=-r;l<0;l++)t[a+l]*=o,t[a+l]>e.xrpow_max&&(e.xrpow_max=t[a+l])}e.scalefac[n]=i>>1}e.preflag=0,e.scalefac_scale=1}function f(e,t,o){var a,n=t.scalefac;for(a=0;a<t.sfb_lmax;a++)if(n[a]>=16)return!0;for(var r=0;r<3;r++){var i=0,l=0;for(a=t.sfb_lmax+r;a<t.sfbdivide;a+=3)i<n[a]&&(i=n[a]);for(;a<t.sfbmax;a+=3)l<n[a]&&(l=n[a]);if(!(i<16&&l<8)){if(t.subblock_gain[r]>=7)return!0;t.subblock_gain[r]++;var c=e.scalefac_band.l[t.sfb_lmax];for(a=t.sfb_lmax+r;a<t.sfbmax;a+=3){var d=t.width[a],u=n[a];if(u-=4>>t.scalefac_scale,u>=0)n[a]=u,c+=3*d;else{n[a]=0;var m=210+(u<<t.scalefac_scale+1);p=s.IPOW20(m),c+=d*(r+1);for(var h=-d;h<0;h++)o[c+h]*=p,o[c+h]>t.xrpow_max&&(t.xrpow_max=o[c+h]);c+=d*(3-r-1)}}var p=s.IPOW20(202);c+=t.width[a]*(r+1);for(h=-t.width[a];h<0;h++)o[c+h]*=p,o[c+h]>t.xrpow_max&&(t.xrpow_max=o[c+h])}}return!1}function g(e,t,s,a,n){var r=e.internal_flags;h(e,t,s,a,n);var i=c(t);return!i&&(i=2==r.mode_gr?o.scale_bitcount(t):o.scale_bitcount_lsf(r,t),!i||(r.noise_shaping>1&&(C_.fill(r.pseudohalf,0),0==t.scalefac_scale?(p(t,a),i=!1):t.block_type==Jg.SHORT_TYPE&&r.subblock_gain>0&&(i=f(r,t,a)||c(t))),i||(i=2==r.mode_gr?o.scale_bitcount(t):o.scale_bitcount_lsf(r,t)),!i))}this.setModules=function(n,r,i,l){e=n,t=r,this.rv=r,s=i,this.qupvt=i,o=l,a.setModules(s,o)},this.ms_convert=function(e,t){for(var s=0;s<576;++s){var o=e.tt[t][0].xr[s],a=e.tt[t][1].xr[s];e.tt[t][0].xr[s]=(o+a)*(.5*B_.SQRT2),e.tt[t][1].xr[s]=(o-a)*(.5*B_.SQRT2)}},this.init_xrpow=function(e,t,s){var o=0,a=0|t.max_nonzero_coeff;if(t.xrpow_max=0,C_.fill(s,a,576,0),o=n(t,s,a,o),o>1e-20){var r=0;0!=(2&e.substep_shaping)&&(r=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=r;return!0}return C_.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=Jg.SBPSY_l,t.sfb_smin=Jg.SBPSY_s,t.psy_lmax=e.sfb21_extra?Jg.SBMAX_l:Jg.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var o=0;o<Jg.SBMAX_l;o++)t.width[o]=e.scalefac_band.l[o+1]-e.scalefac_band.l[o],t.window[o]=3;if(t.block_type==Jg.SHORT_TYPE){var a=j_(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?Jg.SBMAX_s:Jg.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(Jg.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var n=e.scalefac_band.l[t.sfb_lmax];I_.arraycopy(t.xr,0,a,0,576);for(o=t.sfb_smin;o<Jg.SBMAX_s;o++)for(var i=e.scalefac_band.s[o],l=e.scalefac_band.s[o+1],c=0;c<3;c++)for(var d=i;d<l;d++)t.xr[n++]=a[3*d+c];var u=t.sfb_lmax;for(o=t.sfb_smin;o<Jg.SBMAX_s;o++)t.width[u]=t.width[u+1]=t.width[u+2]=e.scalefac_band.s[o+1]-e.scalefac_band.s[o],t.window[u]=0,t.window[u+1]=1,t.window[u+2]=2,u+=3}t.count1bits=0,t.sfb_partition_table=s.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,C_.fill(t.scalefac,0),r(e,t)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(e,t,a,n){var r=j_(pv.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=Jg.SHORT_TYPE)&&0==(128&e.substep_shaping)){s.calc_noise(t,a,r,new R_,null);for(var i=0;i<576;i++){var l=0;0!=t.l3_enc[i]&&(l=Math.abs(t.xr[i])),n[i]=l}i=0;var c=8;t.block_type==Jg.SHORT_TYPE&&(c=6);do{var d,u,m,h,p=t.width[c];if(i+=p,!(r[c]>=1)&&(C_.sort(n,i-p,p),!BitStream.EQ(n[i-1],0))){d=(1-r[c])*a[c],u=0,h=0;do{var f;for(m=1;h+m<p;m++)if(BitStream.NEQ(n[h+i-p],n[h+i+m-p]))break;if(f=n[h+i-p]*n[h+i-p]*m,d<f){0!=h&&(u=n[h+i-p-1]);break}d-=f,h+=m}while(h<p);if(!BitStream.EQ(u,0))do{Math.abs(t.xr[i-p])<=u&&(t.l3_enc[i-p]=0)}while(--p>0)}}while(++c<t.psymax);t.part2_3_length=o.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,a,n,r,i){var c,d=e.internal_flags,u=new vv,h=j_(576),p=j_(pv.SFBMAX),f=new R_,v=new T_,_=9999999,b=!1,y=!1,x=0;if(l(d,t,i,r,n),0==d.noise_shaping)return 100;s.calc_noise(t,a,p,f,v),f.bits=t.part2_3_length,u.assign(t);var w=0;I_.arraycopy(n,0,h,0,576);while(!b){do{var k,M=new R_,S=255;if(k=0!=(2&d.substep_shaping)?20:3,d.sfb21_extra){if(p[u.sfbmax]>1)break;if(u.block_type==Jg.SHORT_TYPE&&(p[u.sfbmax+1]>1||p[u.sfbmax+2]>1))break}if(!g(e,u,p,n,y))break;0!=u.scalefac_scale&&(S=254);var R=i-u.part2_length;if(R<=0)break;while((u.part2_3_length=o.count_bits(d,n,u,v))>R&&u.global_gain<=S)u.global_gain++;if(u.global_gain>S)break;if(0==f.over_count){while((u.part2_3_length=o.count_bits(d,n,u,v))>_&&u.global_gain<=S)u.global_gain++;if(u.global_gain>S)break}if(s.calc_noise(u,a,p,M,v),M.bits=u.part2_3_length,c=t.block_type!=Jg.SHORT_TYPE?e.quant_comp:e.quant_comp_short,c=m(c,f,M,u,p)?1:0,0!=c)_=t.part2_3_length,f=M,t.assign(u),w=0,I_.arraycopy(n,0,h,0,576);else if(0==d.full_outer_loop){if(++w>k&&0==f.over_count)break;if(3==d.noise_shaping_amp&&y&&w>30)break;if(3==d.noise_shaping_amp&&y&&u.global_gain-x>15)break}}while(u.global_gain+u.scalefac_scale<255);3==d.noise_shaping_amp?y?b=!0:(u.assign(t),I_.arraycopy(h,0,n,0,576),w=0,x=u.global_gain,y=!0):b=!0}return L_(t.global_gain+t.scalefac_scale<=255),e.VBR==O_.vbr_rh||e.VBR==O_.vbr_mtrh?I_.arraycopy(h,0,n,0,576):0!=(1&d.substep_shaping)&&trancate_smallspectrums(d,t,a,n),f.over_count},this.iteration_finish_one=function(e,s,a){var n=e.l3_side,r=n.tt[s][a];o.best_scalefac_store(e,s,a,n),1==e.use_best_huffman&&o.best_huffman_divide(e,r),t.ResvAdjust(e,r)},this.VBR_encode_granule=function(e,t,s,o,a,n,r){var i,l,c=e.internal_flags,d=new vv,u=j_(576),m=r,h=r+1,p=(r+n)/2,f=0,g=c.sfb21_extra;L_(m<=LameInternalFlags.MAX_BITS_PER_CHANNEL),C_.fill(d.l3_enc,0);do{c.sfb21_extra=!(p>m-42)&&g,l=outer_loop(e,t,s,o,a,p),l<=0?(f=1,h=t.part2_3_length,d.assign(t),I_.arraycopy(o,0,u,0,576),r=h-32,i=r-n,p=(r+n)/2):(n=p+32,i=r-n,p=(r+n)/2,0!=f&&(f=2,t.assign(d),I_.arraycopy(u,0,o,0,576)))}while(i>12);c.sfb21_extra=g,2==f&&I_.arraycopy(d.l3_enc,0,t.l3_enc,0,576),L_(t.part2_3_length<=m)},this.get_framebits=function(s,o){var a=s.internal_flags;a.bitrate_index=a.VBR_min_bitrate;var n=e.getframebits(s);a.bitrate_index=1,n=e.getframebits(s);for(var r=1;r<=a.VBR_max_bitrate;r++){a.bitrate_index=r;var i=new MeanBits(n);o[r]=t.ResvFrameBegin(s,i),n=i.bits}},this.VBR_old_prepare=function(e,o,a,n,r,i,l,c,d){var u,m=e.internal_flags,h=0,p=1,f=0;m.bitrate_index=m.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/m.mode_gr;get_framebits(e,i);for(var v=0;v<m.mode_gr;v++){var _=s.on_pe(e,o,c[v],g,v,0);m.mode_ext==Jg.MPG_MD_MS_LR&&(ms_convert(m.l3_side,v),s.reduce_side(c[v],a[v],g,_));for(var b=0;b<m.channels_out;++b){var y=m.l3_side.tt[v][b];y.block_type!=Jg.SHORT_TYPE?(h=1.28/(1+Math.exp(3.5-o[v][b]/300))-.05,u=m.PSY.mask_adjust-h):(h=2.56/(1+Math.exp(3.5-o[v][b]/300))-.14,u=m.PSY.mask_adjust_short-h),m.masking_lower=Math.pow(10,.1*u),init_outer_loop(m,y),d[v][b]=s.calc_xmin(e,n[v][b],y,r[v][b]),0!=d[v][b]&&(p=0),l[v][b]=126,f+=c[v][b]}}for(v=0;v<m.mode_gr;v++)for(b=0;b<m.channels_out;b++)f>i[m.VBR_max_bitrate]&&(c[v][b]*=i[m.VBR_max_bitrate],c[v][b]/=f),l[v][b]>c[v][b]&&(l[v][b]=c[v][b]);return p},this.bitpressure_strategy=function(e,t,s,o){for(var a=0;a<e.mode_gr;a++)for(var n=0;n<e.channels_out;n++){for(var r=e.l3_side.tt[a][n],i=t[a][n],l=0,c=0;c<r.psy_lmax;c++)i[l++]*=1+.029*c*c/Jg.SBMAX_l/Jg.SBMAX_l;if(r.block_type==Jg.SHORT_TYPE)for(c=r.sfb_smin;c<Jg.SBMAX_s;c++)i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s,i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s,i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s;o[a][n]=0|Math.max(s[a][n],.9*o[a][n])}},this.VBR_new_prepare=function(e,o,a,n,r,i){var l,c=e.internal_flags,d=1,u=0,m=0;if(e.free_format){c.bitrate_index=0;h=new MeanBits(u);l=t.ResvFrameBegin(e,h),u=h.bits,r[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;var h=new MeanBits(u);t.ResvFrameBegin(e,h),u=h.bits,get_framebits(e,r),l=r[c.VBR_max_bitrate]}for(var p=0;p<c.mode_gr;p++){s.on_pe(e,o,i[p],u,p,0),c.mode_ext==Jg.MPG_MD_MS_LR&&ms_convert(c.l3_side,p);for(var f=0;f<c.channels_out;++f){var g=c.l3_side.tt[p][f];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=s.calc_xmin(e,a[p][f],g,n[p][f])&&(d=0),m+=i[p][f]}}for(p=0;p<c.mode_gr;p++)for(f=0;f<c.channels_out;f++)m>l&&(i[p][f]*=l,i[p][f]/=m);return d},this.calc_target_bits=function(o,a,n,r,i,l){var c,d,u,m,h=o.internal_flags,p=h.l3_side,f=0;h.bitrate_index=h.VBR_max_bitrate;var g=new MeanBits(f);for(l[0]=t.ResvFrameBegin(o,g),f=g.bits,h.bitrate_index=1,f=e.getframebits(o)-8*h.sideinfo_len,i[0]=f/(h.mode_gr*h.channels_out),f=o.VBR_mean_bitrate_kbps*o.framesize*1e3,0!=(1&h.substep_shaping)&&(f*=1.09),f/=o.out_samplerate,f-=8*h.sideinfo_len,f/=h.mode_gr*h.channels_out,c=.93+.07*(11-o.compression_ratio)/5.5,c<.9&&(c=.9),c>1&&(c=1),d=0;d<h.mode_gr;d++){var v=0;for(u=0;u<h.channels_out;u++){if(r[d][u]=int(c*f),a[d][u]>700){var _=int((a[d][u]-700)/1.4),b=p.tt[d][u];r[d][u]=int(c*f),b.block_type==Jg.SHORT_TYPE&&_<f/2&&(_=f/2),_>3*f/2?_=3*f/2:_<0&&(_=0),r[d][u]+=_}r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),v+=r[d][u]}if(v>LameInternalFlags.MAX_BITS_PER_GRANULE)for(u=0;u<h.channels_out;++u)r[d][u]*=LameInternalFlags.MAX_BITS_PER_GRANULE,r[d][u]/=v}if(h.mode_ext==Jg.MPG_MD_MS_LR)for(d=0;d<h.mode_gr;d++)s.reduce_side(r[d],n[d],f*h.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(m=0,d=0;d<h.mode_gr;d++)for(u=0;u<h.channels_out;u++)r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),m+=r[d][u];if(m>l[0])for(d=0;d<h.mode_gr;d++)for(u=0;u<h.channels_out;u++)r[d][u]*=l[0],r[d][u]/=m}}var N_=jg.assert;function H_(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,s){var o,a=t.internal_flags,n=a.l3_side,r=e.getframebits(t);s.bits=(r-8*a.sideinfo_len)/a.mode_gr;var i=2048*a.mode_gr-8;t.brate>320?o=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(o=11520,t.strict_ISO&&(o=8*int(32e4/(t.out_samplerate/1152)/8+.5))),a.ResvMax=o-r,a.ResvMax>i&&(a.ResvMax=i),(a.ResvMax<0||t.disable_reservoir)&&(a.ResvMax=0);var l=s.bits*a.mode_gr+Math.min(a.ResvSize,a.ResvMax);return l>o&&(l=o),N_(a.ResvMax%8==0),N_(a.ResvMax>=0),n.resvDrain_pre=0,null!=a.pinfo&&(a.pinfo.mean_bits=s.bits/2,a.pinfo.resvsize=a.ResvSize),l},this.ResvMaxBits=function(e,t,s,o){var a,n=e.internal_flags,r=n.ResvSize,i=n.ResvMax;0!=o&&(r+=t),0!=(1&n.substep_shaping)&&(i*=.9),s.bits=t,10*r>9*i?(a=r-9*i/10,s.bits+=a,n.substep_shaping|=128):(a=0,n.substep_shaping&=127,e.disable_reservoir||0!=(1&n.substep_shaping)||(s.bits-=.1*t));var l=r<6*n.ResvMax/10?r:6*n.ResvMax/10;return l-=a,l<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var s,o=e.l3_side;e.ResvSize+=t*e.mode_gr;var a=0;o.resvDrain_post=0,o.resvDrain_pre=0,0!=(s=e.ResvSize%8)&&(a+=s),s=e.ResvSize-a-e.ResvMax,s>0&&(a+=s);var n=Math.min(8*o.main_data_begin,a)/8;o.resvDrain_pre+=8*n,a-=8*n,e.ResvSize-=8*n,o.main_data_begin-=n,o.resvDrain_post+=a,e.ResvSize-=a}}function D_(){var e="http://www.mp3dev.org/",t=3,s=98,o=4,a=0,n=93;this.getLameVersion=function(){return t+"."+s+"."+o},this.getLameShortVersion=function(){return t+"."+s+"."+o},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+s+"r"},this.getPsyVersion=function(){return a+"."+n},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var U_=jg.System,F_=jg.VbrMode,$_=jg.ShortBlock,q_=jg.Arrays,V_=jg.new_byte,z_=jg.assert;function Y_(){var e,t,s;this.setModules=function(o,a,n){e=o,t=a,s=n};var o=1,a=2,n=4,r=8,i=Y_.NUMTOCENTRIES,l=Y_.MAXFRAMESIZE,c=i+4+4+4+4+4,d=c+9+1+1+8+1+1+3+1+1+2+4+2+2,u=128,m=64,h=32,p=null,f="Xing",g="Info",v=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function _(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var s=1;s<e.size;s+=2)e.bag[s/2]=e.bag[s];e.want*=2,e.pos/=2}}function b(e,t){if(!(e.pos<=0))for(var s=1;s<i;++s){var o,a,n=s/i,r=0|Math.floor(n*e.pos);r>e.pos-1&&(r=e.pos-1),o=e.bag[r],a=e.sum;var l=0|256*o/a;l>255&&(l=255),t[s]=255&l}}function y(e,t){var s=255&e[t+0];return s<<=8,s|=255&e[t+1],s<<=8,s|=255&e[t+2],s<<=8,s|=255&e[t+3],s}function x(e,t,s){e[t+0]=255&s>>24,e[t+1]=255&s>>16,e[t+2]=255&s>>8,e[t+3]=255&s}function w(e,t,s){e[t+0]=255&s>>8,e[t+1]=255&s}function k(e,t){return new String(e,t,f.length(),p).equals(f)||new String(e,t,g.length(),p).equals(g)}function M(e,t,s){return 255&(e<<t|s&~(-1<<t))}function S(t,s){var o=t.internal_flags;s[0]=M(s[0],8,255),s[1]=M(s[1],3,7),s[1]=M(s[1],1,t.out_samplerate<16e3?0:1),s[1]=M(s[1],1,t.version),s[1]=M(s[1],2,1),s[1]=M(s[1],1,t.error_protection?0:1),s[2]=M(s[2],4,o.bitrate_index),s[2]=M(s[2],2,o.samplerate_index),s[2]=M(s[2],1,0),s[2]=M(s[2],1,t.extension),s[3]=M(s[3],2,t.mode.ordinal()),s[3]=M(s[3],2,o.mode_ext),s[3]=M(s[3],1,t.copyright),s[3]=M(s[3],1,t.original),s[3]=M(s[3],2,t.emphasis),s[0]=255;var a,n,r=241&s[1];a=1==t.version?u:t.out_samplerate<16e3?h:m,t.VBR==F_.vbr_off&&(a=t.brate),n=t.free_format?0:255&16*e.BitrateIndex(a,t.version,t.out_samplerate),1==t.version?(s[1]=255&(10|r),r=13&s[2],s[2]=255&(n|r)):(s[1]=255&(2|r),r=13&s[2],s[2]=255&(n|r))}function R(e,t){var s=t^e;return t=t>>8^v[255&s],t}function A(e,t,o,a,n){var r,i,l,c=e.internal_flags,d=0,u=e.encoder_delay,m=e.encoder_padding,h=100-10*e.VBR_q-e.quality,p=s.getLameVeryShortVersion(),f=0,g=[1,5,3,2,4,0,3],v=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),_=0,b=0,y=0,k=e.internal_flags.noise_shaping,M=0,S=0,A=0,E=0,T=0,I=0!=(1&e.exp_nspsytune),O=0!=(2&e.exp_nspsytune),B=!1,C=!1,j=e.internal_flags.nogap_total,L=e.internal_flags.nogap_current,P=e.ATHtype,N=0;switch(e.VBR){case vbr_abr:l=e.VBR_mean_bitrate_kbps;break;case vbr_off:l=e.brate;break;default:l=e.VBR_min_bitrate_kbps}switch(r=e.VBR.ordinal()<g.length?g[e.VBR.ordinal()]:0,i=16*f+r,c.findReplayGain&&(c.RadioGain>510&&(c.RadioGain=510),c.RadioGain<-510&&(c.RadioGain=-510),b=8192,b|=3072,c.RadioGain>=0?b|=c.RadioGain:(b|=512,b|=-c.RadioGain)),c.findPeakSample&&(_=Math.abs(0|c.PeakSample/32767*Math.pow(2,23)+.5)),-1!=j&&(L>0&&(C=!0),L<j-1&&(B=!0)),N=P+((I?1:0)<<4)+((O?1:0)<<5)+((B?1:0)<<6)+((C?1:0)<<7),h<0&&(h=0),e.mode){case MONO:M=0;break;case STEREO:M=1;break;case DUAL_CHANNEL:M=2;break;case JOINT_STEREO:M=e.force_ms?4:3;break;case NOT_SET:default:M=7;break}A=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==$_.short_block_forced||e.short_blocks==$_.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==P||e.in_samplerate<=32e3)&&(S=1),E=k+(M<<2)+(S<<5)+(A<<6),T=c.nMusicCRC,x(o,a+d,h),d+=4;for(var H=0;H<9;H++)o[a+d+H]=255&p.charAt(H);d+=9,o[a+d]=255&i,d++,o[a+d]=255&v,d++,x(o,a+d,_),d+=4,w(o,a+d,b),d+=2,w(o,a+d,y),d+=2,o[a+d]=255&N,d++,o[a+d]=l>=255?255:255&l,d++,o[a+d]=255&u>>4,o[a+d+1]=255&(u<<4)+(m>>8),o[a+d+2]=255&m,d+=3,o[a+d]=255&E,d++,o[a+d++]=0,w(o,a+d,e.preset),d+=2,x(o,a+d,t),d+=4,w(o,a+d,T),d+=2;for(var D=0;D<d;D++)n=R(o[a+D],n);return w(o,a+d,n),d+=2,d}function E(e){e.seek(0);var t,s=V_(10);return e.readFully(s),t=new String(s,"ISO-8859-1").startsWith("ID3")?0:((127&s[6])<<21|(127&s[7])<<14|(127&s[8])<<7|127&s[9])+s.length,t}this.addVbrFrame=function(e){var t=e.internal_flags,s=Tables.bitrate_table[e.version][t.bitrate_index];z_(null!=t.VBR_seek_table.bag),_(t.VBR_seek_table,s)},this.getVbrTag=function(e){var t=new VBRTagData,s=0;t.flags=0;var l=e[s+1]>>3&1,c=e[s+2]>>2&3,d=e[s+3]>>6&3,u=e[s+2]>>4&15;if(u=Tables.bitrate_table[l][u],e[s+1]>>4==14?t.samprate=Tables.samplerate_table[2][c]:t.samprate=Tables.samplerate_table[l][c],s+=0!=l?3!=d?36:21:3!=d?21:13,!k(e,s))return null;s+=4,t.hId=l;var m=t.flags=y(e,s);if(s+=4,0!=(m&o)&&(t.frames=y(e,s),s+=4),0!=(m&a)&&(t.bytes=y(e,s),s+=4),0!=(m&n)){if(null!=t.toc)for(var h=0;h<i;h++)t.toc[h]=e[s+h];s+=i}t.vbrScale=-1,0!=(m&r)&&(t.vbrScale=y(e,s),s+=4),t.headersize=72e3*(l+1)*u/t.samprate,s+=21;var p=e[s+0]<<4;p+=e[s+1]>>4;var f=(15&e[s+1])<<8;return f+=255&e[s+2],(p<0||p>3e3)&&(p=-1),(f<0||f>3e3)&&(f=-1),t.encDelay=p,t.encPadding=f,t},this.InitVbrTag=function(e){var s,o=e.internal_flags;s=1==e.version?u:e.out_samplerate<16e3?h:m,e.VBR==F_.vbr_off&&(s=e.brate);var a=72e3*(e.version+1)*s/e.out_samplerate,n=o.sideinfo_len+d;if(o.VBR_seek_table.TotalFrameSize=a,a<n||a>l)e.bWriteVbrTag=!1;else{o.VBR_seek_table.nVbrNumFrames=0,o.VBR_seek_table.nBytesWritten=0,o.VBR_seek_table.sum=0,o.VBR_seek_table.seen=0,o.VBR_seek_table.want=1,o.VBR_seek_table.pos=0,null==o.VBR_seek_table.bag&&(o.VBR_seek_table.bag=new int[400],o.VBR_seek_table.size=400);var r=V_(l);S(e,r);for(var i=o.VBR_seek_table.TotalFrameSize,c=0;c<i;++c)t.add_dummy_byte(e,255&r[c],1)}},this.updateMusicCRC=function(e,t,s,o){for(var a=0;a<o;++a)e[0]=R(t[s+a],e[0])},this.getLameTagFrame=function(e,s){var l=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(l.Class_ID!=Lame.LAME_ID)return 0;if(l.VBR_seek_table.pos<=0)return 0;if(s.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;q_.fill(s,0,l.VBR_seek_table.TotalFrameSize,0),S(e,s);var c=V_(i);if(e.free_format)for(var d=1;d<i;++d)c[d]=255&255*d/100;else b(l.VBR_seek_table,c);var u=l.sideinfo_len;e.error_protection&&(u-=2),e.VBR==F_.vbr_off?(s[u++]=255&g.charAt(0),s[u++]=255&g.charAt(1),s[u++]=255&g.charAt(2),s[u++]=255&g.charAt(3)):(s[u++]=255&f.charAt(0),s[u++]=255&f.charAt(1),s[u++]=255&f.charAt(2),s[u++]=255&f.charAt(3)),x(s,u,o+a+n+r),u+=4,x(s,u,l.VBR_seek_table.nVbrNumFrames),u+=4;var m=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;x(s,u,0|m),u+=4,U_.arraycopy(c,0,s,u,c.length),u+=c.length,e.error_protection&&t.CRC_writeheader(l,s);var h=0;for(d=0;d<u;d++)h=R(s[d],h);return u+=A(e,m,s,u,h),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){var s=e.internal_flags;if(s.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var o=E(t);t.seek(o);var a=V_(l),n=getLameTagFrame(e,a);return n>a.length?-1:(n<1||t.write(a,0,n),0)}}Y_.NUMTOCENTRIES=100,Y_.MAXFRAMESIZE=2880;var X_=jg.new_byte,K_=jg.assert;function G_(){this.setModules=function(e,t){}}function Z_(){this.setModules=function(e,t,s){}}function W_(){}function Q_(){this.setModules=function(e,t){}}function J_(e,t,s){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,s=128);var o=new w_,a=new G_,n=new Dv,r=new p_,i=new M_,l=new s_,c=new P_,d=new Y_,u=new D_,m=new Q_,h=new H_,p=new i_,f=new Z_,g=new W_;o.setModules(n,r,i,l,c,d,u,m,g),r.setModules(n,g,u,d),m.setModules(r,u),i.setModules(o),c.setModules(r,h,l,p),l.setModules(p,h,o.enc.psy),h.setModules(r),p.setModules(l),d.setModules(o,r,u),a.setModules(f,g),f.setModules(u,m,i);var v=o.lame_init();v.num_channels=e,v.in_samplerate=t,v.brate=s,v.mode=zg.STEREO,v.quality=3,v.bWriteVbrTag=!1,v.disable_reservoir=!0,v.write_id3tag_automatic=!1,o.lame_init_params(v);var _=1152,b=0|1.25*_+7200,y=X_(b);this.encodeBuffer=function(t,s){1==e&&(s=t),K_(t.length==s.length),t.length>_&&(_=t.length,b=0|1.25*_+7200,y=X_(b));var a=o.lame_encode_buffer(v,t,s,t.length,y,0,b);return new Int8Array(y.subarray(0,a))},this.flush=function(){var e=o.lame_encode_flush(v,y,0,b);return new Int8Array(y.subarray(0,e))}}function eb(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}eb("RIFF"),eb("WAVE"),eb("fmt "),eb("data");class tb{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new J_(1,this.sampleRate,this.bitRate)}encode(e){const t=1152,s=this._convertBuffer(e);let o=s.length;for(let a=0;o>=0;a+=t){const e=s.subarray(a,a+t),n=this.encoder.encodeBuffer(e);this.dataBuffer.push(new Int8Array(n)),o-=t}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let s=0;s<e.length;s++){const o=Math.max(-1,Math.min(1,e[s]));t[s]=o<0?32768*o:32767*o}}_convertBuffer(e){const t=new Float32Array(e),s=new Int16Array(e.length);return this._floatTo16BitPCM(t,s),s}}class sb{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const e={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(e).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new tb(this.encoderOptions))}stop(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let s=0;this.lameEncoder&&this.lameEncoder.encode(t);for(let o=0;o<t.length;++o)s+=t[o]*t[o];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(s/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}function ob(){var e=ab(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function ab(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const nb={name:"RoomFooter",components:{SvgIcon:yi,EmojiPickerContainer:hf,RoomFiles:Rf,RoomMessageReply:Wf,RoomUsersTag:ag,RoomEmojis:cg,RoomTemplatesText:vg},directives:{clickOutside:Xd},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new ch({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=ob();let t=!0;this.getTextareaRef().addEventListener("keyup",s=>{"Enter"!==s.key||s.shiftKey||this.fileDialog||(e?(this.message=this.message+"\n",setTimeout(()=>this.onChangeInput())):!t||this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.sendMessage()),t=!s.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){ob()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{this.getTextareaRef().setSelectionRange(this.cursorRangePosition,this.cursorRangePosition),this.cursorRangePosition=null}))},onChangeInput(){var e,t,s;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(s=this.getTextareaRef())?void 0:s.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const s=null==(t=e.clipboardData)?void 0:t.items;s&&Array.from(s).forEach(e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition("/"),o=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+o+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t+e.text.length+o.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async e=>{const t=URL.createObjectURL(e),s=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,s),size:e.size,type:e.type,extension:e.name.substring(s+1),localUrl:t});const o=await fetch(t).then(e=>e.blob());let a=this.files.find(e=>e.localUrl===t);a&&(a.blob=o,a.loading=!1,delete a.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:"audio."+this.format,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}else setTimeout(()=>this.recorder.start(),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t)return;if(this.isFileLoading)return;this.selectedUsersTag.forEach(e=>{t=t.replace("@"+e.username,`<usertag>${e._id}</usertag>`)});const s=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const s=t,o="<usertag>",a="</usertag>",n=[...t.matchAll(new RegExp(o,"gi"))].map(e=>e.index);n.forEach(e=>{const n=s.substring(e+o.length,s.indexOf(a,e)),r=this.room.users.find(e=>e._id===n);t=t.replace(`${o}${n}${a}`,"@"+((null==r?void 0:r.username)||"unknown")),this.selectUserTag(r,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef())return;if(":"===e&&!this.emojisSuggestionEnabled)return;if("@"===e&&(!this.userTagsEnabled||!this.room.users))return;if("/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let s=t;while(s>0&&this.message.charAt(s-1)!==e&&(" "!==this.message.charAt(s-1)||":"!==e))s--;const o=this.message.charAt(s-2),a=!o.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(s-1)!==e||o&&" "!==o&&!a)this.resetFooterList(e);else{const o=this.message.substring(s,t);":"===e?this.updateEmojis(o):"@"===e?this.updateShowUsersTag(o):"/"===e&&this.updateShowTemplatesText(o)}},updateShowUsersTag(e){this.filteredUsersTag=gu(this.room.users,"username",e,!0).filter(e=>e._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:s,endPosition:o}=this.getCharPosition("@"),a=this.message.substr(o,o).length?"":" ";this.message=this.message.substr(0,s)+e.username+a+this.message.substr(o,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=s+e.username.length+a.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=gu(this.templatesText,"tag",e,!0)},getCharPosition(e){const t=this.getTextareaRef().selectionStart;let s=t;while(s>0&&this.message.charAt(s-1)!==e)s--;const o=this.getTextareaRef().selectionEnd;return{position:s,endPosition:o}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(e=>e.unicode)},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),!this.textareaAutoFocus&&t||setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new sb({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},rb={key:0,class:"vac-icon-textarea-left"},ib=$a("div",{class:"vac-dot-audio-record"},null,-1),lb={class:"vac-dot-audio-record-time"},cb=["placeholder"],db={class:"vac-icon-textarea"},ub={key:1},mb=["accept"];function hb(e,t,s,o,a,n){const r=Mo("room-emojis"),i=Mo("room-users-tag"),l=Mo("room-templates-text"),c=Mo("room-message-reply"),d=Mo("room-files"),u=Mo("svg-icon"),m=Mo("emoji-picker-container"),h=Ao("click-outside");return yo((Ia(),La("div",{id:"room-footer",class:it(["vac-room-footer",{"vac-app-box-shadow":n.shadowFooter}])},[qa(r,{"filtered-emojis":a.filteredEmojis,"select-item":a.selectEmojiItem,"active-up-or-down":a.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>n.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>a.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),qa(i,{"filtered-users-tag":a.filteredUsersTag,"select-item":a.selectUsersTagItem,"active-up-or-down":a.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>n.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>a.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),qa(l,{"filtered-templates-text":a.filteredTemplatesText,"select-item":a.selectTemplatesTextItem,"active-up-or-down":a.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>n.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>a.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),qa(c,{room:s.room,"message-reply":a.messageReply,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onResetMessage:n.resetMessage},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),qa(d,{files:a.files,onRemoveFile:n.removeFile,onResetMessage:n.resetMessage},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),$a("div",{class:it(["vac-box-footer",{"vac-box-footer-border":!a.files.length}])},[s.showAudio&&!a.files.length?(Ia(),La("div",rb,[a.isRecording?(Ia(),La(Ma,{key:0},[$a("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>n.stopRecorder&&n.stopRecorder(...e))},[Bo(e.$slots,"audio-stop-icon",{},()=>[qa(u,{name:"close-outline"})])]),ib,$a("div",lb,ct(n.recordedTime),1),$a("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>n.toggleRecorder(!1))},[Bo(e.$slots,"audio-check-icon",{},()=>[qa(u,{name:"checkmark"})])])],64)):(Ia(),La("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>n.toggleRecorder(!0))},[Bo(e.$slots,"microphone-icon",{},()=>[qa(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Ka("",!0),$a("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:s.textMessages.TYPE_MESSAGE,class:it(["vac-textarea",{"vac-textarea-outline":a.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>n.onChangeInput&&n.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=Qr((...e)=>n.escapeTextarea&&n.escapeTextarea(...e),["esc"])),t[11]||(t[11]=Qr(Zr((...e)=>n.selectItem&&n.selectItem(...e),["exact","prevent"]),["enter"])),t[13]||(t[13]=Qr(Zr(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=Qr((...e)=>n.selectItem&&n.selectItem(...e),["tab"])),t[15]||(t[15]=Qr(e=>n.updateActiveUpOrDown(e,-1),["up"])),t[16]||(t[16]=Qr(e=>n.updateActiveUpOrDown(e,1),["down"]))],onPaste:t[12]||(t[12]=(...e)=>n.onPasteImage&&n.onPasteImage(...e))},null,42,cb),$a("div",db,[a.editedMessage._id?(Ia(),La("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...e)=>n.resetMessage&&n.resetMessage(...e))},[Bo(e.$slots,"edit-close-icon",{},()=>[qa(u,{name:"close-outline"})])])):Ka("",!0),s.showEmojis?yo((Ia(),La("div",ub,[Bo(e.$slots,"emoji-picker",Qa({emojiOpened:a.emojiOpened},{addEmoji:n.addEmoji}),()=>[qa(m,{"emoji-opened":a.emojiOpened,"position-top":!0,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.addEmoji,onOpenEmoji:t[18]||(t[18]=e=>a.emojiOpened=e)},{"emoji-picker-icon":As(()=>[Bo(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[h,()=>a.emojiOpened=!1]]):Ka("",!0),s.showFiles?(Ia(),La("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>n.launchFilePicker&&n.launchFilePicker(...e))},[Bo(e.$slots,"paperclip-icon",{},()=>[qa(u,{name:"paperclip"})])])):Ka("",!0),s.textareaActionEnabled?(Ia(),La("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...e)=>n.textareaActionHandler&&n.textareaActionHandler(...e))},[Bo(e.$slots,"custom-action-icon",{},()=>[qa(u,{name:"deleted"})])])):Ka("",!0),s.showFiles?(Ia(),La("input",{key:4,ref:"file",type:"file",multiple:"",accept:s.acceptedFiles,style:{display:"none"},onChange:t[21]||(t[21]=e=>n.onFileChange(e.target.files))},null,40,mb)):Ka("",!0),s.showSendIcon?(Ia(),La("div",{key:5,class:it(["vac-svg-button",{"vac-send-disabled":n.isMessageEmpty}]),onClick:t[22]||(t[22]=(...e)=>n.sendMessage&&n.sendMessage(...e))},[Bo(e.$slots,"send-icon",{},()=>[qa(u,{name:"send",param:n.isMessageEmpty||n.isFileLoading?"disabled":""},null,8,["param"])])],2)):Ka("",!0)])],2)],2)),[[Jr,Object.keys(s.room).length&&s.showFooter]])}var pb=ni(nb,[["render",hb]]);const fb={name:"MessageReply",components:{AudioPlayer:Pf,SvgIcon:yi,FormatMessage:Cd},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(t=>t._id===e);return t?t.username:""},firstFile(){var e,t;return(null==(t=null==(e=this.message.replyMessage)?void 0:e.files)?void 0:t.length)?this.message.replyMessage.files[0]:{}},isAudio(){return Jd(this.firstFile)},isImage(){return Zd(this.firstFile)},isVideo(){return Wd(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},gb={class:"vac-reply-message"},vb={class:"vac-reply-username"},_b={key:0,class:"vac-image-reply-container"},bb={key:1,class:"vac-video-reply-container"},yb={controls:""},xb=["src"],wb={key:3,class:"vac-file-container"},kb={class:"vac-text-ellipsis"},Mb={key:0,class:"vac-text-ellipsis vac-text-extension"},Sb={class:"vac-reply-content"};function Rb(e,t,s,o,a,n){const r=Mo("audio-player"),i=Mo("svg-icon"),l=Mo("format-message");return Ia(),La("div",gb,[$a("div",vb,ct(n.replyUsername),1),n.isImage?(Ia(),La("div",_b,[$a("div",{class:"vac-message-image vac-message-image-reply",style:ot({"background-image":`url('${n.firstFile.url}')`})},null,4)])):n.isVideo?(Ia(),La("div",bb,[$a("video",yb,[$a("source",{src:n.firstFile.url},null,8,xb)])])):n.isAudio?(Ia(),Pa(r,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["src"])):n.isOtherFile?(Ia(),La("div",wb,[$a("div",null,[Bo(e.$slots,"file-icon",{},()=>[qa(i,{name:"file"})])]),$a("div",kb,ct(n.firstFile.name),1),n.firstFile.extension?(Ia(),La("div",Mb,ct(n.firstFile.extension),1)):Ka("",!0)])):Ka("",!0),$a("div",Sb,[qa(l,{"message-id":s.message.replyMessage._id,content:s.message.replyMessage.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var Ab=ni(fb,[["render",Rb]]);const Eb={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const e=35,t=4,s=e-2*t,o=2*s*Math.PI;return{radius:e,stroke:t,normalizedRadius:s,circumference:o}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Tb={ref:"progress",class:"vac-progress-wrapper"},Ib=["height","width"],Ob=["stroke-dasharray","stroke-width","r","cx","cy"],Bb={class:"vac-progress-text"},Cb=$a("span",{class:"vac-progress-pourcent"},"%",-1);function jb(e,t,s,o,a,n){return Ia(),Pa(kr,{name:"vac-fade-spinner",appear:""},{default:As(()=>[$a("div",Tb,[(Ia(),La("svg",{height:2*a.radius,width:2*a.radius},[$a("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":a.circumference+" "+a.circumference,style:ot({strokeDashoffset:n.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":a.stroke,fill:"transparent",r:a.normalizedRadius,cx:a.radius,cy:a.radius},null,12,Ob)],8,Ib)),$a("div",{class:"vac-progress-content",style:ot({height:2*a.radius-19+"px",width:2*a.radius-19+"px"})},[$a("div",Bb,[Xa(ct(s.progress),1),Cb])],4)],512)]),_:1})}var Lb=ni(Eb,[["render",jb]]);const Pb={name:"MessageFile",components:{SvgIcon:yi,Loader:pi,ProgressBar:Lb},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!Zd(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},Nb={class:"vac-message-file-container"},Hb={key:0,class:"vac-image-buttons"},Db={controls:""},Ub=["src"];function Fb(e,t,s,o,a,n){const r=Mo("progress-bar"),i=Mo("loader"),l=Mo("svg-icon");return Ia(),La("div",Nb,[n.isImage?(Ia(),La("div",{key:0,ref:"imageRef"+s.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>a.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>a.imageHover=!1),onClick:t[4]||(t[4]=e=>n.openFile(e,"preview"))},[s.file.progress>=0?(Ia(),Pa(r,{key:0,progress:s.file.progress,style:ot({top:a.imageResponsive.loaderTop+"px"})},null,8,["progress","style"])):(Ia(),Pa(i,{key:1,show:n.isImageLoading,type:"message-file","message-id":s.message._id,style:ot({top:a.imageResponsive.loaderTop+"px"})},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["show","message-id","style"])),$a("div",{class:it(["vac-message-image",{"vac-blur-loading":n.isImageLoading&&s.message.senderId===s.currentUserId}]),style:ot({"background-image":`url('${n.isImageLoading&&s.file.preview||s.file.url}')`,"max-height":a.imageResponsive.maxHeight+"px"})},[qa(kr,{name:"vac-fade-image"},{default:As(()=>[s.messageSelectionEnabled||!a.imageHover||n.isImageLoading?Ka("",!0):(Ia(),La("div",Hb,[$a("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>n.openFile(e,"preview"))},[Bo(e.$slots,"eye-icon_"+s.message._id,{},()=>[qa(l,{name:"eye"})])]),$a("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>n.openFile(e,"download"))},[Bo(e.$slots,"document-icon_"+s.message._id,{},()=>[qa(l,{name:"document"})])])]))]),_:3})],6)],544)):n.isVideo?(Ia(),La("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Zr(e=>n.openFile(e,"preview"),["prevent"]))},[s.file.progress>=0?(Ia(),Pa(r,{key:0,progress:s.file.progress},null,8,["progress"])):Ka("",!0),$a("video",Db,[$a("source",{src:s.file.url},null,8,Ub)])])):Ka("",!0)])}var $b=ni(Pb,[["render",Fb]]);const qb={name:"MessageFiles",components:{SvgIcon:yi,FormatMessage:Cd,ProgressBar:Lb,MessageFile:$b},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>Qd(e))},otherFiles(){return this.message.files.filter(e=>!Qd(e))}},methods:{openFile(e,t,s){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:s}))}}},Vb={class:"vac-message-files-container"},zb=["onClick"],Yb={class:"vac-svg-button"},Xb={class:"vac-text-ellipsis"},Kb={key:0,class:"vac-text-ellipsis vac-text-extension"};function Gb(e,t,s,o,a,n){const r=Mo("message-file"),i=Mo("progress-bar"),l=Mo("svg-icon"),c=Mo("format-message");return Ia(),La("div",Vb,[(Ia(!0),La(Ma,null,Io(n.imageVideoFiles,(o,a)=>(Ia(),La("div",{key:a+"iv"},[qa(r,{file:o,"current-user-id":s.currentUserId,message:s.message,index:a,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Ia(!0),La(Ma,null,Io(n.otherFiles,(t,s)=>(Ia(),La("div",{key:s+"a",class:"vac-file-wrapper"},[t.progress>=0?(Ia(),Pa(i,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):Ka("",!0),$a("div",{class:it(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>n.openFile(e,t,"download")},[$a("div",Yb,[Bo(e.$slots,"document-icon",{},()=>[qa(l,{name:"document"})])]),$a("div",Xb,ct(t.name),1),t.extension?(Ia(),La("div",Kb,ct(t.extension),1)):Ka("",!0)],10,zb)]))),128)),qa(c,{"message-id":s.message._id,content:s.message.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}var Zb=ni(qb,[["render",Gb]]);const Wb={name:"MessageActions",components:{SvgIcon:yi,EmojiPickerContainer:hf},directives:{clickOutside:Xd},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=cf(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,s=this.$refs.actionIcon.getBoundingClientRect().top,o=e.getBoundingClientRect().top,a=o-s>t+50;this.menuOptionsTop=a?30:-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},Qb={class:"vac-message-actions-wrapper"},Jb={key:"3"},ey={class:"vac-menu-list"},ty=["onClick"];function sy(e,t,s,o,a,n){const r=Mo("svg-icon"),i=Mo("emoji-picker-container"),l=Ao("click-outside");return Ia(),La("div",Qb,[$a("div",{class:"vac-options-container",style:ot({display:s.hoverAudioProgress?"none":"initial",width:n.filteredMessageActions.length&&s.showReactionEmojis?"70px":"45px"})},[qa(qr,{name:"vac-slide-left",tag:"span"},{default:As(()=>[n.isMessageActions||n.isMessageReactions?(Ia(),La("div",{key:"1",class:it(["vac-blur-container",{"vac-options-me":s.message.senderId===s.currentUserId}])},null,2)):Ka("",!0),n.isMessageActions?(Ia(),La("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>n.openOptions&&n.openOptions(...e))},[Bo(e.$slots,"dropdown-icon_"+s.message._id,{},()=>[qa(r,{name:"dropdown",param:"message"})])],512)):Ka("",!0),n.isMessageReactions?yo((Ia(),La("div",Jb,[Bo(e.$slots,"emoji-picker",Qa({emojiOpened:a.emojiOpened},{addEmoji:n.sendMessageReaction}),()=>[qa(i,{class:"vac-message-emojis",style:ot({right:n.isMessageActions?"30px":"5px"}),"emoji-opened":a.emojiOpened,"emoji-reaction":!0,"position-right":s.message.senderId===s.currentUserId,"message-id":s.message._id,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.sendMessageReaction,onOpenEmoji:n.openEmoji},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[l,n.closeEmoji]]):Ka("",!0)]),_:3})],4),n.filteredMessageActions.length?(Ia(),Pa(kr,{key:0,name:s.message.senderId===s.currentUserId?"vac-slide-left":"vac-slide-right"},{default:As(()=>[a.optionsOpened?yo((Ia(),La("div",{key:0,ref:"menuOptions",class:it(["vac-menu-options",{"vac-menu-left":s.message.senderId!==s.currentUserId}]),style:ot({top:a.menuOptionsTop+"px"})},[$a("div",ey,[(Ia(!0),La(Ma,null,Io(n.filteredMessageActions,e=>(Ia(),La("div",{key:e.name},[$a("div",{class:"vac-menu-item",onClick:t=>n.messageActionHandler(e)},ct(e.title),9,ty)]))),128))])],6)),[[l,n.closeOptions]]):Ka("",!0)]),_:1},8,["name"])):Ka("",!0)])}var oy=ni(Wb,[["render",sy]]);const ay={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},ny=["onClick"];function ry(e,t,s,o,a,n){return s.message.deleted?Ka("",!0):(Ia(),Pa(qr,{key:0,name:"vac-slide-left",tag:"span"},{default:As(()=>[(Ia(!0),La(Ma,null,Io(s.message.reactions,(e,t)=>yo((Ia(),La("button",{key:t+0,class:it(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(s.currentUserId)}]),style:ot({float:s.message.senderId===s.currentUserId?"right":"left"}),onClick:s=>n.sendMessageReaction({unicode:t},e)},[Xa(ct(t),1),$a("span",null,ct(e.length),1)],14,ny)),[[Jr,e.length]])),128))]),_:1}))}var iy=ni(ay,[["render",ry]]);function ly(e){const t=[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}],s=(e,t)=>t.every(t=>{let s=!1;return("array"===t.type[0]&&Array.isArray(e[t.key])||t.type.find(s=>s===typeof e[t.key]))&&(s=!0),s&&uy(e,t.key)});if(!s(e,t))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function cy(e){const t=[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}],s=(e,t)=>t.every(t=>{const s=t.type.find(s=>s===typeof e[t.key]);return s&&uy(e,t.key)});if(!s(e,t))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function dy(e){const t=[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}],s=(e,t)=>t.every(t=>{const s=t.type.find(s=>s===typeof e[t.key]);return s&&uy(e,t.key)});if(!s(e,t))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function uy(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const my={name:"RoomMessage",components:{SvgIcon:yi,FormatMessage:Cd,AudioPlayer:Pf,MessageReply:Ab,MessageFiles:Zb,MessageActions:oy,MessageReactions:iy},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some(e=>Jd(e))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce((e,t)=>t.index<e.index?t:e):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){dy(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(this.optionsOpened||this.emojiOpened||(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},hy=["id"],py={key:0,class:"vac-card-info vac-card-date"},fy={key:1,class:"vac-line-new"},gy={key:2,class:"vac-card-info vac-card-system"},vy={key:1,class:"vac-avatar-offset"},_y={key:0,class:"vac-progress-time"},by={class:"vac-text-timestamp"},yy={key:0,class:"vac-icon-edited"},xy={key:1},wy=$a("div",{class:"vac-failure-text"},"!",-1),ky=[wy],My={key:3,class:"vac-avatar-current-offset"};function Sy(e,t,s,o,a,n){const r=Mo("format-message"),i=Mo("message-reply"),l=Mo("message-files"),c=Mo("audio-player"),d=Mo("svg-icon"),u=Mo("message-actions"),m=Mo("message-reactions");return Ia(),La("div",{id:s.message._id,ref:"message",class:"vac-message-wrapper"},[n.showDate?(Ia(),La("div",py,ct(s.message.date),1)):Ka("",!0),a.newMessage._id===s.message._id?(Ia(),La("div",fy,ct(s.textMessages.NEW_MESSAGES),1)):Ka("",!0),s.message.system?(Ia(),La("div",gy,[Bo(e.$slots,"message_"+s.message._id,{},()=>[qa(r,{"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-messages":s.textMessages,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Ia(),La("div",{key:3,class:it(["vac-message-box",{"vac-offset-current":s.message.senderId===s.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>n.selectMessage&&n.selectMessage(...e))},[Bo(e.$slots,"message_"+s.message._id,{},()=>[s.message.senderId!==s.currentUserId?Bo(e.$slots,"message-avatar_"+s.message._id,{key:0},()=>[s.message.avatar?(Ia(),La("div",{key:0,class:"vac-avatar",style:ot({"background-image":`url('${s.message.avatar}')`})},null,4)):Ka("",!0)]):Ka("",!0),n.hasSenderUserAvatar&&!s.message.avatar?(Ia(),La("div",vy)):Ka("",!0),$a("div",{class:it(["vac-message-container",{"vac-message-container-offset":n.messageOffset}])},[$a("div",{class:it(["vac-message-card",{"vac-message-highlight":n.isMessageHover,"vac-message-current":s.message.senderId===s.currentUserId,"vac-message-deleted":s.message.deleted,"vac-item-clickable":s.messageSelectionEnabled,"vac-message-selected":n.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>n.onHoverMessage&&n.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>n.onLeaveMessage&&n.onLeaveMessage(...e))},[n.showUsername?(Ia(),La("div",{key:0,class:it(["vac-text-username",{"vac-username-reply":!s.message.deleted&&s.message.replyMessage}])},[$a("span",null,ct(s.message.username),1)],2)):Ka("",!0),!s.message.deleted&&s.message.replyMessage?(Ia(),Pa(i,{key:1,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Ka("",!0),!s.message.deleted&&s.message.files&&s.message.files.length?!n.isAudio||s.message.files.length>1?(Ia(),Pa(l,{key:3,"current-user-id":s.currentUserId,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Ia(),La(Ma,{key:4},[qa(c,{"message-id":s.message._id,src:s.message.files[0].url,"message-selection-enabled":s.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>a.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>a.hoverAudioProgress=e)},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["message-id","src","message-selection-enabled"]),s.message.deleted?Ka("",!0):(Ia(),La("div",_y,ct(a.progressTime),1))],64)):(Ia(),Pa(r,{key:2,"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-formatting":s.textFormatting,"text-messages":s.textMessages,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),$a("div",by,[s.message.edited&&!s.message.deleted?(Ia(),La("div",yy,[Bo(e.$slots,"pencil-icon_"+s.message._id,{},()=>[qa(d,{name:"pencil"})])])):Ka("",!0),$a("span",null,ct(s.message.timestamp),1),n.isCheckmarkVisible?(Ia(),La("span",xy,[Bo(e.$slots,"checkmark-icon_"+s.message._id,{},()=>[qa(d,{name:s.message.distributed?"double-checkmark":"checkmark",param:s.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ka("",!0)]),qa(u,{"current-user-id":s.currentUserId,message:s.message,"message-actions":s.messageActions,"show-reaction-emojis":s.showReactionEmojis,"message-hover":a.messageHover,"hover-message-id":a.hoverMessageId,"hover-audio-progress":a.hoverAudioProgress,"emoji-data-source":s.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=e=>a.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>a.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>a.emojiOpened=e),onMessageActionHandler:n.messageActionHandler,onSendMessageReaction:n.sendMessageReaction},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),qa(m,{"current-user-id":s.currentUserId,message:s.message,onSendMessageReaction:n.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Bo(e.$slots,"message-failure_"+s.message._id,{},()=>[s.message.failure&&s.message.senderId===s.currentUserId?(Ia(),La("div",{key:0,class:it(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":s.message.avatar&&s.message.senderId===s.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:s.message}))},ky,2)):Ka("",!0)]),s.message.senderId===s.currentUserId?Bo(e.$slots,"message-avatar_"+s.message._id,{key:2},()=>[s.message.avatar?(Ia(),La("div",{key:0,class:"vac-avatar vac-avatar-current",style:ot({"background-image":`url('${s.message.avatar}')`})},null,4)):Ka("",!0)]):Ka("",!0),n.hasCurrentUserAvatar&&!s.message.avatar?(Ia(),La("div",My)):Ka("",!0)])],2))],8,hy)}var Ry=ni(my,[["render",Sy]]);const Ay={name:"ChatRoom",components:{Loader:pi,SvgIcon:yi,RoomHeader:Uu,RoomFooter:pb,RoomMessage:Ry},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((e,t)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:t})}),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,s=new ResizeObserver(o=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),s.disconnect())});for(var o=0;o<e.children.length;o++)s.observe(e.children[o])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;addEventListener("touchend",e=>this.touchEnd(e,t,s),{once:!0})}},touchEnd(e,t,s){if(1===e.changedTouches.length){const o=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,n=o-t>100,r=Math.abs(a-s)>50;n&&!r&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const s=this.$refs.scrollContainer;s&&(e(),setTimeout(()=>{s.scrollTo({top:s.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:s}){if(t!==this.messages.length-1)return;const o=s.offsetHeight+60;setTimeout(()=>{const t=this.getBottomScroll(this.$refs.scrollContainer)>o;e.senderId===this.currentUserId?t?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():t?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return this.initReplyMessage=t,void setTimeout(()=>{this.initReplyMessage=null});case"editMessage":return this.initEditMessage=t,void setTimeout(()=>{this.initEditMessage=null});case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:s,scrollTop:o}=e;return t-s-o},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth"))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},Ey={class:"vac-container-center vac-room-empty"},Ty={class:"vac-messages-container"},Iy={key:0,class:"vac-text-started"},Oy={key:1,class:"vac-text-started"},By={key:0,id:"infinite-loader-messages"},Cy={key:2},jy={key:0,class:"vac-badge-counter vac-messages-count"};function Ly(e,t,s,o,a,n){const r=Mo("room-header"),i=Mo("loader"),l=Mo("room-message"),c=Mo("svg-icon"),d=Mo("room-footer");return yo((Ia(),La("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Zr((...e)=>n.onDropFiles&&n.onDropFiles(...e),["prevent"])),onDragenter:t[13]||(t[13]=Zr(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Zr(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Zr(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...e)=>n.touchStart&&n.touchStart(...e))},[n.showNoRoom?Bo(e.$slots,"no-room-selected",{key:0},()=>[$a("div",Ey,[$a("div",null,ct(s.textMessages.ROOM_EMPTY),1)])]):(Ia(),Pa(r,{key:1,"current-user-id":s.currentUserId,"text-messages":s.textMessages,"single-room":s.singleRoom,"show-rooms-list":s.showRoomsList,"is-mobile":s.isMobile,"room-info-enabled":s.roomInfoEnabled,"menu-actions":s.menuActions,room:n.room,"message-selection-enabled":a.messageSelectionEnabled,"message-selection-actions":s.messageSelectionActions,"selected-messages-total":a.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:n.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>a.messageSelectionEnabled=!1)},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),$a("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>n.onContainerScroll&&n.onContainerScroll(...e))},[qa(i,{show:a.loadingMessages,type:"messages"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["show"]),$a("div",Ty,[$a("div",{class:it({"vac-messages-hidden":a.loadingMessages})},[qa(kr,{name:"vac-fade-message"},{default:As(()=>[$a("div",null,[n.showNoMessages?(Ia(),La("div",Iy,[Bo(e.$slots,"messages-empty",{},()=>[Xa(ct(s.textMessages.MESSAGES_EMPTY),1)])])):Ka("",!0),n.showMessagesStarted?(Ia(),La("div",Oy,ct(s.textMessages.CONVERSATION_STARTED)+" "+ct(s.messages[0].date),1)):Ka("",!0)])]),_:3}),s.messages.length&&!s.messagesLoaded?(Ia(),La("div",By,[qa(i,{show:!0,infinite:!0,type:"infinite-messages"},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1024)])):Ka("",!0),(Ia(),Pa(qr,{key:s.roomId,name:"vac-fade-message",tag:"span"},{default:As(()=>[(Ia(!0),La(Ma,null,Io(s.messages,(o,r)=>(Ia(),La("div",{key:o.indexId||o._id},[qa(l,{"current-user-id":s.currentUserId,message:o,index:r,messages:s.messages,"edited-message-id":a.editedMessageId,"message-actions":s.messageActions,"room-users":n.room.users,"text-messages":s.textMessages,"new-messages":a.newMessages,"show-reaction-emojis":s.showReactionEmojis,"show-new-messages-divider":s.showNewMessagesDivider,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"username-options":s.usernameOptions,"message-selection-enabled":a.messageSelectionEnabled,"selected-messages":a.selectedMessages,"emoji-data-source":s.emojiDataSource,onMessageAdded:n.onMessageAdded,onMessageActionHandler:n.messageActionHandler,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:n.sendMessageReaction,onSelectMessage:n.selectMessage,onUnselectMessage:n.unselectMessage},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),a.loadingMessages?Ka("",!0):(Ia(),La("div",Cy,[qa(kr,{name:"vac-bounce"},{default:As(()=>[a.scrollIcon?(Ia(),La("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>n.scrollToBottom&&n.scrollToBottom(...e))},[qa(kr,{name:"vac-bounce"},{default:As(()=>[a.scrollMessagesCount?(Ia(),La("div",jy,ct(a.scrollMessagesCount),1)):Ka("",!0)]),_:1}),Bo(e.$slots,"scroll-icon",{},()=>[qa(c,{name:"dropdown",param:"scroll"})])])):Ka("",!0)]),_:3})])),qa(d,{room:n.room,"room-id":s.roomId,"room-message":s.roomMessage,"text-messages":s.textMessages,"show-send-icon":s.showSendIcon,"show-files":s.showFiles,"show-audio":s.showAudio,"show-emojis":s.showEmojis,"show-footer":s.showFooter,"accepted-files":s.acceptedFiles,"textarea-action-enabled":s.textareaActionEnabled,"textarea-auto-focus":s.textareaAutoFocus,"user-tags-enabled":s.userTagsEnabled,"emojis-suggestion-enabled":s.emojisSuggestionEnabled,"templates-text":s.templatesText,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"init-reply-message":a.initReplyMessage,"init-edit-message":a.initEditMessage,"dropped-files":a.droppedFiles,"emoji-data-source":s.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=e=>a.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onTypingMessage:t[10]||(t[10]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[11]||(t[11]=t=>e.$emit("textarea-action-handler",t))},Oo({_:2},[Io(e.$slots,(t,s)=>({name:s,fn:As(t=>[Bo(e.$slots,s,lt(za(t)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Jr,s.isMobile&&!s.showRoomsList||!s.isMobile||s.singleRoom]])}var Py=ni(Ay,[["render",Ly]]);const Ny={name:"MediaPreview",components:{SvgIcon:yi},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},Hy={key:0,class:"vac-media-preview-container"},Dy={key:1,class:"vac-media-preview-container"},Uy={controls:"",autoplay:""},Fy=["src"],$y={class:"vac-svg-button"};function qy(e,t,s,o,a,n){const r=Mo("svg-icon");return Ia(),La("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Zr((...e)=>n.closeModal&&n.closeModal(...e),["stop"])),onKeydown:t[1]||(t[1]=Qr((...e)=>n.closeModal&&n.closeModal(...e),["esc"]))},[qa(kr,{name:"vac-bounce-preview",appear:""},{default:As(()=>[n.isImage?(Ia(),La("div",Hy,[$a("div",{class:"vac-image-preview",style:ot({"background-image":`url('${s.file.url}')`})},null,4)])):n.isVideo?(Ia(),La("div",Dy,[$a("video",Uy,[$a("source",{src:s.file.url},null,8,Fy)])])):Ka("",!0)]),_:1}),$a("div",$y,[Bo(e.$slots,"preview-close-icon",{},()=>[qa(r,{name:"close-outline",param:"preview"})])])],544)}var Vy=ni(Ny,[["render",qy]]),zy={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Yy={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},Xy=({general:e,container:t,header:s,footer:o,sidemenu:a,content:n,dropdown:r,message:i,markdown:l,room:c,emoji:d,icons:u})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":s.background,"--chat-header-color-name":s.colorRoomName,"--chat-header-color-info":s.colorRoomInfo,"--chat-footer-bg-color":o.background,"--chat-border-style-input":o.borderStyleInput,"--chat-border-color-input-selected":o.borderInputSelected,"--chat-footer-bg-color-reply":o.backgroundReply,"--chat-footer-bg-color-tag-active":o.backgroundTagActive,"--chat-footer-bg-color-tag":o.backgroundTag,"--chat-content-bg-color":n.background,"--chat-sidemenu-bg-color":a.background,"--chat-sidemenu-bg-color-hover":a.backgroundHover,"--chat-sidemenu-bg-color-active":a.backgroundActive,"--chat-sidemenu-color-active":a.colorActive,"--chat-sidemenu-border-color-search":a.borderColorSearch,"--chat-dropdown-bg-color":r.background,"--chat-dropdown-bg-color-hover":r.backgroundHover,"--chat-message-bg-color":i.background,"--chat-message-bg-color-me":i.backgroundMe,"--chat-message-color-started":i.colorStarted,"--chat-message-bg-color-deleted":i.backgroundDeleted,"--chat-message-bg-color-selected":i.backgroundSelected,"--chat-message-color-deleted":i.colorDeleted,"--chat-message-color-username":i.colorUsername,"--chat-message-color-timestamp":i.colorTimestamp,"--chat-message-bg-color-date":i.backgroundDate,"--chat-message-color-date":i.colorDate,"--chat-message-bg-color-system":i.backgroundSystem,"--chat-message-color-system":i.colorSystem,"--chat-message-color":i.color,"--chat-message-bg-color-media":i.backgroundMedia,"--chat-message-bg-color-reply":i.backgroundReply,"--chat-message-color-reply-username":i.colorReplyUsername,"--chat-message-color-reply-content":i.colorReply,"--chat-message-color-tag":i.colorTag,"--chat-message-bg-color-image":i.backgroundImage,"--chat-message-color-new-messages":i.colorNewMessages,"--chat-message-bg-color-scroll-counter":i.backgroundScrollCounter,"--chat-message-color-scroll-counter":i.colorScrollCounter,"--chat-message-bg-color-reaction":i.backgroundReaction,"--chat-message-border-style-reaction":i.borderStyleReaction,"--chat-message-bg-color-reaction-hover":i.backgroundReactionHover,"--chat-message-border-style-reaction-hover":i.borderStyleReactionHover,"--chat-message-color-reaction-counter":i.colorReactionCounter,"--chat-message-bg-color-reaction-me":i.backgroundReactionMe,"--chat-message-border-style-reaction-me":i.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":i.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":i.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":i.colorReactionCounterMe,"--chat-message-bg-color-audio-record":i.backgroundAudioRecord,"--chat-message-bg-color-audio-line":i.backgroundAudioLine,"--chat-message-bg-color-audio-progress":i.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":i.backgroundAudioProgressSelector,"--chat-message-color-file-extension":i.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm});var Ky='.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n';const Gy={name:"ChatContainer",components:{RoomsList:Mu,Room:Py,MediaPreview:Vy},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"°",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...zy,...this.textMessagesCasted}},cssVars(){const e=Yy[this.theme],t={};return Object.keys(e).map(s=>{t[s]={...e[s],...this.stylesCasted[s]||{}}}),Xy(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const s=e.index||0,o=t.index||0;return"asc"===this.roomsOrder?s<o?-1:o<s?1:0:s>o?-1:o>s?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if(e[0]&&e.find(e=>e.roomId===this.room.roomId)||(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find(e=>e.roomId===this.roomId)||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find(t=>t.roomId===e);this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){e&&0!==Object.entries(e).length&&(ly(e),e.users.forEach(e=>{cy(e)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return"true"===e||!0===e},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?"object"===typeof e?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},Zy={class:"vac-chat-container"};function Wy(e,t,s,o,a,n){const r=Mo("rooms-list"),i=Mo("room"),l=Mo("media-preview");return Ia(),La("div",{class:"vac-card-window",style:ot([{height:s.height},n.cssVars])},[$a("div",Zy,[n.singleRoomCasted?Ka("",!0):(Ia(),Pa(r,{key:0,"current-user-id":s.currentUserId,rooms:n.orderedRooms,"loading-rooms":n.loadingRoomsCasted,"rooms-loaded":n.roomsLoadedCasted,room:a.room,"room-actions":n.roomActionsCasted,"custom-search-room-enabled":s.customSearchRoomEnabled,"text-messages":n.t,"show-search":n.showSearchCasted,"show-add-room":n.showAddRoomCasted,"show-rooms-list":a.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":a.isMobile,"scroll-distance":s.scrollDistance,onFetchRoom:n.fetchRoom,onFetchMoreRooms:n.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>a.loadingMoreRooms=e),onAddRoom:n.addRoom,onSearchRoom:n.searchRoom,onRoomActionHandler:n.roomActionHandler},Oo({_:2},[Io(a.slots,t=>({name:t.slot,fn:As(s=>[Bo(e.$slots,t.slot,lt(za(s)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),qa(i,{"current-user-id":s.currentUserId,rooms:n.roomsCasted,"room-id":a.room.roomId||"","load-first-room":n.loadFirstRoomCasted,messages:n.messagesCasted,"room-message":s.roomMessage,"messages-loaded":n.messagesLoadedCasted,"menu-actions":n.menuActionsCasted,"message-actions":n.messageActionsCasted,"message-selection-actions":n.messageSelectionActionsCasted,"auto-scroll":n.autoScrollCasted,"show-send-icon":n.showSendIconCasted,"show-files":n.showFilesCasted,"show-audio":n.showAudioCasted,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"show-emojis":n.showEmojisCasted,"show-reaction-emojis":n.showReactionEmojisCasted,"show-new-messages-divider":n.showNewMessagesDividerCasted,"show-footer":n.showFooterCasted,"text-messages":n.t,"single-room":n.singleRoomCasted,"show-rooms-list":a.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":a.isMobile,"loading-rooms":n.loadingRoomsCasted,"room-info-enabled":n.roomInfoEnabledCasted,"textarea-action-enabled":n.textareaActionEnabledCasted,"textarea-auto-focus":n.textareaAutoFocusCasted,"user-tags-enabled":n.userTagsEnabledCasted,"emojis-suggestion-enabled":n.emojisSuggestionEnabledCasted,"scroll-distance":s.scrollDistance,"accepted-files":s.acceptedFiles,"templates-text":n.templatesTextCasted,"username-options":n.usernameOptionsCasted,"emoji-data-source":s.emojiDataSource,onToggleRoomsList:n.toggleRoomsList,onRoomInfo:n.roomInfo,onFetchMessages:n.fetchMessages,onSendMessage:n.sendMessage,onEditMessage:n.editMessage,onDeleteMessage:n.deleteMessage,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:n.openFailedMessage,onMenuActionHandler:n.menuActionHandler,onMessageActionHandler:n.messageActionHandler,onMessageSelectionActionHandler:n.messageSelectionActionHandler,onSendMessageReaction:n.sendMessageReaction,onTypingMessage:n.typingMessage,onTextareaActionHandler:n.textareaActionHandler},Oo({_:2},[Io(a.slots,t=>({name:t.slot,fn:As(s=>[Bo(e.$slots,t.slot,lt(za(s)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),qa(kr,{name:"vac-fade-preview",appear:""},{default:As(()=>[a.showMediaPreview?(Ia(),Pa(l,{key:0,file:a.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>a.showMediaPreview=!1)},Oo({_:2},[Io(a.slots,t=>({name:t.slot,fn:As(s=>[Bo(e.$slots,t.slot,lt(za(s)))])}))]),1032,["file"])):Ka("",!0)]),_:3})],4)}var Qy=ni(Gy,[["render",Wy],["styles",[Ky]]]);const Jy=_r(Qy),ex="vue-advanced-chat";function tx(){customElements.get(ex)||customElements.define(ex,Jy)}}).call(this,s("c8ba"))},"293a":function(e,t,s){"use strict";s.r(t);var o=s("7a23");const a={class:"chat"};function n(e,t,s,n,r,i){const l=Object(o["resolveComponent"])("chat-container");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[r.showChat?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:0,"current-user-id":i.currentUserId,theme:r.theme,"is-device":r.isDevice,chatIdOverride:s.chatIdOverride},null,8,["current-user-id","theme","is-device","chatIdOverride"])):Object(o["createCommentVNode"])("",!0)])}var r=s("edfc"),i=s("3e8a"),l=s("6a92");const c="files",d=(e,t,s)=>Object(l["d"])(i["e"],`${c}/${e}/${t}/${s}`),u=(e,t,s)=>Object(l["a"])(d(e,t,`${s.name}.${s.extension||s.type}`)),m=e=>Object(l["b"])(e),h=(e,t,s,o)=>{const a=d(e,t,`${s.name}.${o}`);return Object(l["e"])(a,s.blob,{contentType:o})},p=(e,t,s,o,a,n,r)=>{const i=h(e,t,s,o);i.on("state_changed",e=>{const t=Math.round(e.bytesTransferred/e.totalBytes*100);a(t)},e=>{n(e)},async()=>{const e=await m(i.snapshot.ref);r(e)})};function f(e,t,s,a,n,r){const i=Object(o["resolveComponent"])("vue-advanced-chat");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["window-container",{"window-mobile":s.isDevice}])},[Object(o["createVNode"])(i,{ref:"chatWindow",height:r.screenHeight,theme:s.theme,styles:JSON.stringify(n.styles),"current-user-id":s.currentUserId,"room-id":n.roomId,rooms:JSON.stringify(r.loadedRooms),"loading-rooms":n.loadingRooms,"rooms-loaded":n.roomsLoaded,messages:JSON.stringify(n.messages),"messages-loaded":n.messagesLoaded,"room-message":n.roomMessage,"room-actions":JSON.stringify(n.roomActions),"menu-actions":JSON.stringify(n.menuActions),"message-selection-actions":JSON.stringify(n.messageSelectionActions),"templates-text":JSON.stringify(n.templatesText),"show-add-room":!1,onFetchMoreRooms:r.fetchMoreRooms,onFetchMessages:t[0]||(t[0]=e=>r.fetchMessages(e.detail[0])),onSendMessage:t[1]||(t[1]=e=>r.sendMessage(e.detail[0])),onEditMessage:t[2]||(t[2]=e=>r.editMessage(e.detail[0])),onDeleteMessage:t[3]||(t[3]=e=>r.deleteMessage(e.detail[0])),onOpenFile:t[4]||(t[4]=e=>r.openFile(e.detail[0])),onOpenUserTag:t[5]||(t[5]=e=>r.openUserTag(e.detail[0])),onAddRoom:t[6]||(t[6]=e=>r.addRoom(e.detail[0])),onRoomActionHandler:t[7]||(t[7]=e=>r.menuActionHandler(e.detail[0])),onMenuActionHandler:t[8]||(t[8]=e=>r.menuActionHandler(e.detail[0])),onMessageSelectionActionHandler:t[9]||(t[9]=e=>r.messageSelectionActionHandler(e.detail[0])),onSendMessageReaction:t[10]||(t[10]=e=>r.sendMessageReaction(e.detail[0])),onTypingMessage:t[11]||(t[11]=e=>r.typingMessage(e.detail[0])),onToggleRoomsList:t[12]||(t[12]=t=>e.$emit("show-demo-options",t.detail[0].opened))},null,8,["height","theme","styles","current-user-id","room-id","rooms","loading-rooms","rooms-loaded","messages","messages-loaded","room-message","room-actions","menu-actions","message-selection-actions","templates-text","onFetchMoreRooms"])],2)}s("b7ef"),s("14d9"),s("3c65");var g=s("7c01");const v=g["c"],_=e=>Object(g["d"])(i["c"],"/status/"+e),b=e=>{const t={state:"offline",lastChanged:Object(g["e"])()},s={state:"online",lastChanged:Object(g["e"])()},o=Object(g["d"])(i["c"],".info/connected");Object(g["c"])(o,o=>{!0===o.val()&&Object(g["b"])(_(e)).set(t).then(()=>{Object(g["f"])(_(e),s)})})},y=(e,t)=>String(e).padStart(t,"0"),x=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),w=(e,t="")=>{if(!e)return;const s=e.seconds?new Date(1e3*e.seconds):e;if("HH:mm"===t)return`${y(s.getHours(),2)}:${y(s.getMinutes(),2)}`;if("DD MMMM YYYY"===t){const e={month:"long",year:"numeric",day:"numeric"};return""+new Intl.DateTimeFormat("en-GB",e).format(s)}if("DD/MM/YY"===t){const e={month:"numeric",year:"numeric",day:"numeric"};return""+new Intl.DateTimeFormat("en-GB",e).format(s)}if("DD MMMM, HH:mm"===t){const e={month:"long",day:"numeric"};return`${new Intl.DateTimeFormat("en-GB",e).format(s)}, ${y(s.getHours(),2)}:${y(s.getMinutes(),2)}`}return s},k=(e,t)=>{const s=x(e,new Date)?"HH:mm":"DD/MM/YY",o=w(t,s);return"HH:mm"===s?"Today, "+o:o};var M=s("2ef0"),S=s.n(M),R=s("6125"),A=s("1f64");Object(A["a"])();var E=S.a.template('<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" viewBox="0, 0, 100, 100" class="la-all letterAvatar li-la-<%= username %>"><circle cx="50" cy="50" r="49" fill="<%=  colorPrimary %>" stroke="<%=  colorOuterStroke %>" stroke-width="1" class="la-outer-circle" /> <circle cx="50" cy="50" r="40" fill="<%=  colorInnerCircle %>" stroke="<%=  colorInnerStroke %>" stroke-width="1" class="la-inner-circle" /> <text x="50" y="71.5" font-family="Arial" font-size="60" font-weight="700" text-anchor="middle" fill="<%=  colorPrimary %>" class="la-text"><%=  usernameInitial %></text></svg>'),T=S.a.template('<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" viewBox="0, 0, 100, 100" class="la-all letterAvatar2 li-la2-<%= username %>"><circle cx="50" cy="50" r="49" fill="<%= colorPrimary %>" stroke="#ffffff" stroke-width="1" class="la2-circle" /><text x="50" y="71.5" font-family="Arial" font-size="60" font-weight="700" text-anchor="middle" fill="#ffffff" class="la2-text"><%= usernameInitial %></text></svg>');function I(e,t){var s,o={colorOuterStroke:O(e),colorInnerCircle:"#ffffff",colorInnerStroke:"#ffffff",username:e,usernameInitial:(null===e||void 0===e||null===(s=e.charAt(0))||void 0===s?void 0:s.toUpperCase())||"",colorPrimary:O(e)};return t?E(o):T(o)}function O(e){let t=R(e);for(var s,o,a;;){s=t(),o=.5*t()+.5,a=t()*(.8-.2)+.2;var n=B(s,o,a);return n}}function B(e,t,s){var o,a,n;if(0==t)o=a=n=s;else{var r=function(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e},i=s<.5?s*(1+t):s+t-s*t,l=2*s-i;o=r(l,i,e+1/3),a=r(l,i,e),n=r(l,i,e-1/3)}return"#"+("000000"+Math.round(255*o).toString(16)+Math.round(255*a).toString(16)+Math.round(255*n).toString(16)).slice(-6)}var C={props:{currentUserId:{type:String,required:!0},theme:{type:String,required:!0},isDevice:{type:Boolean,required:!0},chatIdOverride:{type:String,default:null}},emits:["show-demo-options"],data(){return{roomsPerPage:15,rooms:[],roomId:"",startRooms:null,endRooms:null,roomsLoaded:!1,loadingRooms:!0,allUsers:[],loadingLastMessageByRoom:0,roomsLoadedCount:0,selectedRoom:null,messagesPerPage:20,messages:[],messagesLoaded:!1,roomMessage:"",lastLoadedMessage:null,previousLastLoadedMessage:null,roomsListeners:[],listeners:[],typingMessageCache:"",disableForm:!1,addNewRoom:null,addRoomUsername:"",inviteRoomId:null,invitedUsername:"",removeRoomId:null,removeUserId:"",removeUsers:[],roomActions:[],menuActions:[],messageSelectionActions:[{name:"deleteMessages",title:"Delete"}],styles:{container:{borderRadius:"4px"}},templatesText:[{tag:"help",text:"This is the help"},{tag:"action",text:"This is the action"},{tag:"action 2",text:"This is the second action"}]}},computed:{loadedRooms(){const e=JSON.parse(JSON.stringify(this.newMessagesCountByRooms));let t=this.rooms.slice(0,this.roomsLoadedCount);for(let s of t)null!==e[s.roomId]&&"undefined"!==typeof e[s.roomId]&&(s.unreadCount=e[s.roomId]);return t},newMessagesCountByRooms(){return this.$store.getters.newMessagesCountByRooms},screenHeight(){return window.innerWidth>768?"100vh":"calc(100vh - 80px)"},sponsorId(){var e;return null===(e=this.$store.getters.profile)||void 0===e?void 0:e.sponsorId}},watch:{newMessagesCountByRooms(e,t){this.$nextTick(()=>{console.log("newMessagesCountByRooms changed in component",e)})},deep:!0},mounted(){this.addCss(),console.log(this.chatIdOverride),this.chatIdOverride&&(this.roomId=this.chatIdOverride),this.fetchRooms(),b(this.currentUserId)},methods:{logoAvatar(e){return"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(I(e.username))))},async addCss(){const e=document.createElement("style");e.innerHTML="\n\t\t\t.vac-room-list .vac-room-item:first-child {\n\t\t\t\tbackground: #146672!important;\n\t\t\t}\n\t\t\t.vac-room-item * {\n\t\t\t\tcolor: #EAEAEA;\n\t\t\t}\n\t\t\t.vac-room-item .vac-state-circle {\n\t\t\t\tbackground: transparent;\n\t\t\t}\n\t\t\t.vac-message-container * {\n\t\t\t\tcolor: #EAEAEA;\n\t\t\t}\n\t\t\t.vac-card-window a {\n\t\t\t\tcolor: #3AFFEF!important;\n\t\t\t}\n\t\t\t.vac-card-window a span {\n\t\t\t\tcolor: #3AFFEF!important;\n\t\t\t}\n\t\t\t",this.$refs.chatWindow.shadowRoot.appendChild(e)},resetRooms(){this.loadingRooms=!0,this.loadingLastMessageByRoom=0,this.roomsLoadedCount=0,this.rooms=[],this.roomsLoaded=!0,this.startRooms=null,this.endRooms=null,this.roomsListeners.forEach(e=>e()),this.roomsListeners=[],this.resetMessages()},resetMessages(){this.messages=[],this.messagesLoaded=!1,this.lastLoadedMessage=null,this.previousLastLoadedMessage=null,this.listeners.forEach(e=>e()),this.listeners=[]},async fetchRooms(){this.resetRooms(),await this.fetchMoreRooms()},async fetchSponsorRoom(){if(!this.sponsorId)return;const e=await r["sponsorRoomQuery"](this.currentUserId,this.sponsorId),{data:t,docs:s}=await r["getSponsorRoom"](e);this.roomsLoaded=!1;const o=s,a=[];o.users.forEach(e=>{const t=this.allUsers.find(t=>(null===t||void 0===t?void 0:t._id)===e);t||-1!==a.indexOf(e)||a.push(e)});const n=[];a.forEach(e=>{const t=r["l"](e);n.push(t)}),this.allUsers=[...this.allUsers,...await Promise.all(n)];const i={};i[o.id]={...o,users:[]},o.users.forEach(e=>{const t=this.allUsers.find(t=>(null===t||void 0===t?void 0:t._id)===e);t&&i[o.id].users.push(t)});const l=[];Object.keys(i).forEach(e=>{const t=i[e],s=t.users.filter(e=>e._id!==this.currentUserId);t.roomName=s.map(e=>e.username).join(", ")||"Myself";const o=1===s.length&&s[0].avatar?s[0].avatar:this.logoAvatar(s[0]);l.push({...t,roomId:e,avatar:o,index:t.lastUpdated.seconds,lastMessage:{content:"Room created",timestamp:k(new Date(t.lastUpdated.seconds),t.lastUpdated)}})}),this.rooms=this.rooms.concat(l),l.forEach(e=>this.listenLastMessage(e)),this.rooms.length||(this.loadingRooms=!1,this.roomsLoadedCount=0),this.listenUsersOnlineStatus(l),this.listenSponsorRoom(o.id)},async fetchMoreRooms(){if("undefined"==typeof this.currentUserId||null==this.currentUserId)return;if(this.endRooms&&!this.startRooms)return void(this.roomsLoaded=!0);const e=r["s"](this.currentUserId,this.roomsPerPage,this.startRooms),{data:t,docs:s}=await r["j"](e);this.roomsLoaded=0===t.length||t.length<this.roomsPerPage,this.startRooms&&(this.endRooms=this.startRooms),this.startRooms=s[s.length-1];const o=[];t.forEach(e=>{e.users.forEach(e=>{const t=this.allUsers.find(t=>(null===t||void 0===t?void 0:t._id)===e);t||-1!==o.indexOf(e)||o.push(e)})});const a=[];o.forEach(e=>{const t=r["l"](e);a.push(t)}),this.allUsers=[...this.allUsers,...await Promise.all(a)];const n={};t.forEach(e=>{n[e.id]={...e,users:[]},e.users.forEach(t=>{const s=this.allUsers.find(e=>(null===e||void 0===e?void 0:e._id)===t);s&&n[e.id].users.push(s)})});const i=[];Object.keys(n).forEach(e=>{const t=n[e],s=t.users.filter(e=>e._id!==this.currentUserId);t.roomName=s.map(e=>e.username).join(", ")||"Myself";const o=1===s.length&&s[0].avatar?s[0].avatar:this.logoAvatar(s[0]);i.push({...t,roomId:e,avatar:o,index:t.lastUpdated.seconds,lastMessage:{content:"Room created",timestamp:k(new Date(t.lastUpdated.seconds),t.lastUpdated)}})}),this.rooms=this.rooms.concat(i),console.log("LINE 421"),i.forEach(e=>this.listenLastMessage(e)),this.rooms.length||(this.loadingRooms=!1,this.roomsLoadedCount=0),console.log("LINE 427"),this.listenUsersOnlineStatus(i),console.log("LINE 438"),this.listenRooms(e),console.log("LINE 440")},listenLastMessage(e){const t=r["n"](e.roomId,t=>{t.forEach(t=>{const s=this.formatLastMessage(t,e),o=this.rooms.findIndex(t=>e.roomId===t.roomId);this.rooms[o].lastMessage=s,this.rooms=[...this.rooms]}),this.loadingLastMessageByRoom<this.rooms.length&&(this.loadingLastMessageByRoom++,this.loadingLastMessageByRoom===this.rooms.length&&(this.loadingRooms=!1,this.roomsLoadedCount=this.rooms.length))});this.roomsListeners.push(t)},formatLastMessage(e,t){var s,o;if(!e.timestamp)return;let a=e.content;if(null!==(s=e.files)&&void 0!==s&&s.length){const t=e.files[0];a=`${t.name}.${t.extension||t.type}`}const n=e.sender_id!==this.currentUserId?null===(o=t.users.find(t=>e.sender_id===t._id))||void 0===o?void 0:o.username:"";return{...e,_id:e.id,content:a,senderId:e.sender_id,timestamp:k(new Date(1e3*e.timestamp.seconds),e.timestamp),username:n,distributed:!0,seen:e.sender_id===this.currentUserId?e.seen:null,new:e.sender_id!==this.currentUserId&&(!e.seen||!e.seen[this.currentUserId]),lastMessage:{...e.lastMessage,_id:e.id,senderId:e.sender_id}}},fetchMessages({room:e,options:t={}}){this.$emit("show-demo-options",!1),t.reset&&this.resetMessages(),console.log("fetchMessages",e.roomId),!this.previousLastLoadedMessage||this.lastLoadedMessage?(this.selectedRoom=e.roomId,r["i"](e.roomId,this.messagesPerPage,this.lastLoadedMessage).then(({data:s,docs:o})=>{this.selectedRoom===e.roomId&&((0===s.length||s.length<this.messagesPerPage)&&setTimeout(()=>{this.messagesLoaded=!0},0),t.reset&&(this.messages=[]),s.forEach(t=>{const s=this.formatMessage(e,t);this.messages.unshift(s)}),this.lastLoadedMessage&&(this.previousLastLoadedMessage=this.lastLoadedMessage),this.lastLoadedMessage=o[o.length-1],this.listenMessages(e))})):this.messagesLoaded=!0},listenMessages(e){console.log("listen messages",e.roomId);const t=r["o"](e.roomId,this.lastLoadedMessage,this.previousLastLoadedMessage,t=>{let s=null;t.forEach(async(o,a)=>{const n=this.formatMessage(e,o),i=this.messages.findIndex(e=>e._id===o.id);-1===i?this.messages=this.messages.concat([n]):(this.messages[i]=n,this.messages=[...this.messages]),e.roomId===this.selectedRoom&&(console.log("MARK MESSAGES SEEN"),o.sender_id==this.currentUserId||o.seen&&o.seen[this.currentUserId]||(s=o),a===t.length-1&&s&&(console.log("AAAAAAAAAAAAAA",o),await r["A"](e.roomId,this.currentUserId,s.timestamp))),this.markMessagesSeen(e,o)})});this.listeners.push(t)},async markMessagesSeen(e,t){t.sender_id==this.currentUserId||t.seen&&t.seen[this.currentUserId]||(console.log(e),await r["v"](e.roomId,t.id,{["seen."+this.currentUserId]:new Date}))},formatMessage(e,t){var s;const o={...t,senderId:t.sender_id,_id:t.id,seconds:t.timestamp.seconds,timestamp:w(t.timestamp,"HH:mm"),date:w(t.timestamp,"DD MMMM YYYY"),username:null===(s=e.users.find(e=>t.sender_id===e._id))||void 0===s?void 0:s.username,distributed:!0,lastMessage:{...t.lastMessage,senderId:t.sender_id}};return t.replyMessage&&(o.replyMessage={...t.replyMessage,senderId:t.replyMessage.sender_id}),o},async sendMessage({content:e,roomId:t,files:s,replyMessage:o}){const a={sender_id:this.currentUserId,content:e,timestamp:new Date};s&&(a.files=this.formattedFiles(s)),o&&(a.replyMessage={_id:o._id,content:o.content,sender_id:o.senderId},o.files&&(a.replyMessage.files=o.files));const{id:n}=await r["a"](t,a);if(s)for(let r=0;r<s.length;r++)await this.uploadFile({file:s[r],messageId:n,roomId:t});r["x"](t,{lastUpdated:new Date})},async editMessage({messageId:e,newContent:t,roomId:s,files:o}){const a={edited:new Date};if(a.content=t,a.files=o?this.formattedFiles(o):r["e"],await r["v"](s,e,a),o)for(let r=0;r<o.length;r++){var n;null!==(n=o[r])&&void 0!==n&&n.blob&&await this.uploadFile({file:o[r],messageId:e,roomId:s})}},async deleteMessage({message:e,roomId:t}){await r["v"](t,e._id,{deleted:new Date});const{files:s}=e;s&&s.forEach(t=>{u(this.currentUserId,e._id,t)})},async uploadFile({file:e,messageId:t,roomId:s}){return new Promise(o=>{let a=e.extension||e.type;"svg"!==a&&"pdf"!==a||(a=e.type),p(this.currentUserId,t,e,a,s=>{this.updateFileProgress(t,e.localUrl,s)},e=>{o(!1)},async a=>{const n=await r["h"](s,t);n.files.forEach(t=>{t.url===e.localUrl&&(t.url=a)}),await r["v"](s,t,{files:n.files}),o(!0)})})},updateFileProgress(e,t,s){const o=this.messages.find(t=>t._id===e);o&&o.files&&(o.files.find(e=>e.url===t).progress=s,this.messages=[...this.messages])},formattedFiles(e){const t=[];return e.forEach(e=>{const s={name:e.name,size:e.size,type:e.type,extension:e.extension||e.type,url:e.url||e.localUrl};e.audio&&(s.audio=!0,s.duration=e.duration),t.push(s)}),t},openFile({file:e}){window.open(e.file.url,"_blank")},async openUserTag({user:e}){let t;if(this.rooms.forEach(s=>{if(2===s.users.length){const o=s.users[0]._id,a=s.users[1]._id;o!==e._id&&o!==this.currentUserId||a!==e._id&&a!==this.currentUserId||(t=s.roomId)}}),t)return void(this.roomId=t);const s=await r["m"](this.currentUserId,e._id);if(s.data.length)return this.loadRoom(s);const o=await r["m"](e._id,this.currentUserId);return o.data.length?this.loadRoom(o):void 0},async loadRoom(e){e.forEach(async e=>{this.loadingRooms||(await r["x"](e.id,{lastUpdated:new Date}),this.roomId=e.id,this.fetchRooms())})},menuActionHandler({action:e,roomId:t}){switch(e.name){case"inviteUser":return this.inviteUser(t);case"removeUser":return this.removeUser(t);case"deleteRoom":return this.deleteRoom(t)}},messageSelectionActionHandler({action:e,messages:t,roomId:s}){switch(e.name){case"deleteMessages":t.forEach(e=>{this.deleteMessage({message:e,roomId:s})})}},async sendMessageReaction({reaction:e,remove:t,messageId:s,roomId:o}){r["w"](o,s,this.currentUserId,e.unicode,t?"remove":"add")},typingMessage({message:e,roomId:t}){if(t){if((null===e||void 0===e?void 0:e.length)>1)return void(this.typingMessageCache=e);if(1===(null===e||void 0===e?void 0:e.length)&&this.typingMessageCache)return void(this.typingMessageCache=e);this.typingMessageCache=e,r["y"](t,this.currentUserId,e?"add":"remove")}},async listenRooms(e){const t=r["p"](e,e=>{e.forEach(e=>{const t=this.rooms.find(t=>t.roomId===e.id);t&&(t.typingUsers=e.typingUsers,t.index=e.lastUpdated.seconds)})});this.roomsListeners.push(t)},async listenSponsorRoom(e){const t=r["listenSponsorRoom"](query,e=>{const t=this.rooms.find(t=>t.roomId===e.id);t&&(t.typingUsers=e.typingUsers,t.index=e.lastUpdated.seconds)});this.roomsListeners.push(t)},listenUsersOnlineStatus(e){e.forEach(e=>{e.users.forEach(t=>{const s=v(_(t._id),s=>{if(!s||!s.val())return;const o=k(new Date(s.val().lastChanged),new Date(s.val().lastChanged));t.status={...s.val(),lastChanged:o};const a=this.rooms.findIndex(t=>e.roomId===t.roomId);this.rooms[a]=e,this.rooms=[...this.rooms]});this.roomsListeners.push(s)})})},addRoom(){this.resetForms(),this.addNewRoom=!0},async createRoom(){this.disableForm=!0;const{id:e}=await r["d"]({username:this.addRoomUsername});await r["z"](e,{_id:e}),await r["b"]({users:[e,this.currentUserId],lastUpdated:new Date}),this.addNewRoom=!1,this.addRoomUsername="",this.fetchRooms()},inviteUser(e){this.resetForms(),this.inviteRoomId=e},async addRoomUser(){this.disableForm=!0;const{id:e}=await r["d"]({username:this.invitedUsername});await r["z"](e,{_id:e}),await r["c"](this.inviteRoomId,e),this.inviteRoomId=null,this.invitedUsername="",this.fetchRooms()},removeUser(e){this.resetForms(),this.removeRoomId=e,this.removeUsers=this.rooms.find(t=>t.roomId===e).users},async deleteRoomUser(){this.disableForm=!0,await r["r"](this.removeRoomId,this.removeUserId),this.removeRoomId=null,this.removeUserId="",this.fetchRooms()},async deleteRoom(e){const t=this.rooms.find(t=>t.roomId===e);if(t.users.find(e=>"SGmFnBZB4xxMv9V4CVlW"===e._id)||t.users.find(e=>"6jMsIXUrBHBj7o2cRlau"===e._id))return alert("Nope, for demo purposes you cannot delete this room");r["i"](e).then(({data:t})=>{t.forEach(t=>{r["f"](e,t.id),t.files&&t.files.forEach(e=>{u(this.currentUserId,t.id,e)})})}),await r["g"](e),this.fetchRooms()},resetForms(){this.disableForm=!1,this.addNewRoom=null,this.addRoomUsername="",this.inviteRoomId=null,this.invitedUsername="",this.removeRoomId=null,this.removeUserId=""}}},j=(s("1b1b"),s("d959")),L=s.n(j);const P=L()(C,[["render",f],["__scopeId","data-v-291e8a62"]]);var N=P,H={props:{chatIdOverride:{type:String,default:null}},components:{ChatContainer:N},data(){return{theme:"dark",showChat:!1,isDevice:!1,updatingData:!1}},computed:{profile(){return this.$store.getters.profile},currentUserId(){var e;return String((null===(e=this.profile)||void 0===e?void 0:e.id)||null)}},watch:{profile(){this.showChat=!1,setTimeout(()=>this.showChat=!0,150)}},async mounted(){window.jivo_destroy&&window.jivo_destroy(),this.isDevice=window.innerWidth<500,window.addEventListener("resize",e=>{e.isTrusted&&(this.isDevice=window.innerWidth<500)});try{await this.$store.dispatch("getProfile")}catch(e){this.$error(e)}},unmounted(){window.jivo_init&&window.jivo_init()},methods:{}};s("c284");const D=L()(H,[["render",n],["__scopeId","data-v-bc4c9fea"]]);t["default"]=D},3:function(e,t){},"3c35":function(e,t){(function(t){e.exports=t}).call(this,{})},"3c65":function(e,t,s){"use strict";var o=s("23e7"),a=s("7b0b"),n=s("07fa"),r=s("3a34"),i=s("083a"),l=s("3511"),c=1!==[].unshift(0),d=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();o({target:"Array",proto:!0,arity:1,forced:c||d},{unshift:function(e){var t=a(this),s=n(t),o=arguments.length;if(o){l(s+o);var c=s;while(c--){var d=c+o;c in t?t[d]=t[c]:i(t,d)}for(var u=0;u<o;u++)t[u]=arguments[u]}return r(t,s+o)}})},6125:function(e,t,s){var o=s("1212"),a=s("b838"),n=s("a49e"),r=s("cae0"),i=s("7aec"),l=s("89ed"),c=s("a49d");c.alea=o,c.xor128=a,c.xorwow=n,c.xorshift7=r,c.xor4096=i,c.tychei=l,e.exports=c},"7aec":function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this;function s(e,t){var s,o,a,n,r,i=[],l=128;for(t===(0|t)?(o=t,t=null):(t+="\0",o=0,l=Math.max(l,t.length)),a=0,n=-32;n<l;++n)t&&(o^=t.charCodeAt((n+32)%t.length)),0===n&&(r=o),o^=o<<10,o^=o>>>15,o^=o<<4,o^=o>>>13,n>=0&&(r=r+1640531527|0,s=i[127&n]^=o+r,a=0==s?a+1:0);for(a>=128&&(i[127&(t&&t.length||0)]=-1),a=127,n=512;n>0;--n)o=i[a+34&127],s=i[a=a+1&127],o^=o<<13,s^=s<<17,o^=o>>>15,s^=s>>>12,i[a]=o^s;e.w=r,e.X=i,e.i=a}t.next=function(){var e,s,o=t.w,a=t.X,n=t.i;return t.w=o=o+1640531527|0,s=a[n+34&127],e=a[n=n+1&127],s^=s<<13,e^=e<<17,s^=s>>>15,e^=e>>>12,s=a[n]=s^e,t.i=n,s+(o^o>>>16)|0},s(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var s=new r(e),o=t&&t.state,a=function(){return(s.next()>>>0)/4294967296};return a.double=function(){do{var e=s.next()>>>11,t=(s.next()>>>0)/4294967296,o=(e+t)/(1<<21)}while(0===o);return o},a.int32=s.next,a.quick=a,o&&(o.X&&i(o,s),a.state=function(){return i(s,{})}),a}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.xor4096=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},"89ed":function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this,s="";t.next=function(){var e=t.b,s=t.c,o=t.d,a=t.a;return e=e<<25^e>>>7^s,s=s-o|0,o=o<<24^o>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^s,t.c=s=s-o|0,t.d=o<<16^s>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):s+=e;for(var o=0;o<s.length+20;o++)t.b^=0|s.charCodeAt(o),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var s=new r(e),o=t&&t.state,a=function(){return(s.next()>>>0)/4294967296};return a.double=function(){do{var e=s.next()>>>11,t=(s.next()>>>0)/4294967296,o=(e+t)/(1<<21)}while(0===o);return o},a.int32=s.next,a.quick=a,o&&("object"==typeof o&&i(o,s),a.state=function(){return i(s,{})}),a}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.tychei=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},a49d:function(e,t,s){var o;(function(a,n,r){var i,l=256,c=6,d=52,u="random",m=r.pow(l,c),h=r.pow(2,d),p=2*h,f=l-1;function g(e,t,s){var o=[];t=1==t?{entropy:!0}:t||{};var a=y(b(t.entropy?[e,w(n)]:null==e?x():e,3),o),i=new v(o),d=function(){var e=i.g(c),t=m,s=0;while(e<h)e=(e+s)*l,t*=l,s=i.g(1);while(e>=p)e/=2,t/=2,s>>>=1;return(e+s)/t};return d.int32=function(){return 0|i.g(4)},d.quick=function(){return i.g(4)/4294967296},d.double=d,y(w(i.S),n),(t.pass||s||function(e,t,s,o){return o&&(o.S&&_(o,i),e.state=function(){return _(i,{})}),s?(r[u]=e,t):e})(d,a,"global"in t?t.global:this==r,t.state)}function v(e){var t,s=e.length,o=this,a=0,n=o.i=o.j=0,r=o.S=[];s||(e=[s++]);while(a<l)r[a]=a++;for(a=0;a<l;a++)r[a]=r[n=f&n+e[a%s]+(t=r[a])],r[n]=t;(o.g=function(e){var t,s=0,a=o.i,n=o.j,r=o.S;while(e--)t=r[a=f&a+1],s=s*l+r[f&(r[a]=r[n=f&n+t])+(r[n]=t)];return o.i=a,o.j=n,s})(l)}function _(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function b(e,t){var s,o=[],a=typeof e;if(t&&"object"==a)for(s in e)try{o.push(b(e[s],t-1))}catch(n){}return o.length?o:"string"==a?e:e+"\0"}function y(e,t){var s,o=e+"",a=0;while(a<o.length)t[f&a]=f&(s^=19*t[f&a])+o.charCodeAt(a++);return w(t)}function x(){try{var e;return i&&(e=i.randomBytes)?e=e(l):(e=new Uint8Array(l),(a.crypto||a.msCrypto).getRandomValues(e)),w(e)}catch(o){var t=a.navigator,s=t&&t.plugins;return[+new Date,a,s,a.screen,w(n)]}}function w(e){return String.fromCharCode.apply(0,e)}if(y(r.random(),n),e.exports){e.exports=g;try{i=s(3)}catch(k){}}else o=function(){return g}.call(t,s,t,e),void 0===o||(e.exports=o)})("undefined"!==typeof self?self:this,[],Math)},a49e:function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this,s="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:s+=e;for(var o=0;o<s.length+64;o++)t.x^=0|s.charCodeAt(o),o==s.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var s=new r(e),o=t&&t.state,a=function(){return(s.next()>>>0)/4294967296};return a.double=function(){do{var e=s.next()>>>11,t=(s.next()>>>0)/4294967296,o=(e+t)/(1<<21)}while(0===o);return o},a.int32=s.next,a.quick=a,o&&("object"==typeof o&&i(o,s),a.state=function(){return i(s,{})}),a}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.xorwow=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},a8f9:function(e,t,s){},b7ef:function(e,t,s){"use strict";var o=s("23e7"),a=s("da84"),n=s("d066"),r=s("5c6c"),i=s("9bf2").f,l=s("1a2d"),c=s("19aa"),d=s("7156"),u=s("e391"),m=s("cf98"),h=s("0d26"),p=s("83ab"),f=s("c430"),g="DOMException",v=n("Error"),_=n(g),b=function(){c(this,y);var e=arguments.length,t=u(e<1?void 0:arguments[0]),s=u(e<2?void 0:arguments[1],"Error"),o=new _(t,s),a=v(t);return a.name=g,i(o,"stack",r(1,h(a.stack,1))),d(o,this,b),o},y=b.prototype=_.prototype,x="stack"in v(g),w="stack"in new _(1,2),k=_&&p&&Object.getOwnPropertyDescriptor(a,g),M=!!k&&!(k.writable&&k.configurable),S=x&&!M&&!w;o({global:!0,constructor:!0,forced:f||S},{DOMException:S?b:_});var R=n(g),A=R.prototype;if(A.constructor!==R)for(var E in f||i(A,"constructor",r(1,R)),m)if(l(m,E)){var T=m[E],I=T.s;l(R,I)||i(R,I,r(6,T.c))}},b838:function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this,s="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:s+=e;for(var o=0;o<s.length+64;o++)t.x^=0|s.charCodeAt(o),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var s=new r(e),o=t&&t.state,a=function(){return(s.next()>>>0)/4294967296};return a.double=function(){do{var e=s.next()>>>11,t=(s.next()>>>0)/4294967296,o=(e+t)/(1<<21)}while(0===o);return o},a.int32=s.next,a.quick=a,o&&("object"==typeof o&&i(o,s),a.state=function(){return i(s,{})}),a}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.xor128=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},c284:function(e,t,s){"use strict";s("a8f9")},cae0:function(e,t,s){(function(e){var o;(function(e,a,n){function r(e){var t=this;function s(e,t){var s,o=[];if(t===(0|t))o[0]=t;else for(t=""+t,s=0;s<t.length;++s)o[7&s]=o[7&s]<<15^t.charCodeAt(s)+o[s+1&7]<<13;while(o.length<8)o.push(0);for(s=0;s<8&&0===o[s];++s);for(8==s?o[7]=-1:o[s],e.x=o,e.i=0,s=256;s>0;--s)e.next()}t.next=function(){var e,s,o=t.x,a=t.i;return e=o[a],e^=e>>>7,s=e^e<<24,e=o[a+1&7],s^=e^e>>>10,e=o[a+3&7],s^=e^e>>>3,e=o[a+4&7],s^=e^e<<7,e=o[a+7&7],e^=e<<13,s^=e^e<<9,o[a]=s,t.i=a+1&7,s},s(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var s=new r(e),o=t&&t.state,a=function(){return(s.next()>>>0)/4294967296};return a.double=function(){do{var e=s.next()>>>11,t=(s.next()>>>0)/4294967296,o=(e+t)/(1<<21)}while(0===o);return o},a.int32=s.next,a.quick=a,o&&(o.x&&i(o,s),a.state=function(){return i(s,{})}),a}a&&a.exports?a.exports=l:s("07d6")&&s("3c35")?(o=function(){return l}.call(t,s,t,a),void 0===o||(a.exports=o)):this.xorshift7=l})(0,e,s("07d6"))}).call(this,s("62e4")(e))},cca9:function(e,t,s){},cf98:function(e,t){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}}]);
//# sourceMappingURL=chunk-35caf5f6.8a6dc693.js.map